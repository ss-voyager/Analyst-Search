{"file_contents":{"client/src/lib/utils.ts":{"content":"import { clsx, type ClassValue } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n","path":null,"size_bytes":166,"size_tokens":null},"client/src/components/ui/badge.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst badgeVariants = cva(\n  // @replit\n  // Whitespace-nowrap: Badges should never wrap.\n  \"whitespace-nowrap inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2\" +\n  \" hover-elevate \",\n  {\n    variants: {\n      variant: {\n        default:\n          // @replit shadow-xs instead of shadow, no hover because we use hover-elevate\n          \"border-transparent bg-primary text-primary-foreground shadow-xs\",\n        secondary:\n          // @replit no hover because we use hover-elevate\n          \"border-transparent bg-secondary text-secondary-foreground\",\n        destructive:\n          // @replit shadow-xs instead of shadow, no hover because we use hover-elevate\n          \"border-transparent bg-destructive text-destructive-foreground shadow-xs\",\n          // @replit shadow-xs\" - use badge outline variable\n        outline: \"text-foreground border [border-color:var(--badge-outline)]\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nexport interface BadgeProps\n  extends React.HTMLAttributes<HTMLDivElement>,\n    VariantProps<typeof badgeVariants> {}\n\nfunction Badge({ className, variant, ...props }: BadgeProps) {\n  return (\n    <div className={cn(badgeVariants({ variant }), className)} {...props} />\n  )\n}\n\nexport { Badge, badgeVariants }\n","path":null,"size_bytes":1522,"size_tokens":null},"client/src/components/ui/context-menu.tsx":{"content":"import * as React from \"react\"\nimport * as ContextMenuPrimitive from \"@radix-ui/react-context-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ContextMenu = ContextMenuPrimitive.Root\n\nconst ContextMenuTrigger = ContextMenuPrimitive.Trigger\n\nconst ContextMenuGroup = ContextMenuPrimitive.Group\n\nconst ContextMenuPortal = ContextMenuPrimitive.Portal\n\nconst ContextMenuSub = ContextMenuPrimitive.Sub\n\nconst ContextMenuRadioGroup = ContextMenuPrimitive.RadioGroup\n\nconst ContextMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <ContextMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </ContextMenuPrimitive.SubTrigger>\n))\nContextMenuSubTrigger.displayName = ContextMenuPrimitive.SubTrigger.displayName\n\nconst ContextMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuSubContent.displayName = ContextMenuPrimitive.SubContent.displayName\n\nconst ContextMenuContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Portal>\n    <ContextMenuPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"z-50 max-h-[--radix-context-menu-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </ContextMenuPrimitive.Portal>\n))\nContextMenuContent.displayName = ContextMenuPrimitive.Content.displayName\n\nconst ContextMenuItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuItem.displayName = ContextMenuPrimitive.Item.displayName\n\nconst ContextMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <ContextMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.CheckboxItem>\n))\nContextMenuCheckboxItem.displayName =\n  ContextMenuPrimitive.CheckboxItem.displayName\n\nconst ContextMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <ContextMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-4 w-4 fill-current\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.RadioItem>\n))\nContextMenuRadioItem.displayName = ContextMenuPrimitive.RadioItem.displayName\n\nconst ContextMenuLabel = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold text-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuLabel.displayName = ContextMenuPrimitive.Label.displayName\n\nconst ContextMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nContextMenuSeparator.displayName = ContextMenuPrimitive.Separator.displayName\n\nconst ContextMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nContextMenuShortcut.displayName = \"ContextMenuShortcut\"\n\nexport {\n  ContextMenu,\n  ContextMenuTrigger,\n  ContextMenuContent,\n  ContextMenuItem,\n  ContextMenuCheckboxItem,\n  ContextMenuRadioItem,\n  ContextMenuLabel,\n  ContextMenuSeparator,\n  ContextMenuShortcut,\n  ContextMenuGroup,\n  ContextMenuPortal,\n  ContextMenuSub,\n  ContextMenuSubContent,\n  ContextMenuSubTrigger,\n  ContextMenuRadioGroup,\n}\n","path":null,"size_bytes":7406,"size_tokens":null},"client/src/components/ui/tooltip.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as TooltipPrimitive from \"@radix-ui/react-tooltip\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst TooltipProvider = TooltipPrimitive.Provider\n\nconst Tooltip = TooltipPrimitive.Root\n\nconst TooltipTrigger = TooltipPrimitive.Trigger\n\nconst TooltipContent = React.forwardRef<\n  React.ElementRef<typeof TooltipPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TooltipPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <TooltipPrimitive.Portal>\n    <TooltipPrimitive.Content\n      ref={ref}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 overflow-hidden rounded-md bg-primary px-3 py-1.5 text-xs text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </TooltipPrimitive.Portal>\n))\nTooltipContent.displayName = TooltipPrimitive.Content.displayName\n\nexport { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider }\n","path":null,"size_bytes":1267,"size_tokens":null},"client/src/components/ui/command.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { type DialogProps } from \"@radix-ui/react-dialog\"\nimport { Command as CommandPrimitive } from \"cmdk\"\nimport { Search } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Dialog, DialogContent } from \"@/components/ui/dialog\"\n\nconst Command = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nCommand.displayName = CommandPrimitive.displayName\n\nconst CommandDialog = ({ children, ...props }: DialogProps) => {\n  return (\n    <Dialog {...props}>\n      <DialogContent className=\"overflow-hidden p-0\">\n        <Command className=\"[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5\">\n          {children}\n        </Command>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nconst CommandInput = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Input>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Input>\n>(({ className, ...props }, ref) => (\n  <div className=\"flex items-center border-b px-3\" cmdk-input-wrapper=\"\">\n    <Search className=\"mr-2 h-4 w-4 shrink-0 opacity-50\" />\n    <CommandPrimitive.Input\n      ref={ref}\n      className={cn(\n        \"flex h-10 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    />\n  </div>\n))\n\nCommandInput.displayName = CommandPrimitive.Input.displayName\n\nconst CommandList = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.List\n    ref={ref}\n    className={cn(\"max-h-[300px] overflow-y-auto overflow-x-hidden\", className)}\n    {...props}\n  />\n))\n\nCommandList.displayName = CommandPrimitive.List.displayName\n\nconst CommandEmpty = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Empty>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Empty>\n>((props, ref) => (\n  <CommandPrimitive.Empty\n    ref={ref}\n    className=\"py-6 text-center text-sm\"\n    {...props}\n  />\n))\n\nCommandEmpty.displayName = CommandPrimitive.Empty.displayName\n\nconst CommandGroup = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Group>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Group>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Group\n    ref={ref}\n    className={cn(\n      \"overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandGroup.displayName = CommandPrimitive.Group.displayName\n\nconst CommandSeparator = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nCommandSeparator.displayName = CommandPrimitive.Separator.displayName\n\nconst CommandItem = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected=true]:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandItem.displayName = CommandPrimitive.Item.displayName\n\nconst CommandShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nCommandShortcut.displayName = \"CommandShortcut\"\n\nexport {\n  Command,\n  CommandDialog,\n  CommandInput,\n  CommandList,\n  CommandEmpty,\n  CommandGroup,\n  CommandItem,\n  CommandShortcut,\n  CommandSeparator,\n}\n","path":null,"size_bytes":4887,"size_tokens":null},"client/src/components/ui/calendar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport {\n  ChevronDownIcon,\n  ChevronLeftIcon,\n  ChevronRightIcon,\n} from \"lucide-react\"\nimport { DayButton, DayPicker, getDefaultClassNames } from \"react-day-picker\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Button, buttonVariants } from \"@/components/ui/button\"\n\nfunction Calendar({\n  className,\n  classNames,\n  showOutsideDays = true,\n  captionLayout = \"label\",\n  buttonVariant = \"ghost\",\n  formatters,\n  components,\n  ...props\n}: React.ComponentProps<typeof DayPicker> & {\n  buttonVariant?: React.ComponentProps<typeof Button>[\"variant\"]\n}) {\n  const defaultClassNames = getDefaultClassNames()\n\n  return (\n    <DayPicker\n      showOutsideDays={showOutsideDays}\n      className={cn(\n        \"bg-background group/calendar p-3 [--cell-size:2rem] [[data-slot=card-content]_&]:bg-transparent [[data-slot=popover-content]_&]:bg-transparent\",\n        String.raw`rtl:**:[.rdp-button\\_next>svg]:rotate-180`,\n        String.raw`rtl:**:[.rdp-button\\_previous>svg]:rotate-180`,\n        className\n      )}\n      captionLayout={captionLayout}\n      formatters={{\n        formatMonthDropdown: (date) =>\n          date.toLocaleString(\"default\", { month: \"short\" }),\n        ...formatters,\n      }}\n      classNames={{\n        root: cn(\"w-fit\", defaultClassNames.root),\n        months: cn(\n          \"relative flex flex-col gap-4 md:flex-row\",\n          defaultClassNames.months\n        ),\n        month: cn(\"flex w-full flex-col gap-4\", defaultClassNames.month),\n        nav: cn(\n          \"absolute inset-x-0 top-0 flex w-full items-center justify-between gap-1\",\n          defaultClassNames.nav\n        ),\n        button_previous: cn(\n          buttonVariants({ variant: buttonVariant }),\n          \"h-[--cell-size] w-[--cell-size] select-none p-0 aria-disabled:opacity-50\",\n          defaultClassNames.button_previous\n        ),\n        button_next: cn(\n          buttonVariants({ variant: buttonVariant }),\n          \"h-[--cell-size] w-[--cell-size] select-none p-0 aria-disabled:opacity-50\",\n          defaultClassNames.button_next\n        ),\n        month_caption: cn(\n          \"flex h-[--cell-size] w-full items-center justify-center px-[--cell-size]\",\n          defaultClassNames.month_caption\n        ),\n        dropdowns: cn(\n          \"flex h-[--cell-size] w-full items-center justify-center gap-1.5 text-sm font-medium\",\n          defaultClassNames.dropdowns\n        ),\n        dropdown_root: cn(\n          \"has-focus:border-ring border-input shadow-xs has-focus:ring-ring/50 has-focus:ring-[3px] relative rounded-md border\",\n          defaultClassNames.dropdown_root\n        ),\n        dropdown: cn(\n          \"bg-popover absolute inset-0 opacity-0\",\n          defaultClassNames.dropdown\n        ),\n        caption_label: cn(\n          \"select-none font-medium\",\n          captionLayout === \"label\"\n            ? \"text-sm\"\n            : \"[&>svg]:text-muted-foreground flex h-8 items-center gap-1 rounded-md pl-2 pr-1 text-sm [&>svg]:size-3.5\",\n          defaultClassNames.caption_label\n        ),\n        table: \"w-full border-collapse\",\n        weekdays: cn(\"flex\", defaultClassNames.weekdays),\n        weekday: cn(\n          \"text-muted-foreground flex-1 select-none rounded-md text-[0.8rem] font-normal\",\n          defaultClassNames.weekday\n        ),\n        week: cn(\"mt-2 flex w-full\", defaultClassNames.week),\n        week_number_header: cn(\n          \"w-[--cell-size] select-none\",\n          defaultClassNames.week_number_header\n        ),\n        week_number: cn(\n          \"text-muted-foreground select-none text-[0.8rem]\",\n          defaultClassNames.week_number\n        ),\n        day: cn(\n          \"group/day relative aspect-square h-full w-full select-none p-0 text-center [&:first-child[data-selected=true]_button]:rounded-l-md [&:last-child[data-selected=true]_button]:rounded-r-md\",\n          defaultClassNames.day\n        ),\n        range_start: cn(\n          \"bg-accent rounded-l-md\",\n          defaultClassNames.range_start\n        ),\n        range_middle: cn(\"rounded-none\", defaultClassNames.range_middle),\n        range_end: cn(\"bg-accent rounded-r-md\", defaultClassNames.range_end),\n        today: cn(\n          \"bg-accent text-accent-foreground rounded-md data-[selected=true]:rounded-none\",\n          defaultClassNames.today\n        ),\n        outside: cn(\n          \"text-muted-foreground aria-selected:text-muted-foreground\",\n          defaultClassNames.outside\n        ),\n        disabled: cn(\n          \"text-muted-foreground opacity-50\",\n          defaultClassNames.disabled\n        ),\n        hidden: cn(\"invisible\", defaultClassNames.hidden),\n        ...classNames,\n      }}\n      components={{\n        Root: ({ className, rootRef, ...props }) => {\n          return (\n            <div\n              data-slot=\"calendar\"\n              ref={rootRef}\n              className={cn(className)}\n              {...props}\n            />\n          )\n        },\n        Chevron: ({ className, orientation, ...props }) => {\n          if (orientation === \"left\") {\n            return (\n              <ChevronLeftIcon className={cn(\"size-4\", className)} {...props} />\n            )\n          }\n\n          if (orientation === \"right\") {\n            return (\n              <ChevronRightIcon\n                className={cn(\"size-4\", className)}\n                {...props}\n              />\n            )\n          }\n\n          return (\n            <ChevronDownIcon className={cn(\"size-4\", className)} {...props} />\n          )\n        },\n        DayButton: CalendarDayButton,\n        WeekNumber: ({ children, ...props }) => {\n          return (\n            <td {...props}>\n              <div className=\"flex size-[--cell-size] items-center justify-center text-center\">\n                {children}\n              </div>\n            </td>\n          )\n        },\n        ...components,\n      }}\n      {...props}\n    />\n  )\n}\n\nfunction CalendarDayButton({\n  className,\n  day,\n  modifiers,\n  ...props\n}: React.ComponentProps<typeof DayButton>) {\n  const defaultClassNames = getDefaultClassNames()\n\n  const ref = React.useRef<HTMLButtonElement>(null)\n  React.useEffect(() => {\n    if (modifiers.focused) ref.current?.focus()\n  }, [modifiers.focused])\n\n  return (\n    <Button\n      ref={ref}\n      variant=\"ghost\"\n      size=\"icon\"\n      data-day={day.date.toLocaleDateString()}\n      data-selected-single={\n        modifiers.selected &&\n        !modifiers.range_start &&\n        !modifiers.range_end &&\n        !modifiers.range_middle\n      }\n      data-range-start={modifiers.range_start}\n      data-range-end={modifiers.range_end}\n      data-range-middle={modifiers.range_middle}\n      className={cn(\n        \"data-[selected-single=true]:bg-primary data-[selected-single=true]:text-primary-foreground data-[range-middle=true]:bg-accent data-[range-middle=true]:text-accent-foreground data-[range-start=true]:bg-primary data-[range-start=true]:text-primary-foreground data-[range-end=true]:bg-primary data-[range-end=true]:text-primary-foreground group-data-[focused=true]/day:border-ring group-data-[focused=true]/day:ring-ring/50 flex aspect-square h-auto w-full min-w-[--cell-size] flex-col gap-1 font-normal leading-none data-[range-end=true]:rounded-md data-[range-middle=true]:rounded-none data-[range-start=true]:rounded-md group-data-[focused=true]/day:relative group-data-[focused=true]/day:z-10 group-data-[focused=true]/day:ring-[3px] [&>span]:text-xs [&>span]:opacity-70\",\n        defaultClassNames.day,\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport { Calendar, CalendarDayButton }\n","path":null,"size_bytes":7569,"size_tokens":null},"client/src/components/ui/switch.tsx":{"content":"import * as React from \"react\"\nimport * as SwitchPrimitives from \"@radix-ui/react-switch\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Switch = React.forwardRef<\n  React.ElementRef<typeof SwitchPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof SwitchPrimitives.Root>\n>(({ className, ...props }, ref) => (\n  <SwitchPrimitives.Root\n    className={cn(\n      \"peer inline-flex h-5 w-9 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  >\n    <SwitchPrimitives.Thumb\n      className={cn(\n        \"pointer-events-none block h-4 w-4 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0\"\n      )}\n    />\n  </SwitchPrimitives.Root>\n))\nSwitch.displayName = SwitchPrimitives.Root.displayName\n\nexport { Switch }\n","path":null,"size_bytes":1148,"size_tokens":null},"client/src/components/ui/tabs.tsx":{"content":"import * as React from \"react\"\nimport * as TabsPrimitive from \"@radix-ui/react-tabs\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Tabs = TabsPrimitive.Root\n\nconst TabsList = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.List\n    ref={ref}\n    className={cn(\n      \"inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsList.displayName = TabsPrimitive.List.displayName\n\nconst TabsTrigger = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsTrigger.displayName = TabsPrimitive.Trigger.displayName\n\nconst TabsContent = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsContent.displayName = TabsPrimitive.Content.displayName\n\nexport { Tabs, TabsList, TabsTrigger, TabsContent }\n","path":null,"size_bytes":1877,"size_tokens":null},"client/src/components/ui/pagination.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { ButtonProps, buttonVariants } from \"@/components/ui/button\"\n\nconst Pagination = ({ className, ...props }: React.ComponentProps<\"nav\">) => (\n  <nav\n    role=\"navigation\"\n    aria-label=\"pagination\"\n    className={cn(\"mx-auto flex w-full justify-center\", className)}\n    {...props}\n  />\n)\nPagination.displayName = \"Pagination\"\n\nconst PaginationContent = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    className={cn(\"flex flex-row items-center gap-1\", className)}\n    {...props}\n  />\n))\nPaginationContent.displayName = \"PaginationContent\"\n\nconst PaginationItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ className, ...props }, ref) => (\n  <li ref={ref} className={cn(\"\", className)} {...props} />\n))\nPaginationItem.displayName = \"PaginationItem\"\n\ntype PaginationLinkProps = {\n  isActive?: boolean\n} & Pick<ButtonProps, \"size\"> &\n  React.ComponentProps<\"a\">\n\nconst PaginationLink = ({\n  className,\n  isActive,\n  size = \"icon\",\n  ...props\n}: PaginationLinkProps) => (\n  <a\n    aria-current={isActive ? \"page\" : undefined}\n    className={cn(\n      buttonVariants({\n        variant: isActive ? \"outline\" : \"ghost\",\n        size,\n      }),\n      className\n    )}\n    {...props}\n  />\n)\nPaginationLink.displayName = \"PaginationLink\"\n\nconst PaginationPrevious = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to previous page\"\n    size=\"default\"\n    className={cn(\"gap-1 pl-2.5\", className)}\n    {...props}\n  >\n    <ChevronLeft className=\"h-4 w-4\" />\n    <span>Previous</span>\n  </PaginationLink>\n)\nPaginationPrevious.displayName = \"PaginationPrevious\"\n\nconst PaginationNext = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to next page\"\n    size=\"default\"\n    className={cn(\"gap-1 pr-2.5\", className)}\n    {...props}\n  >\n    <span>Next</span>\n    <ChevronRight className=\"h-4 w-4\" />\n  </PaginationLink>\n)\nPaginationNext.displayName = \"PaginationNext\"\n\nconst PaginationEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    aria-hidden\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More pages</span>\n  </span>\n)\nPaginationEllipsis.displayName = \"PaginationEllipsis\"\n\nexport {\n  Pagination,\n  PaginationContent,\n  PaginationLink,\n  PaginationItem,\n  PaginationPrevious,\n  PaginationNext,\n  PaginationEllipsis,\n}\n","path":null,"size_bytes":2751,"size_tokens":null},"client/src/components/ui/alert-dialog.tsx":{"content":"import * as React from \"react\"\nimport * as AlertDialogPrimitive from \"@radix-ui/react-alert-dialog\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nconst AlertDialog = AlertDialogPrimitive.Root\n\nconst AlertDialogTrigger = AlertDialogPrimitive.Trigger\n\nconst AlertDialogPortal = AlertDialogPrimitive.Portal\n\nconst AlertDialogOverlay = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nAlertDialogOverlay.displayName = AlertDialogPrimitive.Overlay.displayName\n\nconst AlertDialogContent = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPortal>\n    <AlertDialogOverlay />\n    <AlertDialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    />\n  </AlertDialogPortal>\n))\nAlertDialogContent.displayName = AlertDialogPrimitive.Content.displayName\n\nconst AlertDialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogHeader.displayName = \"AlertDialogHeader\"\n\nconst AlertDialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogFooter.displayName = \"AlertDialogFooter\"\n\nconst AlertDialogTitle = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold\", className)}\n    {...props}\n  />\n))\nAlertDialogTitle.displayName = AlertDialogPrimitive.Title.displayName\n\nconst AlertDialogDescription = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nAlertDialogDescription.displayName =\n  AlertDialogPrimitive.Description.displayName\n\nconst AlertDialogAction = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Action>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Action>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Action\n    ref={ref}\n    className={cn(buttonVariants(), className)}\n    {...props}\n  />\n))\nAlertDialogAction.displayName = AlertDialogPrimitive.Action.displayName\n\nconst AlertDialogCancel = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Cancel>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Cancel>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Cancel\n    ref={ref}\n    className={cn(\n      buttonVariants({ variant: \"outline\" }),\n      \"mt-2 sm:mt-0\",\n      className\n    )}\n    {...props}\n  />\n))\nAlertDialogCancel.displayName = AlertDialogPrimitive.Cancel.displayName\n\nexport {\n  AlertDialog,\n  AlertDialogPortal,\n  AlertDialogOverlay,\n  AlertDialogTrigger,\n  AlertDialogContent,\n  AlertDialogHeader,\n  AlertDialogFooter,\n  AlertDialogTitle,\n  AlertDialogDescription,\n  AlertDialogAction,\n  AlertDialogCancel,\n}\n","path":null,"size_bytes":4419,"size_tokens":null},"client/src/features/search/components/search-results-list.tsx":{"content":"import { useState, useEffect, useRef, useCallback } from \"react\";\nimport { motion } from \"framer-motion\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\nimport { Button } from \"@/components/ui/button\";\nimport { DropdownMenu, DropdownMenuContent, DropdownMenuItem, DropdownMenuTrigger } from \"@/components/ui/dropdown-menu\";\nimport { MapPin, MoreHorizontal, Download, Share2, Search, Loader2 } from \"lucide-react\";\nimport { SearchResult } from \"../types\";\n\ninterface SearchResultsListProps {\n  isLoading: boolean;\n  filteredResults: SearchResult[];\n  setHoveredResultId: (id: number | null) => void;\n  setPreviewedResultId: (id: number | null) => void;\n  setLocation: (loc: string) => void;\n  onFilterByFormat?: (format: string) => void;\n  onFilterByProvider?: (provider: string) => void;\n  showFacets?: boolean;\n  showMap?: boolean;\n}\n\nconst ITEMS_PER_PAGE = 12;\n\nexport function SearchResultsList({\n  isLoading,\n  filteredResults,\n  setHoveredResultId,\n  setPreviewedResultId,\n  setLocation,\n  onFilterByFormat,\n  onFilterByProvider,\n  showFacets = true,\n  showMap = true\n}: SearchResultsListProps) {\n  const [visibleCount, setVisibleCount] = useState(ITEMS_PER_PAGE);\n  const [isLoadingMore, setIsLoadingMore] = useState(false);\n  const loadMoreRef = useRef<HTMLDivElement>(null);\n\n  // Reset visible count when results change\n  useEffect(() => {\n    setVisibleCount(ITEMS_PER_PAGE);\n  }, [filteredResults.length]);\n\n  // Infinite scroll observer\n  useEffect(() => {\n    const observer = new IntersectionObserver(\n      (entries) => {\n        if (entries[0].isIntersecting && visibleCount < filteredResults.length && !isLoadingMore) {\n          setIsLoadingMore(true);\n          // Simulate loading delay for smooth UX\n          setTimeout(() => {\n            setVisibleCount(prev => Math.min(prev + ITEMS_PER_PAGE, filteredResults.length));\n            setIsLoadingMore(false);\n          }, 300);\n        }\n      },\n      { threshold: 0.1, rootMargin: '100px' }\n    );\n\n    if (loadMoreRef.current) {\n      observer.observe(loadMoreRef.current);\n    }\n\n    return () => observer.disconnect();\n  }, [visibleCount, filteredResults.length, isLoadingMore]);\n\n  const visibleResults = filteredResults.slice(0, visibleCount);\n  const hasMore = visibleCount < filteredResults.length;\n\n  // Adjust grid columns based on which panels are visible\n  const getGridCols = () => {\n    if (!showFacets && !showMap) {\n      return \"grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 2xl:grid-cols-6\";\n    } else if (!showFacets || !showMap) {\n      return \"grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 xl:grid-cols-4 2xl:grid-cols-5\";\n    }\n    return \"grid-cols-1 sm:grid-cols-2 lg:grid-cols-2 xl:grid-cols-3 2xl:grid-cols-4\";\n  };\n\n  return (\n    <div className=\"flex-1 flex flex-col min-w-0 bg-muted/30 dark:bg-background/50\">\n       <ScrollArea className=\"flex-1\">\n         <div className=\"p-4\">\n           {isLoading ? (\n             <div className={`grid ${getGridCols()} gap-4`}>\n               {Array.from({ length: 8 }).map((_, i) => (\n                 <div key={i} className=\"flex flex-col h-[300px] rounded-xl border border-border overflow-hidden bg-card\">\n                   <Skeleton className=\"h-[160px] w-full rounded-none\" />\n                   <div className=\"p-3 flex-1 flex flex-col space-y-2\">\n                     <Skeleton className=\"h-4 w-3/4\" />\n                     <div className=\"space-y-1 pt-2\">\n                       <Skeleton className=\"h-3 w-1/2\" />\n                       <Skeleton className=\"h-3 w-1/3\" />\n                       <Skeleton className=\"h-3 w-1/4\" />\n                     </div>\n                     <div className=\"mt-auto pt-2 flex justify-between items-center\">\n                        <Skeleton className=\"h-6 w-16 rounded-full\" />\n                        <Skeleton className=\"h-6 w-16\" />\n                     </div>\n                   </div>\n                 </div>\n               ))}\n             </div>\n           ) : filteredResults.length > 0 ? (\n             <>\n               <div className={`grid ${getGridCols()} gap-4`}>\n                 {visibleResults.map((result, i) => (\n                   <motion.div\n                     key={result.id}\n                     initial={{ opacity: 0, y: 20 }}\n                     animate={{ opacity: 1, y: 0 }}\n                     transition={{ delay: Math.min(i * 0.03, 0.3), duration: 0.3 }}\n                     className=\"group relative flex flex-col rounded-xl border border-border bg-card overflow-hidden hover:shadow-xl hover:border-primary/50 transition-all duration-300 cursor-pointer h-[320px]\"\n                     onMouseEnter={() => setHoveredResultId(result.id)}\n                     onMouseLeave={() => setHoveredResultId(null)}\n                     onClick={() => setLocation(`/item/${result.id}`)}\n                   >\n                     {/* Image Thumbnail */}\n                     <div className=\"relative h-[160px] overflow-hidden bg-muted\">\n                       <img \n                         src={result.thumbnail} \n                         alt={result.title}\n                         className=\"w-full h-full object-cover transition-transform duration-700 group-hover:scale-110\"\n                         loading=\"lazy\"\n                       />\n                       <div className=\"absolute inset-0 bg-gradient-to-t from-black/60 to-transparent opacity-60\" />\n                       \n                       {/* Quick Actions Overlay */}\n                       <div className=\"absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center gap-2 backdrop-blur-[2px]\">\n                          <button \n                            className=\"px-3 py-1.5 bg-white text-black text-xs font-bold rounded-full hover:bg-gray-200 transition-colors shadow-lg transform translate-y-4 group-hover:translate-y-0 duration-300\"\n                            onClick={(e) => {\n                              e.stopPropagation();\n                              setLocation(`/item/${result.id}`);\n                            }}\n                          >\n                            View Details\n                          </button>\n                          <button \n                            className=\"p-1.5 bg-black/50 text-white rounded-full hover:bg-black/70 transition-colors border border-white/20 transform translate-y-4 group-hover:translate-y-0 duration-300 delay-75\"\n                            onClick={(e) => {\n                              e.stopPropagation();\n                              setPreviewedResultId(result.id);\n                            }}\n                            title=\"Locate on Map\"\n                          >\n                            <MapPin className=\"w-4 h-4\" />\n                          </button>\n                       </div>\n                     </div>\n\n                     {/* Content */}\n                     <div className=\"p-4 flex-1 flex flex-col gap-1.5\">\n                       <h3 className=\"font-display font-bold text-base leading-tight group-hover:text-primary transition-colors line-clamp-2\" title={result.title}>\n                         {result.title}\n                       </h3>\n                       <div className=\"text-xs text-muted-foreground space-y-0.5 mt-1\">\n                         <p>\n                           <span className=\"text-foreground/70\">Format:</span>{' '}\n                           <button \n                             className=\"text-primary hover:underline\"\n                             onClick={(e) => { e.stopPropagation(); if (result.format) onFilterByFormat?.(result.format); }}\n                           >\n                             {result.format || 'Unknown'}\n                           </button>\n                         </p>\n                         <p>\n                           <span className=\"text-foreground/70\">Author:</span>{' '}\n                           <button \n                             className=\"text-primary hover:underline\"\n                             onClick={(e) => { e.stopPropagation(); if (result.provider) onFilterByProvider?.(result.provider); }}\n                           >\n                             {result.provider || 'Unknown'}\n                           </button>\n                         </p>\n                       </div>\n                       <div className=\"mt-auto flex justify-end\">\n                         <DropdownMenu>\n                           <DropdownMenuTrigger asChild onClick={(e) => e.stopPropagation()}>\n                             <Button variant=\"ghost\" size=\"sm\" className=\"h-7 px-2 text-xs gap-1 text-muted-foreground hover:text-foreground\">\n                               <MoreHorizontal className=\"w-4 h-4\" />\n                               Tools\n                             </Button>\n                           </DropdownMenuTrigger>\n                           <DropdownMenuContent align=\"end\" onClick={(e) => e.stopPropagation()}>\n                             <DropdownMenuItem className=\"gap-2 cursor-pointer\">\n                               <Download className=\"w-4 h-4\" />\n                               Download\n                             </DropdownMenuItem>\n                             <DropdownMenuItem className=\"gap-2 cursor-pointer\">\n                               <Share2 className=\"w-4 h-4\" />\n                               Share\n                             </DropdownMenuItem>\n                           </DropdownMenuContent>\n                         </DropdownMenu>\n                       </div>\n                     </div>\n                     \n                     {/* Hover Border Effect */}\n                     <div className=\"absolute inset-0 border-2 border-primary opacity-0 group-hover:opacity-100 rounded-xl pointer-events-none transition-opacity duration-300\" />\n                   </motion.div>\n                 ))}\n               </div>\n               \n               {/* Load More Trigger */}\n               {hasMore && (\n                 <div ref={loadMoreRef} className=\"flex justify-center items-center py-8\">\n                   {isLoadingMore && (\n                     <div className=\"flex items-center gap-2 text-muted-foreground\">\n                       <Loader2 className=\"w-5 h-5 animate-spin\" />\n                       <span className=\"text-sm\">Loading more...</span>\n                     </div>\n                   )}\n                 </div>\n               )}\n             </>\n           ) : (\n             <div className=\"flex flex-col items-center justify-center h-[50vh] text-center p-8 border border-dashed border-border rounded-xl bg-muted/10\">\n               <div className=\"w-16 h-16 rounded-full bg-muted flex items-center justify-center mb-4\">\n                 <Search className=\"w-8 h-8 text-muted-foreground\" />\n               </div>\n               <h3 className=\"text-xl font-bold mb-2\">No results found</h3>\n               <p className=\"text-muted-foreground max-w-sm mb-6\">\n                 Try adjusting your search terms, location, or filters to find what you're looking for.\n               </p>\n               <Button variant=\"outline\" onClick={() => window.location.reload()}>Clear Filters</Button>\n             </div>\n           )}\n         </div>\n       </ScrollArea>\n    </div>\n  );\n}\n","path":null,"size_bytes":11366,"size_tokens":null},"server/static.ts":{"content":"import express, { type Express } from \"express\";\nimport fs from \"fs\";\nimport path from \"path\";\n\nexport function serveStatic(app: Express) {\n  const distPath = path.resolve(__dirname, \"public\");\n  if (!fs.existsSync(distPath)) {\n    throw new Error(\n      `Could not find the build directory: ${distPath}, make sure to build the client first`,\n    );\n  }\n\n  app.use(express.static(distPath));\n\n  // fall through to index.html if the file doesn't exist\n  app.use(\"*\", (_req, res) => {\n    res.sendFile(path.resolve(distPath, \"index.html\"));\n  });\n}\n","path":null,"size_bytes":547,"size_tokens":null},"client/src/components/ui/alert.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst alertVariants = cva(\n  \"relative w-full rounded-lg border px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground [&>svg~*]:pl-7\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-background text-foreground\",\n        destructive:\n          \"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Alert = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>\n>(({ className, variant, ...props }, ref) => (\n  <div\n    ref={ref}\n    role=\"alert\"\n    className={cn(alertVariants({ variant }), className)}\n    {...props}\n  />\n))\nAlert.displayName = \"Alert\"\n\nconst AlertTitle = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLHeadingElement>\n>(({ className, ...props }, ref) => (\n  <h5\n    ref={ref}\n    className={cn(\"mb-1 font-medium leading-none tracking-tight\", className)}\n    {...props}\n  />\n))\nAlertTitle.displayName = \"AlertTitle\"\n\nconst AlertDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm [&_p]:leading-relaxed\", className)}\n    {...props}\n  />\n))\nAlertDescription.displayName = \"AlertDescription\"\n\nexport { Alert, AlertTitle, AlertDescription }\n","path":null,"size_bytes":1598,"size_tokens":null},"vite-plugin-meta-images.ts":{"content":"import type { Plugin } from 'vite';\nimport fs from 'fs';\nimport path from 'path';\n\n/**\n * Vite plugin that updates og:image and twitter:image meta tags\n * to point to the app's opengraph image with the correct Replit domain.\n */\nexport function metaImagesPlugin(): Plugin {\n  return {\n    name: 'vite-plugin-meta-images',\n    transformIndexHtml(html) {\n      const baseUrl = getDeploymentUrl();\n      if (!baseUrl) {\n        log('[meta-images] no Replit deployment domain found, skipping meta tag updates');\n        return html;\n      }\n\n      // Check if opengraph image exists in public directory\n      const publicDir = path.resolve(process.cwd(), 'client', 'public');\n      const opengraphPngPath = path.join(publicDir, 'opengraph.png');\n      const opengraphJpgPath = path.join(publicDir, 'opengraph.jpg');\n      const opengraphJpegPath = path.join(publicDir, 'opengraph.jpeg');\n\n      let imageExt: string | null = null;\n      if (fs.existsSync(opengraphPngPath)) {\n        imageExt = 'png';\n      } else if (fs.existsSync(opengraphJpgPath)) {\n        imageExt = 'jpg';\n      } else if (fs.existsSync(opengraphJpegPath)) {\n        imageExt = 'jpeg';\n      }\n\n      if (!imageExt) {\n        log('[meta-images] OpenGraph image not found, skipping meta tag updates');\n        return html;\n      }\n\n      const imageUrl = `${baseUrl}/opengraph.${imageExt}`;\n\n      log('[meta-images] updating meta image tags to:', imageUrl);\n\n      html = html.replace(\n        /<meta\\s+property=\"og:image\"\\s+content=\"[^\"]*\"\\s*\\/>/g,\n        `<meta property=\"og:image\" content=\"${imageUrl}\" />`\n      );\n\n      html = html.replace(\n        /<meta\\s+name=\"twitter:image\"\\s+content=\"[^\"]*\"\\s*\\/>/g,\n        `<meta name=\"twitter:image\" content=\"${imageUrl}\" />`\n      );\n\n      return html;\n    },\n  };\n}\n\nfunction getDeploymentUrl(): string | null {\n  if (process.env.REPLIT_INTERNAL_APP_DOMAIN) {\n    const url = `https://${process.env.REPLIT_INTERNAL_APP_DOMAIN}`;\n    log('[meta-images] using internal app domain:', url);\n    return url;\n  }\n\n  if (process.env.REPLIT_DEV_DOMAIN) {\n    const url = `https://${process.env.REPLIT_DEV_DOMAIN}`;\n    log('[meta-images] using dev domain:', url);\n    return url;\n  }\n\n  return null;\n}\n\nfunction log(...args: any[]): void {\n  if (process.env.NODE_ENV === 'production') {\n    console.log(...args);\n  }\n}\n","path":null,"size_bytes":2333,"size_tokens":null},"client/src/components/ui/drawer.tsx":{"content":"import * as React from \"react\"\nimport { Drawer as DrawerPrimitive } from \"vaul\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Drawer = ({\n  shouldScaleBackground = true,\n  ...props\n}: React.ComponentProps<typeof DrawerPrimitive.Root>) => (\n  <DrawerPrimitive.Root\n    shouldScaleBackground={shouldScaleBackground}\n    {...props}\n  />\n)\nDrawer.displayName = \"Drawer\"\n\nconst DrawerTrigger = DrawerPrimitive.Trigger\n\nconst DrawerPortal = DrawerPrimitive.Portal\n\nconst DrawerClose = DrawerPrimitive.Close\n\nconst DrawerOverlay = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Overlay\n    ref={ref}\n    className={cn(\"fixed inset-0 z-50 bg-black/80\", className)}\n    {...props}\n  />\n))\nDrawerOverlay.displayName = DrawerPrimitive.Overlay.displayName\n\nconst DrawerContent = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DrawerPortal>\n    <DrawerOverlay />\n    <DrawerPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background\",\n        className\n      )}\n      {...props}\n    >\n      <div className=\"mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted\" />\n      {children}\n    </DrawerPrimitive.Content>\n  </DrawerPortal>\n))\nDrawerContent.displayName = \"DrawerContent\"\n\nconst DrawerHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"grid gap-1.5 p-4 text-center sm:text-left\", className)}\n    {...props}\n  />\n)\nDrawerHeader.displayName = \"DrawerHeader\"\n\nconst DrawerFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"mt-auto flex flex-col gap-2 p-4\", className)}\n    {...props}\n  />\n)\nDrawerFooter.displayName = \"DrawerFooter\"\n\nconst DrawerTitle = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDrawerTitle.displayName = DrawerPrimitive.Title.displayName\n\nconst DrawerDescription = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDrawerDescription.displayName = DrawerPrimitive.Description.displayName\n\nexport {\n  Drawer,\n  DrawerPortal,\n  DrawerOverlay,\n  DrawerTrigger,\n  DrawerClose,\n  DrawerContent,\n  DrawerHeader,\n  DrawerFooter,\n  DrawerTitle,\n  DrawerDescription,\n}\n","path":null,"size_bytes":3007,"size_tokens":null},"client/src/components/ui/card.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"rounded-xl border bg-card text-card-foreground shadow\",\n      className\n    )}\n    {...props}\n  />\n))\nCard.displayName = \"Card\"\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\n    {...props}\n  />\n))\nCardHeader.displayName = \"CardHeader\"\n\nconst CardTitle = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"font-semibold leading-none tracking-tight\", className)}\n    {...props}\n  />\n))\nCardTitle.displayName = \"CardTitle\"\n\nconst CardDescription = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nCardDescription.displayName = \"CardDescription\"\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex items-center p-6 pt-0\", className)}\n    {...props}\n  />\n))\nCardFooter.displayName = \"CardFooter\"\n\nexport { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent }\n","path":null,"size_bytes":1828,"size_tokens":null},"client/src/components/ui/kbd.tsx":{"content":"import { cn } from \"@/lib/utils\"\n\nfunction Kbd({ className, ...props }: React.ComponentProps<\"kbd\">) {\n  return (\n    <kbd\n      data-slot=\"kbd\"\n      className={cn(\n        \"bg-muted text-muted-foreground pointer-events-none inline-flex h-5 w-fit min-w-5 select-none items-center justify-center gap-1 rounded-sm px-1 font-sans text-xs font-medium\",\n        \"[&_svg:not([class*='size-'])]:size-3\",\n        \"[[data-slot=tooltip-content]_&]:bg-background/20 [[data-slot=tooltip-content]_&]:text-background dark:[[data-slot=tooltip-content]_&]:bg-background/10\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction KbdGroup({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <kbd\n      data-slot=\"kbd-group\"\n      className={cn(\"inline-flex items-center gap-1\", className)}\n      {...props}\n    />\n  )\n}\n\nexport { Kbd, KbdGroup }\n","path":null,"size_bytes":862,"size_tokens":null},"client/src/features/search/api.ts":{"content":"import { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport type { SatelliteItem, RelatedItem, ProvenanceEvent, SavedSearch } from \"@shared/schema\";\n\ninterface SearchFilters {\n  keyword?: string;\n  location?: string;\n  locationIds?: string[];\n  keywords?: string[];\n  properties?: string[];\n  dateFrom?: string;\n  dateTo?: string;\n  platform?: string;\n  sortBy?: string;\n  limit?: number;\n  offset?: number;\n}\n\n// Fetch satellite items with filters\nasync function fetchSatelliteItems(filters: SearchFilters): Promise<SatelliteItem[]> {\n  const params = new URLSearchParams();\n  \n  Object.entries(filters).forEach(([key, value]) => {\n    if (value !== undefined && value !== null) {\n      if (Array.isArray(value)) {\n        value.forEach(v => params.append(key, String(v)));\n      } else {\n        params.append(key, String(value));\n      }\n    }\n  });\n\n  const response = await fetch(`/api/satellite-items?${params}`);\n  if (!response.ok) {\n    throw new Error('Failed to fetch satellite items');\n  }\n  return response.json();\n}\n\n// Fetch single satellite item\nasync function fetchSatelliteItem(id: number): Promise<SatelliteItem> {\n  const response = await fetch(`/api/satellite-items/${id}`);\n  if (!response.ok) {\n    throw new Error('Failed to fetch satellite item');\n  }\n  return response.json();\n}\n\n// Fetch related items\nasync function fetchRelatedItems(id: number): Promise<RelatedItem[]> {\n  const response = await fetch(`/api/satellite-items/${id}/related`);\n  if (!response.ok) {\n    throw new Error('Failed to fetch related items');\n  }\n  return response.json();\n}\n\n// Fetch provenance events\nasync function fetchProvenanceEvents(id: number): Promise<ProvenanceEvent[]> {\n  const response = await fetch(`/api/satellite-items/${id}/provenance`);\n  if (!response.ok) {\n    throw new Error('Failed to fetch provenance events');\n  }\n  return response.json();\n}\n\n// Create saved search\nasync function createSavedSearch(data: {\n  userId?: string;\n  name: string;\n  keyword?: string;\n  location?: string;\n  locationIds?: string[];\n  keywords?: string[];\n  properties?: string[];\n  dateFrom?: Date;\n  dateTo?: Date;\n  spatialFilter?: any;\n  notifyOnNewResults?: number;\n}): Promise<SavedSearch> {\n  const response = await fetch('/api/saved-searches', {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify(data),\n  });\n  if (!response.ok) {\n    throw new Error('Failed to save search');\n  }\n  return response.json();\n}\n\n// React Query Hooks\n\nexport function useSatelliteItems(filters: SearchFilters) {\n  return useQuery({\n    queryKey: ['satelliteItems', filters],\n    queryFn: () => fetchSatelliteItems(filters),\n  });\n}\n\nexport function useSatelliteItem(id: number) {\n  return useQuery({\n    queryKey: ['satelliteItem', id],\n    queryFn: () => fetchSatelliteItem(id),\n    enabled: !!id,\n  });\n}\n\nexport function useRelatedItems(id: number) {\n  return useQuery({\n    queryKey: ['relatedItems', id],\n    queryFn: () => fetchRelatedItems(id),\n    enabled: !!id,\n  });\n}\n\nexport function useProvenanceEvents(id: number) {\n  return useQuery({\n    queryKey: ['provenanceEvents', id],\n    queryFn: () => fetchProvenanceEvents(id),\n    enabled: !!id,\n  });\n}\n\nexport function useSaveSearch() {\n  const queryClient = useQueryClient();\n  \n  return useMutation({\n    mutationFn: createSavedSearch,\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['savedSearches'] });\n    },\n  });\n}\n","path":null,"size_bytes":3473,"size_tokens":null},"client/src/main.tsx":{"content":"import { createRoot } from \"react-dom/client\";\nimport App from \"./App\";\nimport \"./index.css\";\n\ncreateRoot(document.getElementById(\"root\")!).render(<App />);\n","path":null,"size_bytes":157,"size_tokens":null},"client/src/components/ui/chart.tsx":{"content":"import * as React from \"react\"\nimport * as RechartsPrimitive from \"recharts\"\n\nimport { cn } from \"@/lib/utils\"\n\n// Format: { THEME_NAME: CSS_SELECTOR }\nconst THEMES = { light: \"\", dark: \".dark\" } as const\n\nexport type ChartConfig = {\n  [k in string]: {\n    label?: React.ReactNode\n    icon?: React.ComponentType\n  } & (\n    | { color?: string; theme?: never }\n    | { color?: never; theme: Record<keyof typeof THEMES, string> }\n  )\n}\n\ntype ChartContextProps = {\n  config: ChartConfig\n}\n\nconst ChartContext = React.createContext<ChartContextProps | null>(null)\n\nfunction useChart() {\n  const context = React.useContext(ChartContext)\n\n  if (!context) {\n    throw new Error(\"useChart must be used within a <ChartContainer />\")\n  }\n\n  return context\n}\n\nconst ChartContainer = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    config: ChartConfig\n    children: React.ComponentProps<\n      typeof RechartsPrimitive.ResponsiveContainer\n    >[\"children\"]\n  }\n>(({ id, className, children, config, ...props }, ref) => {\n  const uniqueId = React.useId()\n  const chartId = `chart-${id || uniqueId.replace(/:/g, \"\")}`\n\n  return (\n    <ChartContext.Provider value={{ config }}>\n      <div\n        data-chart={chartId}\n        ref={ref}\n        className={cn(\n          \"flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none\",\n          className\n        )}\n        {...props}\n      >\n        <ChartStyle id={chartId} config={config} />\n        <RechartsPrimitive.ResponsiveContainer>\n          {children}\n        </RechartsPrimitive.ResponsiveContainer>\n      </div>\n    </ChartContext.Provider>\n  )\n})\nChartContainer.displayName = \"Chart\"\n\nconst ChartStyle = ({ id, config }: { id: string; config: ChartConfig }) => {\n  const colorConfig = Object.entries(config).filter(\n    ([, config]) => config.theme || config.color\n  )\n\n  if (!colorConfig.length) {\n    return null\n  }\n\n  return (\n    <style\n      dangerouslySetInnerHTML={{\n        __html: Object.entries(THEMES)\n          .map(\n            ([theme, prefix]) => `\n${prefix} [data-chart=${id}] {\n${colorConfig\n  .map(([key, itemConfig]) => {\n    const color =\n      itemConfig.theme?.[theme as keyof typeof itemConfig.theme] ||\n      itemConfig.color\n    return color ? `  --color-${key}: ${color};` : null\n  })\n  .join(\"\\n\")}\n}\n`\n          )\n          .join(\"\\n\"),\n      }}\n    />\n  )\n}\n\nconst ChartTooltip = RechartsPrimitive.Tooltip\n\nconst ChartTooltipContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<typeof RechartsPrimitive.Tooltip> &\n    React.ComponentProps<\"div\"> & {\n      hideLabel?: boolean\n      hideIndicator?: boolean\n      indicator?: \"line\" | \"dot\" | \"dashed\"\n      nameKey?: string\n      labelKey?: string\n    }\n>(\n  (\n    {\n      active,\n      payload,\n      className,\n      indicator = \"dot\",\n      hideLabel = false,\n      hideIndicator = false,\n      label,\n      labelFormatter,\n      labelClassName,\n      formatter,\n      color,\n      nameKey,\n      labelKey,\n    },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    const tooltipLabel = React.useMemo(() => {\n      if (hideLabel || !payload?.length) {\n        return null\n      }\n\n      const [item] = payload\n      const key = `${labelKey || item?.dataKey || item?.name || \"value\"}`\n      const itemConfig = getPayloadConfigFromPayload(config, item, key)\n      const value =\n        !labelKey && typeof label === \"string\"\n          ? config[label as keyof typeof config]?.label || label\n          : itemConfig?.label\n\n      if (labelFormatter) {\n        return (\n          <div className={cn(\"font-medium\", labelClassName)}>\n            {labelFormatter(value, payload)}\n          </div>\n        )\n      }\n\n      if (!value) {\n        return null\n      }\n\n      return <div className={cn(\"font-medium\", labelClassName)}>{value}</div>\n    }, [\n      label,\n      labelFormatter,\n      payload,\n      hideLabel,\n      labelClassName,\n      config,\n      labelKey,\n    ])\n\n    if (!active || !payload?.length) {\n      return null\n    }\n\n    const nestLabel = payload.length === 1 && indicator !== \"dot\"\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl\",\n          className\n        )}\n      >\n        {!nestLabel ? tooltipLabel : null}\n        <div className=\"grid gap-1.5\">\n          {payload\n            .filter((item) => item.type !== \"none\")\n            .map((item, index) => {\n              const key = `${nameKey || item.name || item.dataKey || \"value\"}`\n              const itemConfig = getPayloadConfigFromPayload(config, item, key)\n              const indicatorColor = color || item.payload.fill || item.color\n\n              return (\n                <div\n                  key={item.dataKey}\n                  className={cn(\n                    \"flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground\",\n                    indicator === \"dot\" && \"items-center\"\n                  )}\n                >\n                  {formatter && item?.value !== undefined && item.name ? (\n                    formatter(item.value, item.name, item, index, item.payload)\n                  ) : (\n                    <>\n                      {itemConfig?.icon ? (\n                        <itemConfig.icon />\n                      ) : (\n                        !hideIndicator && (\n                          <div\n                            className={cn(\n                              \"shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]\",\n                              {\n                                \"h-2.5 w-2.5\": indicator === \"dot\",\n                                \"w-1\": indicator === \"line\",\n                                \"w-0 border-[1.5px] border-dashed bg-transparent\":\n                                  indicator === \"dashed\",\n                                \"my-0.5\": nestLabel && indicator === \"dashed\",\n                              }\n                            )}\n                            style={\n                              {\n                                \"--color-bg\": indicatorColor,\n                                \"--color-border\": indicatorColor,\n                              } as React.CSSProperties\n                            }\n                          />\n                        )\n                      )}\n                      <div\n                        className={cn(\n                          \"flex flex-1 justify-between leading-none\",\n                          nestLabel ? \"items-end\" : \"items-center\"\n                        )}\n                      >\n                        <div className=\"grid gap-1.5\">\n                          {nestLabel ? tooltipLabel : null}\n                          <span className=\"text-muted-foreground\">\n                            {itemConfig?.label || item.name}\n                          </span>\n                        </div>\n                        {item.value && (\n                          <span className=\"font-mono font-medium tabular-nums text-foreground\">\n                            {item.value.toLocaleString()}\n                          </span>\n                        )}\n                      </div>\n                    </>\n                  )}\n                </div>\n              )\n            })}\n        </div>\n      </div>\n    )\n  }\n)\nChartTooltipContent.displayName = \"ChartTooltip\"\n\nconst ChartLegend = RechartsPrimitive.Legend\n\nconst ChartLegendContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> &\n    Pick<RechartsPrimitive.LegendProps, \"payload\" | \"verticalAlign\"> & {\n      hideIcon?: boolean\n      nameKey?: string\n    }\n>(\n  (\n    { className, hideIcon = false, payload, verticalAlign = \"bottom\", nameKey },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    if (!payload?.length) {\n      return null\n    }\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"flex items-center justify-center gap-4\",\n          verticalAlign === \"top\" ? \"pb-3\" : \"pt-3\",\n          className\n        )}\n      >\n        {payload\n          .filter((item) => item.type !== \"none\")\n          .map((item) => {\n            const key = `${nameKey || item.dataKey || \"value\"}`\n            const itemConfig = getPayloadConfigFromPayload(config, item, key)\n\n            return (\n              <div\n                key={item.value}\n                className={cn(\n                  \"flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground\"\n                )}\n              >\n                {itemConfig?.icon && !hideIcon ? (\n                  <itemConfig.icon />\n                ) : (\n                  <div\n                    className=\"h-2 w-2 shrink-0 rounded-[2px]\"\n                    style={{\n                      backgroundColor: item.color,\n                    }}\n                  />\n                )}\n                {itemConfig?.label}\n              </div>\n            )\n          })}\n      </div>\n    )\n  }\n)\nChartLegendContent.displayName = \"ChartLegend\"\n\n// Helper to extract item config from a payload.\nfunction getPayloadConfigFromPayload(\n  config: ChartConfig,\n  payload: unknown,\n  key: string\n) {\n  if (typeof payload !== \"object\" || payload === null) {\n    return undefined\n  }\n\n  const payloadPayload =\n    \"payload\" in payload &&\n    typeof payload.payload === \"object\" &&\n    payload.payload !== null\n      ? payload.payload\n      : undefined\n\n  let configLabelKey: string = key\n\n  if (\n    key in payload &&\n    typeof payload[key as keyof typeof payload] === \"string\"\n  ) {\n    configLabelKey = payload[key as keyof typeof payload] as string\n  } else if (\n    payloadPayload &&\n    key in payloadPayload &&\n    typeof payloadPayload[key as keyof typeof payloadPayload] === \"string\"\n  ) {\n    configLabelKey = payloadPayload[\n      key as keyof typeof payloadPayload\n    ] as string\n  }\n\n  return configLabelKey in config\n    ? config[configLabelKey]\n    : config[key as keyof typeof config]\n}\n\nexport {\n  ChartContainer,\n  ChartTooltip,\n  ChartTooltipContent,\n  ChartLegend,\n  ChartLegendContent,\n  ChartStyle,\n}\n","path":null,"size_bytes":10763,"size_tokens":null},"client/src/components/ui/navigation-menu.tsx":{"content":"import * as React from \"react\"\nimport * as NavigationMenuPrimitive from \"@radix-ui/react-navigation-menu\"\nimport { cva } from \"class-variance-authority\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst NavigationMenu = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative z-10 flex max-w-max flex-1 items-center justify-center\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <NavigationMenuViewport />\n  </NavigationMenuPrimitive.Root>\n))\nNavigationMenu.displayName = NavigationMenuPrimitive.Root.displayName\n\nconst NavigationMenuList = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.List\n    ref={ref}\n    className={cn(\n      \"group flex flex-1 list-none items-center justify-center space-x-1\",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuList.displayName = NavigationMenuPrimitive.List.displayName\n\nconst NavigationMenuItem = NavigationMenuPrimitive.Item\n\nconst navigationMenuTriggerStyle = cva(\n  \"group inline-flex h-9 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[state=open]:text-accent-foreground data-[state=open]:bg-accent/50 data-[state=open]:hover:bg-accent data-[state=open]:focus:bg-accent\"\n)\n\nconst NavigationMenuTrigger = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Trigger\n    ref={ref}\n    className={cn(navigationMenuTriggerStyle(), \"group\", className)}\n    {...props}\n  >\n    {children}{\" \"}\n    <ChevronDown\n      className=\"relative top-[1px] ml-1 h-3 w-3 transition duration-300 group-data-[state=open]:rotate-180\"\n      aria-hidden=\"true\"\n    />\n  </NavigationMenuPrimitive.Trigger>\n))\nNavigationMenuTrigger.displayName = NavigationMenuPrimitive.Trigger.displayName\n\nconst NavigationMenuContent = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"left-0 top-0 w-full data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-start]:slide-out-to-left-52 md:absolute md:w-auto \",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuContent.displayName = NavigationMenuPrimitive.Content.displayName\n\nconst NavigationMenuLink = NavigationMenuPrimitive.Link\n\nconst NavigationMenuViewport = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Viewport>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Viewport>\n>(({ className, ...props }, ref) => (\n  <div className={cn(\"absolute left-0 top-full flex justify-center\")}>\n    <NavigationMenuPrimitive.Viewport\n      className={cn(\n        \"origin-top-center relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border bg-popover text-popover-foreground shadow data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 md:w-[var(--radix-navigation-menu-viewport-width)]\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  </div>\n))\nNavigationMenuViewport.displayName =\n  NavigationMenuPrimitive.Viewport.displayName\n\nconst NavigationMenuIndicator = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Indicator>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Indicator>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Indicator\n    ref={ref}\n    className={cn(\n      \"top-full z-[1] flex h-1.5 items-end justify-center overflow-hidden data-[state=visible]:animate-in data-[state=hidden]:animate-out data-[state=hidden]:fade-out data-[state=visible]:fade-in\",\n      className\n    )}\n    {...props}\n  >\n    <div className=\"relative top-[60%] h-2 w-2 rotate-45 rounded-tl-sm bg-border shadow-md\" />\n  </NavigationMenuPrimitive.Indicator>\n))\nNavigationMenuIndicator.displayName =\n  NavigationMenuPrimitive.Indicator.displayName\n\nexport {\n  navigationMenuTriggerStyle,\n  NavigationMenu,\n  NavigationMenuList,\n  NavigationMenuItem,\n  NavigationMenuContent,\n  NavigationMenuTrigger,\n  NavigationMenuLink,\n  NavigationMenuIndicator,\n  NavigationMenuViewport,\n}\n","path":null,"size_bytes":5124,"size_tokens":null},"client/src/pages/not-found.tsx":{"content":"import { Card, CardContent } from \"@/components/ui/card\";\nimport { AlertCircle } from \"lucide-react\";\n\nexport default function NotFound() {\n  return (\n    <div className=\"min-h-screen w-full flex items-center justify-center bg-gray-50\">\n      <Card className=\"w-full max-w-md mx-4\">\n        <CardContent className=\"pt-6\">\n          <div className=\"flex mb-4 gap-2\">\n            <AlertCircle className=\"h-8 w-8 text-red-500\" />\n            <h1 className=\"text-2xl font-bold text-gray-900\">404 Page Not Found</h1>\n          </div>\n\n          <p className=\"mt-4 text-sm text-gray-600\">\n            Did you forget to add the page to the router?\n          </p>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","path":null,"size_bytes":711,"size_tokens":null},"client/src/components/ui/collapsible.tsx":{"content":"\"use client\"\n\nimport * as CollapsiblePrimitive from \"@radix-ui/react-collapsible\"\n\nconst Collapsible = CollapsiblePrimitive.Root\n\nconst CollapsibleTrigger = CollapsiblePrimitive.CollapsibleTrigger\n\nconst CollapsibleContent = CollapsiblePrimitive.CollapsibleContent\n\nexport { Collapsible, CollapsibleTrigger, CollapsibleContent }\n","path":null,"size_bytes":329,"size_tokens":null},"client/src/components/ui/toggle.tsx":{"content":"import * as React from \"react\"\nimport * as TogglePrimitive from \"@radix-ui/react-toggle\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst toggleVariants = cva(\n  \"inline-flex items-center justify-center gap-2 rounded-md text-sm font-medium transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-transparent\",\n        outline:\n          \"border border-input bg-transparent shadow-sm hover:bg-accent hover:text-accent-foreground\",\n      },\n      size: {\n        default: \"h-9 px-2 min-w-9\",\n        sm: \"h-8 px-1.5 min-w-8\",\n        lg: \"h-10 px-2.5 min-w-10\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nconst Toggle = React.forwardRef<\n  React.ElementRef<typeof TogglePrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof TogglePrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, ...props }, ref) => (\n  <TogglePrimitive.Root\n    ref={ref}\n    className={cn(toggleVariants({ variant, size, className }))}\n    {...props}\n  />\n))\n\nToggle.displayName = TogglePrimitive.Root.displayName\n\nexport { Toggle, toggleVariants }\n","path":null,"size_bytes":1486,"size_tokens":null},"client/src/features/search/mock-data.ts":{"content":"import { LatLngBoundsExpression } from 'leaflet';\nimport { SearchResult, TreeNode } from './types';\nimport stockImage from '@assets/stock_images/satellite_radar_imag_5d3e79b8.jpg';\nimport desertImage from '@assets/stock_images/satellite_view_of_de_09a0f404.jpg';\nimport oceanImage from '@assets/stock_images/satellite_view_of_oc_86576cd8.jpg';\nimport forestImage from '@assets/stock_images/satellite_view_of_de_03f9764a.jpg';\nimport agriImage from '@assets/stock_images/satellite_view_of_ag_ebac3a20.jpg';\nimport snowImage from '@assets/stock_images/satellite_view_of_sn_8f021214.jpg';\nimport cityImage from '@assets/stock_images/satellite_view_of_ci_093e163a.jpg';\nimport sarImage from '@assets/stock_images/satellite_radar_sar__0ff421fd.jpg';\n\n// Mock Data Generators\nexport const PLATFORMS = [\n  { name: \"Sentinel-2\", provider: \"ESA\", type: \"Optical\" },\n  { name: \"Landsat 8\", provider: \"USGS\", type: \"Optical\" },\n  { name: \"Landsat 9\", provider: \"USGS\", type: \"Optical\" },\n  { name: \"WorldView-3\", provider: \"Maxar\", type: \"Optical\" },\n  { name: \"PlanetScope\", provider: \"Planet\", type: \"Optical\" },\n  { name: \"BlackSky Global\", provider: \"BlackSky\", type: \"Optical\" },\n  { name: \"Capella-2\", provider: \"Capella Space\", type: \"SAR\" },\n  { name: \"ICEYE-X\", provider: \"ICEYE\", type: \"SAR\" },\n  { name: \"SPOT 7\", provider: \"Airbus\", type: \"Optical\" },\n  { name: \"Pleiades Neo\", provider: \"Airbus\", type: \"Optical\" }\n];\n\nexport const THUMBNAILS = [\n  stockImage,\n  desertImage,\n  oceanImage,\n  forestImage,\n  agriImage,\n  snowImage,\n  cityImage,\n  sarImage,\n  \"https://images.unsplash.com/photo-1451187580459-43490279c0fa?q=80&w=300&auto=format&fit=crop\",\n  \"https://images.unsplash.com/photo-1446776811953-b23d57bd21aa?q=80&w=300&auto=format&fit=crop\",\n  \"https://images.unsplash.com/photo-1529788295308-1eace6f67388?q=80&w=300&auto=format&fit=crop\"\n];\n\nexport const TITLES: Record<string, string[]> = {\n  \"Sentinel-2\": [\"MSI Level-1C\", \"MSI Level-2A\"],\n  \"Landsat 8\": [\"OLI/TIRS C2 L1\", \"OLI/TIRS C2 L2\"],\n  \"Landsat 9\": [\"OLI/TIRS C2 L1\", \"OLI/TIRS C2 L2\"],\n  \"WorldView-3\": [\"SWIR\", \"Pan-Sharpened\", \"Multispectral\"],\n  \"PlanetScope\": [\"3m Imagery\", \"Ortho Scene\"],\n  \"BlackSky Global\": [\"Spectra AI\", \"Standard Imagery\"],\n  \"Capella-2\": [\"SAR SLC\", \"SAR GEO\"],\n  \"ICEYE-X\": [\"SAR X-band\", \"SAR SLC\"],\n  \"SPOT 7\": [\"1.5m Imagery\", \"Panchromatic\"],\n  \"Pleiades Neo\": [\"30cm Imagery\", \"Panchromatic\"]\n};\n\nexport const HIERARCHY_TREE: TreeNode[] = [\n  {\n    id: \"na\",\n    label: \"North America\",\n    children: [\n      { \n        id: \"usa\", \n        label: \"United States\",\n        children: [\n          { id: \"ca\", label: \"California\" },\n          { id: \"ny\", label: \"New York\" },\n          { id: \"tx\", label: \"Texas\" },\n          { id: \"fl\", label: \"Florida\" }\n        ]\n      },\n      { id: \"can\", label: \"Canada\" },\n      { id: \"mex\", label: \"Mexico\" }\n    ]\n  },\n  {\n    id: \"eu\",\n    label: \"Europe\",\n    children: [\n      { \n        id: \"uk\", \n        label: \"United Kingdom\",\n        children: [\n          { id: \"eng\", label: \"England\" },\n          { id: \"sct\", label: \"Scotland\" },\n          { id: \"wls\", label: \"Wales\" }\n        ]\n      },\n      { id: \"fr\", label: \"France\" },\n      { id: \"de\", label: \"Germany\" },\n      { id: \"it\", label: \"Italy\" },\n      { id: \"es\", label: \"Spain\" }\n    ]\n  },\n  {\n    id: \"as\",\n    label: \"Asia\",\n    children: [\n      { id: \"jp\", label: \"Japan\" },\n      { id: \"cn\", label: \"China\" },\n      { id: \"in\", label: \"India\" },\n      { id: \"sg\", label: \"Singapore\" }\n    ]\n  },\n  {\n    id: \"sa\",\n    label: \"South America\",\n    children: [\n      { id: \"br\", label: \"Brazil\" },\n      { id: \"ar\", label: \"Argentina\" },\n      { id: \"cl\", label: \"Chile\" }\n    ]\n  },\n  {\n    id: \"af\",\n    label: \"Africa\",\n    children: [\n      { id: \"eg\", label: \"Egypt\" },\n      { id: \"za\", label: \"South Africa\" },\n      { id: \"ng\", label: \"Nigeria\" },\n      { id: \"ke\", label: \"Kenya\" }\n    ]\n  }\n];\n\nexport const KEYWORDS = [\n  \"Vegetation\", \"Water\", \"Urban\", \"Agriculture\", \"Disaster\", \n  \"Snow/Ice\", \"Clouds\", \"Desert\", \"Forest\", \"Ocean\",\n  \"Infrastructure\", \"Mining\", \"Oil & Gas\", \"Renewable Energy\"\n];\n\nexport const LEAF_IDS = [\n  \"ca\", \"ny\", \"tx\", \"fl\", \"can\", \"mex\",\n  \"eng\", \"sct\", \"wls\", \"fr\", \"de\", \"it\", \"es\",\n  \"jp\", \"cn\", \"in\", \"sg\",\n  \"br\", \"ar\", \"cl\",\n  \"eg\", \"za\", \"ng\", \"ke\"\n];\n\nexport const generateMockResults = (count: number): SearchResult[] => {\n  return Array.from({ length: count }, (_, i) => {\n    const platform = PLATFORMS[i % PLATFORMS.length];\n    const titles = TITLES[platform.name] || [\"Imagery\"];\n    const title = `${platform.name} ${titles[i % titles.length]}`;\n    \n    // Random date within last 30 days\n    const date = new Date();\n    date.setDate(date.getDate() - Math.floor(Math.random() * 30));\n    const dateStr = date.toISOString().split('T')[0];\n    \n    // Random cloud cover (0-100% or N/A for SAR)\n    const isSAR = platform.type === \"SAR\";\n    const cloudCover = isSAR ? \"N/A\" : `${Math.floor(Math.random() * 30)}%`;\n    \n    // Random bounds near Los Angeles for demo\n    const lat = 34.0522 + (Math.random() - 0.5) * 1.0;\n    const lng = -118.2437 + (Math.random() - 0.5) * 1.0;\n    \n    // Random location ID assignment\n    const locationId = LEAF_IDS[Math.floor(Math.random() * LEAF_IDS.length)];\n\n    // Random properties\n    const possibleProps = [\"has_thumbnail\", \"has_spatial\", \"has_temporal\", \"is_downloadable\"];\n    const properties = possibleProps.filter(() => Math.random() > 0.5);\n    \n    // Random keywords\n    const itemKeywords = KEYWORDS.filter(() => Math.random() > 0.95);\n    \n    // Random format\n    const FORMATS = [\"GeoTIFF\", \"NITF\", \"GIMI\", \"LiDAR\", \"JPEG2000\"];\n    const format = FORMATS[Math.floor(Math.random() * FORMATS.length)];\n\n    return {\n      id: i + 1,\n      title,\n      date: dateStr,\n      cloudCover,\n      platform: platform.name,\n      provider: platform.provider,\n      thumbnail: THUMBNAILS[i % THUMBNAILS.length],\n      bounds: [[lat, lng], [lat + 0.05, lng + 0.05]] as LatLngBoundsExpression,\n      locationId,\n      properties,\n      keywords: itemKeywords,\n      format\n    };\n  });\n};\n\nexport const MOCK_RESULTS = generateMockResults(100);\n","path":null,"size_bytes":6163,"size_tokens":null},"client/src/features/search/types.ts":{"content":"import { LatLngBoundsExpression } from 'leaflet';\nimport type { SatelliteItem } from '@shared/schema';\n\nexport interface TreeNode {\n  id: string;\n  label: string;\n  children?: TreeNode[];\n}\n\n// Extend database type with UI-specific fields\nexport interface SearchResult extends Omit<SatelliteItem, 'bounds' | 'acquisitionDate'> {\n  bounds: LatLngBoundsExpression;\n  date: string; // formatted date for display\n}\n\nexport interface FilterState {\n  date?: { from: Date; to?: Date };\n  locationIds: string[];\n  properties: string[];\n  keywords: string[];\n}\n\n// Helper function to validate bounds data\nfunction isValidBounds(bounds: unknown): bounds is [[number, number], [number, number]] {\n  if (!Array.isArray(bounds) || bounds.length !== 2) return false;\n  return bounds.every(coord => \n    Array.isArray(coord) && \n    coord.length === 2 && \n    typeof coord[0] === 'number' && \n    typeof coord[1] === 'number' &&\n    isFinite(coord[0]) && \n    isFinite(coord[1])\n  );\n}\n\n// Default bounds (world view) when bounds are invalid\nconst DEFAULT_BOUNDS: [[number, number], [number, number]] = [[0, 0], [0, 0]];\n\n// Helper function to convert DB item to search result\n// Database stores bounds as [[lng, lat], [lng, lat]] (GeoJSON format)\n// Leaflet expects [[lat, lng], [lat, lng]]\nexport function toSearchResult(item: SatelliteItem): SearchResult {\n  let leafletBounds: [[number, number], [number, number]] = DEFAULT_BOUNDS;\n  \n  if (isValidBounds(item.bounds)) {\n    leafletBounds = [\n      [item.bounds[0][1], item.bounds[0][0]], // swap lat/lng\n      [item.bounds[1][1], item.bounds[1][0]]  // swap lat/lng\n    ];\n  }\n  \n  return {\n    ...item,\n    bounds: leafletBounds,\n    date: new Date(item.acquisitionDate).toISOString().split('T')[0],\n  };\n}\n","path":null,"size_bytes":1748,"size_tokens":null},"server/storage.ts":{"content":"import { \n  users, \n  satelliteItems,\n  relatedItems,\n  provenanceEvents,\n  savedSearches,\n  type User, \n  type UpsertUser,\n  type SatelliteItem,\n  type InsertSatelliteItem,\n  type RelatedItem,\n  type InsertRelatedItem,\n  type ProvenanceEvent,\n  type InsertProvenanceEvent,\n  type SavedSearch,\n  type InsertSavedSearch\n} from \"@shared/schema\";\nimport { db } from \"./db\";\nimport { eq, and, gte, lte, or, inArray, sql, desc, asc } from \"drizzle-orm\";\n\nexport interface IStorage {\n  // User methods (for Replit Auth)\n  getUser(id: string): Promise<User | undefined>;\n  upsertUser(user: UpsertUser): Promise<User>;\n  \n  // Satellite Items methods\n  searchSatelliteItems(filters: {\n    keyword?: string;\n    location?: string;\n    locationIds?: string[];\n    keywords?: string[];\n    properties?: string[];\n    dateFrom?: Date;\n    dateTo?: Date;\n    platform?: string;\n    sortBy?: string;\n    limit?: number;\n    offset?: number;\n  }): Promise<SatelliteItem[]>;\n  \n  getSatelliteItem(id: number): Promise<SatelliteItem | undefined>;\n  createSatelliteItem(item: InsertSatelliteItem): Promise<SatelliteItem>;\n  \n  // Related Items methods\n  getRelatedItems(itemId: number): Promise<RelatedItem[]>;\n  createRelatedItem(relatedItem: InsertRelatedItem): Promise<RelatedItem>;\n  \n  // Provenance methods\n  getProvenanceEvents(itemId: number): Promise<ProvenanceEvent[]>;\n  createProvenanceEvent(event: InsertProvenanceEvent): Promise<ProvenanceEvent>;\n  \n  // Saved Searches methods\n  getSavedSearches(userId: string): Promise<SavedSearch[]>;\n  getSavedSearch(id: number): Promise<SavedSearch | undefined>;\n  createSavedSearch(search: InsertSavedSearch): Promise<SavedSearch>;\n  deleteSavedSearch(id: number): Promise<void>;\n}\n\nexport class DatabaseStorage implements IStorage {\n  // User methods (for Replit Auth)\n  async getUser(id: string): Promise<User | undefined> {\n    const [user] = await db.select().from(users).where(eq(users.id, id));\n    return user || undefined;\n  }\n\n  async upsertUser(userData: UpsertUser): Promise<User> {\n    const [user] = await db\n      .insert(users)\n      .values(userData)\n      .onConflictDoUpdate({\n        target: users.id,\n        set: {\n          ...userData,\n          updatedAt: new Date(),\n        },\n      })\n      .returning();\n    return user;\n  }\n  \n  // Satellite Items methods\n  async searchSatelliteItems(filters: {\n    keyword?: string;\n    location?: string;\n    locationIds?: string[];\n    keywords?: string[];\n    properties?: string[];\n    dateFrom?: Date;\n    dateTo?: Date;\n    platform?: string;\n    sortBy?: string;\n    limit?: number;\n    offset?: number;\n  }): Promise<SatelliteItem[]> {\n    let query = db.select().from(satelliteItems);\n    \n    const conditions = [];\n    \n    // Location filter\n    if (filters.locationIds && filters.locationIds.length > 0) {\n      conditions.push(inArray(satelliteItems.locationId, filters.locationIds));\n    }\n    \n    // Keyword filter (search in title or keywords array)\n    if (filters.keyword) {\n      conditions.push(\n        or(\n          sql`${satelliteItems.title} ILIKE ${'%' + filters.keyword + '%'}`,\n          sql`${filters.keyword} = ANY(${satelliteItems.keywords})`\n        )\n      );\n    }\n    \n    // Keywords array filter (must have all)\n    if (filters.keywords && filters.keywords.length > 0) {\n      for (const kw of filters.keywords) {\n        conditions.push(sql`${kw} = ANY(${satelliteItems.keywords})`);\n      }\n    }\n    \n    // Properties array filter (must have all)\n    if (filters.properties && filters.properties.length > 0) {\n      for (const prop of filters.properties) {\n        conditions.push(sql`${prop} = ANY(${satelliteItems.properties})`);\n      }\n    }\n    \n    // Date range filter\n    if (filters.dateFrom) {\n      conditions.push(gte(satelliteItems.acquisitionDate, filters.dateFrom));\n    }\n    if (filters.dateTo) {\n      conditions.push(lte(satelliteItems.acquisitionDate, filters.dateTo));\n    }\n    \n    // Platform filter\n    if (filters.platform) {\n      conditions.push(eq(satelliteItems.platform, filters.platform));\n    }\n    \n    // Apply all conditions\n    if (conditions.length > 0) {\n      query = query.where(and(...conditions)) as any;\n    }\n    \n    // Sorting\n    if (filters.sortBy === 'date_desc') {\n      query = query.orderBy(desc(satelliteItems.acquisitionDate)) as any;\n    } else if (filters.sortBy === 'date_asc') {\n      query = query.orderBy(asc(satelliteItems.acquisitionDate)) as any;\n    } else if (filters.sortBy === 'name_asc') {\n      query = query.orderBy(asc(satelliteItems.title)) as any;\n    }\n    \n    // Pagination\n    if (filters.limit) {\n      query = query.limit(filters.limit) as any;\n    }\n    if (filters.offset) {\n      query = query.offset(filters.offset) as any;\n    }\n    \n    return await query;\n  }\n  \n  async getSatelliteItem(id: number): Promise<SatelliteItem | undefined> {\n    const [item] = await db.select().from(satelliteItems).where(eq(satelliteItems.id, id));\n    return item || undefined;\n  }\n  \n  async createSatelliteItem(item: InsertSatelliteItem): Promise<SatelliteItem> {\n    const [newItem] = await db\n      .insert(satelliteItems)\n      .values(item)\n      .returning();\n    return newItem;\n  }\n  \n  // Related Items methods\n  async getRelatedItems(itemId: number): Promise<RelatedItem[]> {\n    return await db.select().from(relatedItems).where(eq(relatedItems.itemId, itemId));\n  }\n  \n  async createRelatedItem(relatedItem: InsertRelatedItem): Promise<RelatedItem> {\n    const [item] = await db\n      .insert(relatedItems)\n      .values(relatedItem)\n      .returning();\n    return item;\n  }\n  \n  // Provenance methods\n  async getProvenanceEvents(itemId: number): Promise<ProvenanceEvent[]> {\n    return await db.select().from(provenanceEvents)\n      .where(eq(provenanceEvents.itemId, itemId))\n      .orderBy(asc(provenanceEvents.sortOrder));\n  }\n  \n  async createProvenanceEvent(event: InsertProvenanceEvent): Promise<ProvenanceEvent> {\n    const [newEvent] = await db\n      .insert(provenanceEvents)\n      .values(event)\n      .returning();\n    return newEvent;\n  }\n  \n  // Saved Searches methods\n  async getSavedSearches(userId: string): Promise<SavedSearch[]> {\n    return await db.select().from(savedSearches)\n      .where(eq(savedSearches.userId, userId))\n      .orderBy(desc(savedSearches.createdAt));\n  }\n  \n  async getSavedSearch(id: number): Promise<SavedSearch | undefined> {\n    const [search] = await db.select().from(savedSearches).where(eq(savedSearches.id, id));\n    return search || undefined;\n  }\n  \n  async createSavedSearch(search: InsertSavedSearch): Promise<SavedSearch> {\n    const [newSearch] = await db\n      .insert(savedSearches)\n      .values(search)\n      .returning();\n    return newSearch;\n  }\n  \n  async deleteSavedSearch(id: number): Promise<void> {\n    await db.delete(savedSearches).where(eq(savedSearches.id, id));\n  }\n}\n\nexport const storage = new DatabaseStorage();\n","path":null,"size_bytes":6912,"size_tokens":null},"client/src/components/ui/progress.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ProgressPrimitive from \"@radix-ui/react-progress\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Progress = React.forwardRef<\n  React.ElementRef<typeof ProgressPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ProgressPrimitive.Root>\n>(({ className, value, ...props }, ref) => (\n  <ProgressPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative h-2 w-full overflow-hidden rounded-full bg-primary/20\",\n      className\n    )}\n    {...props}\n  >\n    <ProgressPrimitive.Indicator\n      className=\"h-full w-full flex-1 bg-primary transition-all\"\n      style={{ transform: `translateX(-${100 - (value || 0)}%)` }}\n    />\n  </ProgressPrimitive.Root>\n))\nProgress.displayName = ProgressPrimitive.Root.displayName\n\nexport { Progress }\n","path":null,"size_bytes":792,"size_tokens":null},"client/src/components/ui/textarea.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Textarea = React.forwardRef<\n  HTMLTextAreaElement,\n  React.ComponentProps<\"textarea\">\n>(({ className, ...props }, ref) => {\n  return (\n    <textarea\n      className={cn(\n        \"flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  )\n})\nTextarea.displayName = \"Textarea\"\n\nexport { Textarea }\n","path":null,"size_bytes":649,"size_tokens":null},"client/src/components/ui/carousel.tsx":{"content":"import * as React from \"react\"\nimport useEmblaCarousel, {\n  type UseEmblaCarouselType,\n} from \"embla-carousel-react\"\nimport { ArrowLeft, ArrowRight } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\n\ntype CarouselApi = UseEmblaCarouselType[1]\ntype UseCarouselParameters = Parameters<typeof useEmblaCarousel>\ntype CarouselOptions = UseCarouselParameters[0]\ntype CarouselPlugin = UseCarouselParameters[1]\n\ntype CarouselProps = {\n  opts?: CarouselOptions\n  plugins?: CarouselPlugin\n  orientation?: \"horizontal\" | \"vertical\"\n  setApi?: (api: CarouselApi) => void\n}\n\ntype CarouselContextProps = {\n  carouselRef: ReturnType<typeof useEmblaCarousel>[0]\n  api: ReturnType<typeof useEmblaCarousel>[1]\n  scrollPrev: () => void\n  scrollNext: () => void\n  canScrollPrev: boolean\n  canScrollNext: boolean\n} & CarouselProps\n\nconst CarouselContext = React.createContext<CarouselContextProps | null>(null)\n\nfunction useCarousel() {\n  const context = React.useContext(CarouselContext)\n\n  if (!context) {\n    throw new Error(\"useCarousel must be used within a <Carousel />\")\n  }\n\n  return context\n}\n\nconst Carousel = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & CarouselProps\n>(\n  (\n    {\n      orientation = \"horizontal\",\n      opts,\n      setApi,\n      plugins,\n      className,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const [carouselRef, api] = useEmblaCarousel(\n      {\n        ...opts,\n        axis: orientation === \"horizontal\" ? \"x\" : \"y\",\n      },\n      plugins\n    )\n    const [canScrollPrev, setCanScrollPrev] = React.useState(false)\n    const [canScrollNext, setCanScrollNext] = React.useState(false)\n\n    const onSelect = React.useCallback((api: CarouselApi) => {\n      if (!api) {\n        return\n      }\n\n      setCanScrollPrev(api.canScrollPrev())\n      setCanScrollNext(api.canScrollNext())\n    }, [])\n\n    const scrollPrev = React.useCallback(() => {\n      api?.scrollPrev()\n    }, [api])\n\n    const scrollNext = React.useCallback(() => {\n      api?.scrollNext()\n    }, [api])\n\n    const handleKeyDown = React.useCallback(\n      (event: React.KeyboardEvent<HTMLDivElement>) => {\n        if (event.key === \"ArrowLeft\") {\n          event.preventDefault()\n          scrollPrev()\n        } else if (event.key === \"ArrowRight\") {\n          event.preventDefault()\n          scrollNext()\n        }\n      },\n      [scrollPrev, scrollNext]\n    )\n\n    React.useEffect(() => {\n      if (!api || !setApi) {\n        return\n      }\n\n      setApi(api)\n    }, [api, setApi])\n\n    React.useEffect(() => {\n      if (!api) {\n        return\n      }\n\n      onSelect(api)\n      api.on(\"reInit\", onSelect)\n      api.on(\"select\", onSelect)\n\n      return () => {\n        api?.off(\"select\", onSelect)\n      }\n    }, [api, onSelect])\n\n    return (\n      <CarouselContext.Provider\n        value={{\n          carouselRef,\n          api: api,\n          opts,\n          orientation:\n            orientation || (opts?.axis === \"y\" ? \"vertical\" : \"horizontal\"),\n          scrollPrev,\n          scrollNext,\n          canScrollPrev,\n          canScrollNext,\n        }}\n      >\n        <div\n          ref={ref}\n          onKeyDownCapture={handleKeyDown}\n          className={cn(\"relative\", className)}\n          role=\"region\"\n          aria-roledescription=\"carousel\"\n          {...props}\n        >\n          {children}\n        </div>\n      </CarouselContext.Provider>\n    )\n  }\n)\nCarousel.displayName = \"Carousel\"\n\nconst CarouselContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { carouselRef, orientation } = useCarousel()\n\n  return (\n    <div ref={carouselRef} className=\"overflow-hidden\">\n      <div\n        ref={ref}\n        className={cn(\n          \"flex\",\n          orientation === \"horizontal\" ? \"-ml-4\" : \"-mt-4 flex-col\",\n          className\n        )}\n        {...props}\n      />\n    </div>\n  )\n})\nCarouselContent.displayName = \"CarouselContent\"\n\nconst CarouselItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { orientation } = useCarousel()\n\n  return (\n    <div\n      ref={ref}\n      role=\"group\"\n      aria-roledescription=\"slide\"\n      className={cn(\n        \"min-w-0 shrink-0 grow-0 basis-full\",\n        orientation === \"horizontal\" ? \"pl-4\" : \"pt-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nCarouselItem.displayName = \"CarouselItem\"\n\nconst CarouselPrevious = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollPrev, canScrollPrev } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute  h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-left-12 top-1/2 -translate-y-1/2\"\n          : \"-top-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollPrev}\n      onClick={scrollPrev}\n      {...props}\n    >\n      <ArrowLeft className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Previous slide</span>\n    </Button>\n  )\n})\nCarouselPrevious.displayName = \"CarouselPrevious\"\n\nconst CarouselNext = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollNext, canScrollNext } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-right-12 top-1/2 -translate-y-1/2\"\n          : \"-bottom-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollNext}\n      onClick={scrollNext}\n      {...props}\n    >\n      <ArrowRight className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Next slide</span>\n    </Button>\n  )\n})\nCarouselNext.displayName = \"CarouselNext\"\n\nexport {\n  type CarouselApi,\n  Carousel,\n  CarouselContent,\n  CarouselItem,\n  CarouselPrevious,\n  CarouselNext,\n}\n","path":null,"size_bytes":6210,"size_tokens":null},"client/src/components/ui/field.tsx":{"content":"\"use client\"\n\nimport { useMemo } from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Label } from \"@/components/ui/label\"\nimport { Separator } from \"@/components/ui/separator\"\n\nfunction FieldSet({ className, ...props }: React.ComponentProps<\"fieldset\">) {\n  return (\n    <fieldset\n      data-slot=\"field-set\"\n      className={cn(\n        \"flex flex-col gap-6\",\n        \"has-[>[data-slot=checkbox-group]]:gap-3 has-[>[data-slot=radio-group]]:gap-3\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction FieldLegend({\n  className,\n  variant = \"legend\",\n  ...props\n}: React.ComponentProps<\"legend\"> & { variant?: \"legend\" | \"label\" }) {\n  return (\n    <legend\n      data-slot=\"field-legend\"\n      data-variant={variant}\n      className={cn(\n        \"mb-3 font-medium\",\n        \"data-[variant=legend]:text-base\",\n        \"data-[variant=label]:text-sm\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction FieldGroup({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"field-group\"\n      className={cn(\n        \"group/field-group @container/field-group flex w-full flex-col gap-7 data-[slot=checkbox-group]:gap-3 [&>[data-slot=field-group]]:gap-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nconst fieldVariants = cva(\n  \"group/field data-[invalid=true]:text-destructive flex w-full gap-3\",\n  {\n    variants: {\n      orientation: {\n        vertical: [\"flex-col [&>*]:w-full [&>.sr-only]:w-auto\"],\n        horizontal: [\n          \"flex-row items-center\",\n          \"[&>[data-slot=field-label]]:flex-auto\",\n          \"has-[>[data-slot=field-content]]:[&>[role=checkbox],[role=radio]]:mt-px has-[>[data-slot=field-content]]:items-start\",\n        ],\n        responsive: [\n          \"@md/field-group:flex-row @md/field-group:items-center @md/field-group:[&>*]:w-auto flex-col [&>*]:w-full [&>.sr-only]:w-auto\",\n          \"@md/field-group:[&>[data-slot=field-label]]:flex-auto\",\n          \"@md/field-group:has-[>[data-slot=field-content]]:items-start @md/field-group:has-[>[data-slot=field-content]]:[&>[role=checkbox],[role=radio]]:mt-px\",\n        ],\n      },\n    },\n    defaultVariants: {\n      orientation: \"vertical\",\n    },\n  }\n)\n\nfunction Field({\n  className,\n  orientation = \"vertical\",\n  ...props\n}: React.ComponentProps<\"div\"> & VariantProps<typeof fieldVariants>) {\n  return (\n    <div\n      role=\"group\"\n      data-slot=\"field\"\n      data-orientation={orientation}\n      className={cn(fieldVariants({ orientation }), className)}\n      {...props}\n    />\n  )\n}\n\nfunction FieldContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"field-content\"\n      className={cn(\n        \"group/field-content flex flex-1 flex-col gap-1.5 leading-snug\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction FieldLabel({\n  className,\n  ...props\n}: React.ComponentProps<typeof Label>) {\n  return (\n    <Label\n      data-slot=\"field-label\"\n      className={cn(\n        \"group/field-label peer/field-label flex w-fit gap-2 leading-snug group-data-[disabled=true]/field:opacity-50\",\n        \"has-[>[data-slot=field]]:w-full has-[>[data-slot=field]]:flex-col has-[>[data-slot=field]]:rounded-md has-[>[data-slot=field]]:border [&>[data-slot=field]]:p-4\",\n        \"has-data-[state=checked]:bg-primary/5 has-data-[state=checked]:border-primary dark:has-data-[state=checked]:bg-primary/10\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction FieldTitle({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"field-label\"\n      className={cn(\n        \"flex w-fit items-center gap-2 text-sm font-medium leading-snug group-data-[disabled=true]/field:opacity-50\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction FieldDescription({ className, ...props }: React.ComponentProps<\"p\">) {\n  return (\n    <p\n      data-slot=\"field-description\"\n      className={cn(\n        \"text-muted-foreground text-sm font-normal leading-normal group-has-[[data-orientation=horizontal]]/field:text-balance\",\n        \"nth-last-2:-mt-1 last:mt-0 [[data-variant=legend]+&]:-mt-1.5\",\n        \"[&>a:hover]:text-primary [&>a]:underline [&>a]:underline-offset-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction FieldSeparator({\n  children,\n  className,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  children?: React.ReactNode\n}) {\n  return (\n    <div\n      data-slot=\"field-separator\"\n      data-content={!!children}\n      className={cn(\n        \"relative -my-2 h-5 text-sm group-data-[variant=outline]/field-group:-mb-2\",\n        className\n      )}\n      {...props}\n    >\n      <Separator className=\"absolute inset-0 top-1/2\" />\n      {children && (\n        <span\n          className=\"bg-background text-muted-foreground relative mx-auto block w-fit px-2\"\n          data-slot=\"field-separator-content\"\n        >\n          {children}\n        </span>\n      )}\n    </div>\n  )\n}\n\nfunction FieldError({\n  className,\n  children,\n  errors,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  errors?: Array<{ message?: string } | undefined>\n}) {\n  const content = useMemo(() => {\n    if (children) {\n      return children\n    }\n\n    if (!errors) {\n      return null\n    }\n\n    if (errors?.length === 1 && errors[0]?.message) {\n      return errors[0].message\n    }\n\n    return (\n      <ul className=\"ml-4 flex list-disc flex-col gap-1\">\n        {errors.map(\n          (error, index) =>\n            error?.message && <li key={index}>{error.message}</li>\n        )}\n      </ul>\n    )\n  }, [children, errors])\n\n  if (!content) {\n    return null\n  }\n\n  return (\n    <div\n      role=\"alert\"\n      data-slot=\"field-error\"\n      className={cn(\"text-destructive text-sm font-normal\", className)}\n      {...props}\n    >\n      {content}\n    </div>\n  )\n}\n\nexport {\n  Field,\n  FieldLabel,\n  FieldDescription,\n  FieldError,\n  FieldGroup,\n  FieldLegend,\n  FieldSeparator,\n  FieldSet,\n  FieldContent,\n  FieldTitle,\n}\n","path":null,"size_bytes":6044,"size_tokens":null},"client/src/components/ui/hover-card.tsx":{"content":"import * as React from \"react\"\nimport * as HoverCardPrimitive from \"@radix-ui/react-hover-card\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst HoverCard = HoverCardPrimitive.Root\n\nconst HoverCardTrigger = HoverCardPrimitive.Trigger\n\nconst HoverCardContent = React.forwardRef<\n  React.ElementRef<typeof HoverCardPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof HoverCardPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <HoverCardPrimitive.Content\n    ref={ref}\n    align={align}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 w-64 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-hover-card-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nHoverCardContent.displayName = HoverCardPrimitive.Content.displayName\n\nexport { HoverCard, HoverCardTrigger, HoverCardContent }\n","path":null,"size_bytes":1237,"size_tokens":null},"client/src/components/ui/scroll-area.tsx":{"content":"import * as React from \"react\"\nimport * as ScrollAreaPrimitive from \"@radix-ui/react-scroll-area\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ScrollArea = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <ScrollAreaPrimitive.Root\n    ref={ref}\n    className={cn(\"relative overflow-hidden\", className)}\n    {...props}\n  >\n    <ScrollAreaPrimitive.Viewport className=\"h-full w-full rounded-[inherit]\">\n      {children}\n    </ScrollAreaPrimitive.Viewport>\n    <ScrollBar />\n    <ScrollAreaPrimitive.Corner />\n  </ScrollAreaPrimitive.Root>\n))\nScrollArea.displayName = ScrollAreaPrimitive.Root.displayName\n\nconst ScrollBar = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>\n>(({ className, orientation = \"vertical\", ...props }, ref) => (\n  <ScrollAreaPrimitive.ScrollAreaScrollbar\n    ref={ref}\n    orientation={orientation}\n    className={cn(\n      \"flex touch-none select-none transition-colors\",\n      orientation === \"vertical\" &&\n        \"h-full w-2.5 border-l border-l-transparent p-[1px]\",\n      orientation === \"horizontal\" &&\n        \"h-2.5 flex-col border-t border-t-transparent p-[1px]\",\n      className\n    )}\n    {...props}\n  >\n    <ScrollAreaPrimitive.ScrollAreaThumb className=\"relative flex-1 rounded-full bg-border\" />\n  </ScrollAreaPrimitive.ScrollAreaScrollbar>\n))\nScrollBar.displayName = ScrollAreaPrimitive.ScrollAreaScrollbar.displayName\n\nexport { ScrollArea, ScrollBar }\n","path":null,"size_bytes":1642,"size_tokens":null},"client/src/components/ui/dropdown-menu.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as DropdownMenuPrimitive from \"@radix-ui/react-dropdown-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst DropdownMenu = DropdownMenuPrimitive.Root\n\nconst DropdownMenuTrigger = DropdownMenuPrimitive.Trigger\n\nconst DropdownMenuGroup = DropdownMenuPrimitive.Group\n\nconst DropdownMenuPortal = DropdownMenuPrimitive.Portal\n\nconst DropdownMenuSub = DropdownMenuPrimitive.Sub\n\nconst DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup\n\nconst DropdownMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto\" />\n  </DropdownMenuPrimitive.SubTrigger>\n))\nDropdownMenuSubTrigger.displayName =\n  DropdownMenuPrimitive.SubTrigger.displayName\n\nconst DropdownMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuSubContent.displayName =\n  DropdownMenuPrimitive.SubContent.displayName\n\nconst DropdownMenuContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <DropdownMenuPrimitive.Portal>\n    <DropdownMenuPrimitive.Content\n      ref={ref}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md\",\n        \"data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </DropdownMenuPrimitive.Portal>\n))\nDropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName\n\nconst DropdownMenuItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&>svg]:size-4 [&>svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName\n\nconst DropdownMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <DropdownMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.CheckboxItem>\n))\nDropdownMenuCheckboxItem.displayName =\n  DropdownMenuPrimitive.CheckboxItem.displayName\n\nconst DropdownMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.RadioItem>\n))\nDropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName\n\nconst DropdownMenuLabel = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName\n\nconst DropdownMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nDropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName\n\nconst DropdownMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\"ml-auto text-xs tracking-widest opacity-60\", className)}\n      {...props}\n    />\n  )\n}\nDropdownMenuShortcut.displayName = \"DropdownMenuShortcut\"\n\nexport {\n  DropdownMenu,\n  DropdownMenuTrigger,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuCheckboxItem,\n  DropdownMenuRadioItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuShortcut,\n  DropdownMenuGroup,\n  DropdownMenuPortal,\n  DropdownMenuSub,\n  DropdownMenuSubContent,\n  DropdownMenuSubTrigger,\n  DropdownMenuRadioGroup,\n}\n","path":null,"size_bytes":7606,"size_tokens":null},"client/src/components/ui/input-otp.tsx":{"content":"import * as React from \"react\"\nimport { OTPInput, OTPInputContext } from \"input-otp\"\nimport { Minus } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst InputOTP = React.forwardRef<\n  React.ElementRef<typeof OTPInput>,\n  React.ComponentPropsWithoutRef<typeof OTPInput>\n>(({ className, containerClassName, ...props }, ref) => (\n  <OTPInput\n    ref={ref}\n    containerClassName={cn(\n      \"flex items-center gap-2 has-[:disabled]:opacity-50\",\n      containerClassName\n    )}\n    className={cn(\"disabled:cursor-not-allowed\", className)}\n    {...props}\n  />\n))\nInputOTP.displayName = \"InputOTP\"\n\nconst InputOTPGroup = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"flex items-center\", className)} {...props} />\n))\nInputOTPGroup.displayName = \"InputOTPGroup\"\n\nconst InputOTPSlot = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\"> & { index: number }\n>(({ index, className, ...props }, ref) => {\n  const inputOTPContext = React.useContext(OTPInputContext)\n  const { char, hasFakeCaret, isActive } = inputOTPContext.slots[index]\n\n  return (\n    <div\n      ref={ref}\n      className={cn(\n        \"relative flex h-9 w-9 items-center justify-center border-y border-r border-input text-sm shadow-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md\",\n        isActive && \"z-10 ring-1 ring-ring\",\n        className\n      )}\n      {...props}\n    >\n      {char}\n      {hasFakeCaret && (\n        <div className=\"pointer-events-none absolute inset-0 flex items-center justify-center\">\n          <div className=\"h-4 w-px animate-caret-blink bg-foreground duration-1000\" />\n        </div>\n      )}\n    </div>\n  )\n})\nInputOTPSlot.displayName = \"InputOTPSlot\"\n\nconst InputOTPSeparator = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ ...props }, ref) => (\n  <div ref={ref} role=\"separator\" {...props}>\n    <Minus />\n  </div>\n))\nInputOTPSeparator.displayName = \"InputOTPSeparator\"\n\nexport { InputOTP, InputOTPGroup, InputOTPSlot, InputOTPSeparator }\n","path":null,"size_bytes":2143,"size_tokens":null},"client/src/components/ui/toggle-group.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ToggleGroupPrimitive from \"@radix-ui/react-toggle-group\"\nimport { type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { toggleVariants } from \"@/components/ui/toggle\"\n\nconst ToggleGroupContext = React.createContext<\n  VariantProps<typeof toggleVariants>\n>({\n  size: \"default\",\n  variant: \"default\",\n})\n\nconst ToggleGroup = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, children, ...props }, ref) => (\n  <ToggleGroupPrimitive.Root\n    ref={ref}\n    className={cn(\"flex items-center justify-center gap-1\", className)}\n    {...props}\n  >\n    <ToggleGroupContext.Provider value={{ variant, size }}>\n      {children}\n    </ToggleGroupContext.Provider>\n  </ToggleGroupPrimitive.Root>\n))\n\nToggleGroup.displayName = ToggleGroupPrimitive.Root.displayName\n\nconst ToggleGroupItem = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Item> &\n    VariantProps<typeof toggleVariants>\n>(({ className, children, variant, size, ...props }, ref) => {\n  const context = React.useContext(ToggleGroupContext)\n\n  return (\n    <ToggleGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        toggleVariants({\n          variant: context.variant || variant,\n          size: context.size || size,\n        }),\n        className\n      )}\n      {...props}\n    >\n      {children}\n    </ToggleGroupPrimitive.Item>\n  )\n})\n\nToggleGroupItem.displayName = ToggleGroupPrimitive.Item.displayName\n\nexport { ToggleGroup, ToggleGroupItem }\n","path":null,"size_bytes":1753,"size_tokens":null},"client/src/components/ui/skeleton.tsx":{"content":"import { cn } from \"@/lib/utils\"\n\nfunction Skeleton({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div\n      className={cn(\"animate-pulse rounded-md bg-primary/10\", className)}\n      {...props}\n    />\n  )\n}\n\nexport { Skeleton }\n","path":null,"size_bytes":266,"size_tokens":null},"drizzle.config.ts":{"content":"import { defineConfig } from \"drizzle-kit\";\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\"DATABASE_URL, ensure the database is provisioned\");\n}\n\nexport default defineConfig({\n  out: \"./migrations\",\n  schema: \"./shared/schema.ts\",\n  dialect: \"postgresql\",\n  dbCredentials: {\n    url: process.env.DATABASE_URL,\n  },\n});\n","path":null,"size_bytes":325,"size_tokens":null},"client/src/features/search/components/search-filters.tsx":{"content":"import { useState } from \"react\";\nimport { motion, AnimatePresence } from \"framer-motion\";\nimport { Calendar as CalendarIcon, Globe, Check, Layers, PanelLeftClose } from \"lucide-react\";\nimport { format } from \"date-fns\";\nimport { DateRange } from \"react-day-picker\";\nimport { cn } from \"@/lib/utils\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { Accordion, AccordionContent, AccordionItem, AccordionTrigger } from \"@/components/ui/accordion\";\nimport { Calendar } from \"@/components/ui/calendar\";\nimport { Popover, PopoverContent, PopoverTrigger } from \"@/components/ui/popover\";\nimport { Command, CommandEmpty, CommandGroup, CommandInput, CommandItem, CommandList } from \"@/components/ui/command\";\nimport { Checkbox } from \"@/components/ui/checkbox\";\nimport { Label } from \"@/components/ui/label\";\nimport { Folder, FolderOpen, File } from \"lucide-react\";\nimport { TreeNode } from \"../types\";\n\n// --- FolderTree Component ---\nconst FolderTree = ({ nodes, level = 0, onSelect, selectedIds = [] }: { nodes: TreeNode[], level?: number, onSelect?: (id: string, label: string) => void, selectedIds?: string[] }) => {\n  const [expanded, setExpanded] = useState<Record<string, boolean>>({});\n\n  const toggleExpand = (id: string) => {\n    setExpanded(prev => ({ ...prev, [id]: !prev[id] }));\n  };\n\n  const handleSelect = (e: React.MouseEvent, node: TreeNode) => {\n    e.stopPropagation();\n    if (onSelect) {\n      onSelect(node.id, node.label);\n    }\n  };\n\n  return (\n    <div className=\"space-y-0.5\">\n      {nodes.map(node => {\n        const hasChildren = node.children && node.children.length > 0;\n        const isExpanded = expanded[node.id];\n        const isSelected = selectedIds.includes(node.id);\n        \n        return (\n          <div key={node.id}>\n            <div \n              className={cn(\n                \"flex items-center py-1.5 px-2 rounded-md group transition-colors cursor-pointer select-none\",\n                isSelected ? \"bg-primary/10 text-primary\" : \"hover:bg-muted/50\"\n              )}\n              style={{ paddingLeft: `${level * 16 + 8}px` }}\n              onClick={() => hasChildren && toggleExpand(node.id)}\n            >\n              <div className={cn(\"mr-2 transition-colors\", isSelected ? \"text-primary\" : \"text-muted-foreground/70 group-hover:text-primary\")}>\n                {hasChildren ? (\n                  isExpanded ? <FolderOpen className=\"w-3.5 h-3.5\" /> : <Folder className=\"w-3.5 h-3.5\" />\n                ) : (\n                  <File className=\"w-3.5 h-3.5 opacity-50\" />\n                )}\n              </div>\n              \n              <span className={cn(\"text-xs font-medium flex-1 truncate\", isSelected ? \"text-primary\" : \"text-foreground/90\")}>\n                {node.label}\n              </span>\n              \n              <Checkbox \n                id={`tree-check-${node.id}`} \n                checked={isSelected}\n                className={cn(\n                  \"w-3.5 h-3.5 ml-2 border-muted-foreground/40 group-hover:border-primary/60\",\n                  isSelected ? \"data-[state=checked]:bg-primary border-primary\" : \"\"\n                )} \n                onClick={(e) => handleSelect(e, node)} \n              />\n            </div>\n            \n            {hasChildren && isExpanded && (\n              <motion.div\n                initial={{ opacity: 0, height: 0 }}\n                animate={{ opacity: 1, height: 'auto' }}\n                exit={{ opacity: 0, height: 0 }}\n                transition={{ duration: 0.2 }}\n              >\n                <FolderTree nodes={node.children!} level={level + 1} onSelect={onSelect} selectedIds={selectedIds} />\n              </motion.div>\n            )}\n          </div>\n        );\n      })}\n    </div>\n  );\n};\n\n// --- SearchFilters Component ---\ninterface SearchFiltersProps {\n  showFacets: boolean;\n  setShowFacets: (show: boolean) => void;\n  date: DateRange | undefined;\n  setDate: (date: DateRange | undefined) => void;\n  hierarchyTree: TreeNode[];\n  handleLocationFilterSelect: (id: string, label: string) => void;\n  selectedLocationIds: string[];\n  keywords: string[];\n  keywordSearch: string;\n  setKeywordSearch: (val: string) => void;\n  toggleKeyword: (kw: string) => void;\n  selectedKeywords: string[];\n  selectedProperties: string[];\n  toggleProperty: (prop: string) => void;\n  selectedPlatforms: string[];\n  togglePlatform: (platform: string) => void;\n}\n\nexport function SearchFilters({\n  showFacets,\n  setShowFacets,\n  date,\n  setDate,\n  hierarchyTree,\n  handleLocationFilterSelect,\n  selectedLocationIds,\n  keywords,\n  keywordSearch,\n  setKeywordSearch,\n  toggleKeyword,\n  selectedKeywords,\n  selectedProperties,\n  toggleProperty,\n  selectedPlatforms,\n  togglePlatform\n}: SearchFiltersProps) {\n  return (\n    <AnimatePresence mode=\"wait\">\n      {showFacets && (\n        <motion.div \n          initial={{ width: 0, opacity: 0 }}\n          animate={{ width: 280, opacity: 1 }}\n          exit={{ width: 0, opacity: 0 }}\n          transition={{ duration: 0.2, ease: \"easeOut\" }}\n          className=\"border-r border-border/50 bg-background/95 backdrop-blur-xl hidden md:flex flex-col overflow-hidden shrink-0 z-10 shadow-lg\"\n        >\n          <ScrollArea className=\"flex-1 p-4\">\n            <div className=\"space-y-6 pr-4\">\n              {/* Date Range Filter */}\n              <div className=\"space-y-3\">\n                <h3 className=\"text-sm font-display font-bold text-foreground flex items-center gap-2 tracking-wide\">\n                  <CalendarIcon className=\"w-4 h-4 text-primary\" /> Date Range\n                </h3>\n                <Popover>\n                  <PopoverTrigger asChild>\n                    <Button\n                      id=\"date\"\n                      variant={\"outline\"}\n                      className={cn(\n                        \"w-full justify-start text-left font-normal text-xs\",\n                        !date && \"text-muted-foreground\"\n                      )}\n                    >\n                      <CalendarIcon className=\"mr-2 h-4 w-4\" />\n                      {date?.from ? (\n                        date.to ? (\n                          <>\n                            {format(date.from, \"LLL dd, y\")} -{\" \"}\n                            {format(date.to, \"LLL dd, y\")}\n                          </>\n                        ) : (\n                          format(date.from, \"LLL dd, y\")\n                        )\n                      ) : (\n                        <span>Pick a date range</span>\n                      )}\n                    </Button>\n                  </PopoverTrigger>\n                  <PopoverContent className=\"w-auto p-0\" align=\"start\">\n                    <Calendar\n                      initialFocus\n                      mode=\"range\"\n                      defaultMonth={date?.from}\n                      selected={date}\n                      onSelect={setDate}\n                      numberOfMonths={2}\n                    />\n                  </PopoverContent>\n                </Popover>\n              </div>\n\n              <Separator className=\"bg-border/50\" />\n\n              <div className=\"space-y-3\">\n                <h3 className=\"text-sm font-display font-bold text-foreground flex items-center gap-2 tracking-wide\">\n                  <Globe className=\"w-4 h-4 text-primary\" /> Location Hierarchy\n                </h3>\n                <div className=\"border border-border/60 rounded-lg bg-muted/10 p-2 max-h-[300px] overflow-y-auto\">\n                  <FolderTree nodes={hierarchyTree} onSelect={handleLocationFilterSelect} selectedIds={selectedLocationIds} />\n                </div>\n              </div>\n\n              <Separator className=\"bg-border/50\" />\n\n              {/* Keywords Filter - Command style */}\n              <div className=\"space-y-1\">\n                <Accordion type=\"single\" collapsible defaultValue=\"keywords\" className=\"w-full\">\n                  <AccordionItem value=\"keywords\" className=\"border-none\">\n                    <AccordionTrigger className=\"py-3 text-xs font-bold text-muted-foreground hover:text-foreground hover:no-underline uppercase tracking-wider\">\n                      Keywords\n                    </AccordionTrigger>\n                    <AccordionContent>\n                       <Command className=\"border rounded-md\">\n                          <CommandInput placeholder=\"Filter keywords...\" value={keywordSearch} onValueChange={setKeywordSearch} className=\"h-8 text-xs\" />\n                          <CommandList className=\"max-h-[200px]\">\n                            <CommandEmpty>No keywords found.</CommandEmpty>\n                            <CommandGroup>\n                              {keywords.map(k => (\n                                <CommandItem\n                                  key={k}\n                                  value={k}\n                                  onSelect={() => toggleKeyword(k)}\n                                  className=\"text-xs cursor-pointer\"\n                                >\n                                  <div className={cn(\n                                    \"mr-2 flex h-3 w-3 items-center justify-center rounded-sm border border-primary\",\n                                    selectedKeywords.includes(k) ? \"bg-primary text-primary-foreground\" : \"opacity-50 [&_svg]:invisible\"\n                                  )}>\n                                    <Check className={cn(\"h-3 w-3\")} />\n                                  </div>\n                                  {k}\n                                </CommandItem>\n                              ))}\n                            </CommandGroup>\n                          </CommandList>\n                       </Command>\n                    </AccordionContent>\n                  </AccordionItem>\n                </Accordion>\n              </div>\n\n              <Separator className=\"bg-border/50\" />\n\n              {/* Properties Filter - Clickable */}\n              <div className=\"space-y-1\">\n                <Accordion type=\"single\" collapsible defaultValue=\"properties\" className=\"w-full\">\n                  <AccordionItem value=\"properties\" className=\"border-none\">\n                    <AccordionTrigger className=\"py-3 text-xs font-bold text-muted-foreground hover:text-foreground hover:no-underline uppercase tracking-wider\">\n                      Properties\n                    </AccordionTrigger>\n                    <AccordionContent>\n                      <div className=\"space-y-1 pb-2\">\n                         {[\n                           { name: \"has_thumbnail\", label: \"Has Thumbnail\" },\n                           { name: \"has_spatial\", label: \"Has Spatial Info\" },\n                           { name: \"has_temporal\", label: \"Has Temporal Info\" },\n                           { name: \"is_downloadable\", label: \"Downloadable\" }\n                         ].map(prop => {\n                           const isSelected = selectedProperties.includes(prop.name);\n                           return (\n                            <button \n                              key={prop.name} \n                              onClick={() => toggleProperty(prop.name)}\n                              className={cn(\n                                \"w-full flex items-center justify-between py-1.5 px-2 text-sm rounded-md group transition-colors text-left\",\n                                isSelected ? \"bg-primary/10 text-primary\" : \"hover:bg-muted/50 text-foreground/80\"\n                              )}\n                            >\n                              <span className=\"font-medium\">{prop.label}</span>\n                              {isSelected && <Check className=\"w-3 h-3\" />}\n                            </button>\n                           )\n                         })}\n                      </div>\n                    </AccordionContent>\n                  </AccordionItem>\n                </Accordion>\n              </div>\n\n              <Separator className=\"bg-border/50\" />\n\n              <div className=\"space-y-3\">\n                <h3 className=\"text-sm font-display font-bold text-foreground flex items-center gap-2 tracking-wide mt-3\">\n                  <Layers className=\"w-4 h-4 text-primary\" /> Platform\n                </h3>\n                <div className=\"space-y-2\">\n                  {['Sentinel-1', 'Sentinel-2', 'Landsat 8', 'Landsat 9', 'Terra', 'Aqua'].map(p => (\n                    <div key={p} className=\"flex items-center space-x-2\">\n                      <Checkbox \n                        id={`p-${p}`} \n                        checked={selectedPlatforms.includes(p)}\n                        onCheckedChange={() => togglePlatform(p)}\n                      />\n                      <Label \n                        htmlFor={`p-${p}`} \n                        className={cn(\n                          \"text-xs font-normal cursor-pointer\",\n                          selectedPlatforms.includes(p) ? \"text-foreground\" : \"text-muted-foreground\"\n                        )}\n                      >\n                        {p}\n                      </Label>\n                    </div>\n                  ))}\n                </div>\n              </div>\n\n              <Separator className=\"bg-border\" />\n            </div>\n          </ScrollArea>\n        </motion.div>\n      )}\n    </AnimatePresence>\n  );\n}\n","path":null,"size_bytes":13425,"size_tokens":null},"client/src/lib/queryClient.ts":{"content":"import { QueryClient, QueryFunction } from \"@tanstack/react-query\";\n\nasync function throwIfResNotOk(res: Response) {\n  if (!res.ok) {\n    const text = (await res.text()) || res.statusText;\n    throw new Error(`${res.status}: ${text}`);\n  }\n}\n\nexport async function apiRequest(\n  method: string,\n  url: string,\n  data?: unknown | undefined,\n): Promise<Response> {\n  const res = await fetch(url, {\n    method,\n    headers: data ? { \"Content-Type\": \"application/json\" } : {},\n    body: data ? JSON.stringify(data) : undefined,\n    credentials: \"include\",\n  });\n\n  await throwIfResNotOk(res);\n  return res;\n}\n\ntype UnauthorizedBehavior = \"returnNull\" | \"throw\";\nexport const getQueryFn: <T>(options: {\n  on401: UnauthorizedBehavior;\n}) => QueryFunction<T> =\n  ({ on401: unauthorizedBehavior }) =>\n  async ({ queryKey }) => {\n    const res = await fetch(queryKey.join(\"/\") as string, {\n      credentials: \"include\",\n    });\n\n    if (unauthorizedBehavior === \"returnNull\" && res.status === 401) {\n      return null;\n    }\n\n    await throwIfResNotOk(res);\n    return await res.json();\n  };\n\nexport const queryClient = new QueryClient({\n  defaultOptions: {\n    queries: {\n      queryFn: getQueryFn({ on401: \"throw\" }),\n      refetchInterval: false,\n      refetchOnWindowFocus: false,\n      staleTime: Infinity,\n      retry: false,\n    },\n    mutations: {\n      retry: false,\n    },\n  },\n});\n","path":null,"size_bytes":1383,"size_tokens":null},"client/src/components/ui/checkbox.tsx":{"content":"import * as React from \"react\"\nimport * as CheckboxPrimitive from \"@radix-ui/react-checkbox\"\nimport { Check } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Checkbox = React.forwardRef<\n  React.ElementRef<typeof CheckboxPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <CheckboxPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"grid place-content-center peer h-4 w-4 shrink-0 rounded-sm border border-primary shadow focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground\",\n      className\n    )}\n    {...props}\n  >\n    <CheckboxPrimitive.Indicator\n      className={cn(\"grid place-content-center text-current\")}\n    >\n      <Check className=\"h-4 w-4\" />\n    </CheckboxPrimitive.Indicator>\n  </CheckboxPrimitive.Root>\n))\nCheckbox.displayName = CheckboxPrimitive.Root.displayName\n\nexport { Checkbox }\n","path":null,"size_bytes":1031,"size_tokens":null},"script/build.ts":{"content":"import { build as esbuild } from \"esbuild\";\nimport { build as viteBuild } from \"vite\";\nimport { rm, readFile } from \"fs/promises\";\n\n// server deps to bundle to reduce openat(2) syscalls\n// which helps cold start times\nconst allowlist = [\n  \"@google/generative-ai\",\n  \"axios\",\n  \"connect-pg-simple\",\n  \"cors\",\n  \"date-fns\",\n  \"drizzle-orm\",\n  \"drizzle-zod\",\n  \"express\",\n  \"express-rate-limit\",\n  \"express-session\",\n  \"jsonwebtoken\",\n  \"memorystore\",\n  \"multer\",\n  \"nanoid\",\n  \"nodemailer\",\n  \"openai\",\n  \"passport\",\n  \"passport-local\",\n  \"pg\",\n  \"stripe\",\n  \"uuid\",\n  \"ws\",\n  \"xlsx\",\n  \"zod\",\n  \"zod-validation-error\",\n];\n\nasync function buildAll() {\n  await rm(\"dist\", { recursive: true, force: true });\n\n  console.log(\"building client...\");\n  await viteBuild();\n\n  console.log(\"building server...\");\n  const pkg = JSON.parse(await readFile(\"package.json\", \"utf-8\"));\n  const allDeps = [\n    ...Object.keys(pkg.dependencies || {}),\n    ...Object.keys(pkg.devDependencies || {}),\n  ];\n  const externals = allDeps.filter((dep) => !allowlist.includes(dep));\n\n  await esbuild({\n    entryPoints: [\"server/index.ts\"],\n    platform: \"node\",\n    bundle: true,\n    format: \"cjs\",\n    outfile: \"dist/index.cjs\",\n    define: {\n      \"process.env.NODE_ENV\": '\"production\"',\n    },\n    minify: true,\n    external: externals,\n    logLevel: \"info\",\n  });\n}\n\nbuildAll().catch((err) => {\n  console.error(err);\n  process.exit(1);\n});\n","path":null,"size_bytes":1417,"size_tokens":null},"client/src/features/search/components/search-map.tsx":{"content":"import { useState, useEffect, useMemo } from \"react\";\nimport { MapContainer, TileLayer, Rectangle, ImageOverlay, useMap } from 'react-leaflet';\nimport { LatLngBounds, LatLng } from 'leaflet';\nimport { Map as MapIcon, Globe, Square, MapPin, Pentagon, MousePointer } from \"lucide-react\";\nimport { MapDrawControl, SpatialFilterLayer } from \"@/components/map-draw-control\";\nimport { SearchResult } from \"../types\";\nimport { Tooltip, TooltipContent, TooltipProvider, TooltipTrigger } from \"@/components/ui/tooltip\";\nimport { cn } from \"@/lib/utils\";\n\nfunction hasValidBounds(result: SearchResult): boolean {\n  try {\n    const bounds = result.bounds as [[number, number], [number, number]];\n    if (!Array.isArray(bounds) || bounds.length !== 2) return false;\n    const [sw, ne] = bounds;\n    if (!Array.isArray(sw) || !Array.isArray(ne)) return false;\n    if (sw.length !== 2 || ne.length !== 2) return false;\n    const allFinite = [sw[0], sw[1], ne[0], ne[1]].every(v => typeof v === 'number' && isFinite(v));\n    const isDefaultBounds = sw[0] === 0 && sw[1] === 0 && ne[0] === 0 && ne[1] === 0;\n    return allFinite && !isDefaultBounds;\n  } catch {\n    return false;\n  }\n}\n\nconst MapEffect = ({ bounds }: { bounds: LatLngBounds | null }) => {\n  const map = useMap();\n  useEffect(() => {\n    if (bounds && bounds.isValid()) {\n      map.flyToBounds(bounds, { padding: [50, 50], duration: 1 });\n    }\n  }, [bounds, map]);\n  return null;\n};\n\nconst PreviewEffect = ({ result }: { result: SearchResult | undefined }) => {\n  const map = useMap();\n  useEffect(() => {\n    if (result && hasValidBounds(result)) {\n      try {\n        const bounds = new LatLngBounds(\n          (result.bounds as any)[0],\n          (result.bounds as any)[1]\n        );\n        if (bounds.isValid()) {\n          map.flyToBounds(bounds, { padding: [20, 20], duration: 1.5 });\n        }\n      } catch (e) {\n        console.error(\"Error flying to preview bounds\", e);\n      }\n    }\n  }, [result, map]);\n  return null;\n};\n\ninterface SearchMapProps {\n  showMap: boolean;\n  setShowMap: (show: boolean) => void;\n  mapStyle: 'streets' | 'satellite';\n  setMapStyle: (style: 'streets' | 'satellite') => void;\n  isDark: boolean;\n  filteredResults: SearchResult[];\n  hoveredResultId: number | null;\n  previewedResultId: number | null;\n  drawMode: 'none' | 'box' | 'point' | 'polygon';\n  setDrawMode: (mode: 'none' | 'box' | 'point' | 'polygon') => void;\n  setSpatialFilter: (filter: any) => void;\n  setPlace: (place: string) => void;\n  spatialFilter?: { type: 'box' | 'point' | 'polygon'; data: any } | null;\n}\n\nexport function SearchMap({\n  showMap,\n  setShowMap,\n  mapStyle,\n  setMapStyle,\n  isDark,\n  filteredResults,\n  hoveredResultId,\n  previewedResultId,\n  drawMode,\n  setDrawMode,\n  setSpatialFilter,\n  setPlace,\n  spatialFilter\n}: SearchMapProps) {\n  const [mapBounds, setMapBounds] = useState<LatLngBounds | null>(null);\n\n  const validResults = useMemo(() => \n    filteredResults.filter(hasValidBounds), \n    [filteredResults]\n  );\n\n  useEffect(() => {\n    if (validResults.length > 0) {\n      try {\n        const firstResult = validResults[0];\n        const bounds = new LatLngBounds(\n            (firstResult.bounds as any)[0],\n            (firstResult.bounds as any)[1]\n        );\n        validResults.slice(1, 5).forEach(res => {\n            bounds.extend((res.bounds as any)[0]);\n            bounds.extend((res.bounds as any)[1]);\n        });\n        if (bounds.isValid()) {\n          setMapBounds(bounds);\n        }\n      } catch (e) {\n        console.error(\"Error calculating bounds\", e);\n      }\n    }\n  }, [validResults.length]);\n\n  if (!showMap) return null;\n\n  const hoveredResult = filteredResults.find(r => r.id === hoveredResultId);\n  const previewedResult = filteredResults.find(r => r.id === previewedResultId);\n\n  const handleDrawBox = (bounds: LatLngBounds) => {\n    setSpatialFilter({ type: 'box', data: bounds });\n    setDrawMode('none');\n    setPlace(`[${bounds.getWest().toFixed(2)}, ${bounds.getSouth().toFixed(2)}, ${bounds.getEast().toFixed(2)}, ${bounds.getNorth().toFixed(2)}]`);\n  };\n\n  const handleDrawPoint = (point: LatLng) => {\n    setSpatialFilter({ type: 'point', data: point });\n    setDrawMode('none');\n    setPlace(`${point.lat.toFixed(4)}, ${point.lng.toFixed(4)}`);\n  };\n\n  const handleDrawPolygon = (points: LatLng[]) => {\n    setSpatialFilter({ type: 'polygon', data: points });\n    setDrawMode('none');\n    setPlace(\"Custom Polygon\");\n  };\n\n  const tileUrl = mapStyle === 'streets'\n    ? (isDark \n        ? \"https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png\"\n        : \"https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png\")\n    : \"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}\";\n\n  const tileAttribution = mapStyle === 'streets' \n    ? '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> &copy; <a href=\"https://carto.com/attributions\">CARTO</a>'\n    : '&copy; <a href=\"https://www.esri.com/\">Esri</a>';\n\n  return (\n    <div className=\"w-[400px] hidden xl:block border-l border-border shrink-0 transition-all duration-300 relative\">\n      <div className=\"absolute inset-0\">\n        <MapContainer \n          center={[20, 0]} \n          zoom={2} \n          minZoom={2}\n          maxBounds={[[-90, -180], [90, 180]]}\n          maxBoundsViscosity={1.0}\n          style={{ height: '100%', width: '100%' }}\n          className=\"z-0\"\n          zoomControl={true}\n          scrollWheelZoom={true}\n          doubleClickZoom={true}\n          dragging={true}\n        >\n          <TileLayer attribution={tileAttribution} url={tileUrl} noWrap={true} />\n          <MapEffect bounds={mapBounds} />\n          <PreviewEffect result={previewedResult} />\n          <MapDrawControl \n            mode={drawMode} \n            onDrawBox={handleDrawBox}\n            onDrawPoint={handleDrawPoint}\n            onDrawPolygon={handleDrawPolygon}\n          />\n          {validResults.map(result => (\n            <Rectangle \n              key={`footprint-${result.id}`}\n              bounds={result.bounds} \n              pathOptions={{ \n                color: hoveredResultId === result.id ? '#00ffff' : '#3b82f6', \n                weight: hoveredResultId === result.id ? 2 : 1, \n                fillOpacity: hoveredResultId === result.id ? 0.2 : 0.05,\n                fillColor: hoveredResultId === result.id ? '#00ffff' : '#3b82f6'\n              }} \n            />\n          ))}\n          {hoveredResult && hasValidBounds(hoveredResult) && (\n            <ImageOverlay url={hoveredResult.thumbnail} bounds={hoveredResult.bounds} opacity={0.9} zIndex={100} />\n          )}\n          {previewedResult && previewedResult.id !== hoveredResultId && hasValidBounds(previewedResult) && (\n            <ImageOverlay url={previewedResult.thumbnail} bounds={previewedResult.bounds} opacity={0.9} zIndex={90} />\n          )}\n          {spatialFilter && <SpatialFilterLayer type={spatialFilter.type} data={spatialFilter.data} />}\n        </MapContainer>\n\n        {/* Map Controls Overlay */}\n        <div className=\"absolute top-3 right-3 z-[600] flex flex-col gap-2 pointer-events-none\">\n          <div className=\"bg-background/90 backdrop-blur rounded-lg border border-border p-1 flex flex-col gap-1 shadow-lg pointer-events-auto\">\n            <TooltipProvider>\n              <Tooltip>\n                <TooltipTrigger asChild>\n                  <button \n                    className={cn(\"p-1.5 hover:bg-muted rounded transition-colors\", mapStyle === 'streets' ? 'bg-primary text-primary-foreground' : 'text-muted-foreground')}\n                    onClick={() => setMapStyle('streets')}\n                  >\n                    <MapIcon className=\"w-3.5 h-3.5\" />\n                  </button>\n                </TooltipTrigger>\n                <TooltipContent side=\"left\">Street Map</TooltipContent>\n              </Tooltip>\n            </TooltipProvider>\n            <TooltipProvider>\n              <Tooltip>\n                <TooltipTrigger asChild>\n                  <button \n                    className={cn(\"p-1.5 hover:bg-muted rounded transition-colors\", mapStyle === 'satellite' ? 'bg-primary text-primary-foreground' : 'text-muted-foreground')}\n                    onClick={() => setMapStyle('satellite')}\n                  >\n                    <Globe className=\"w-3.5 h-3.5\" />\n                  </button>\n                </TooltipTrigger>\n                <TooltipContent side=\"left\">Satellite View</TooltipContent>\n              </Tooltip>\n            </TooltipProvider>\n          </div>\n          <div className=\"bg-background/90 backdrop-blur rounded-lg border border-border p-1 flex flex-col gap-1 shadow-lg pointer-events-auto\">\n            <TooltipProvider>\n              <Tooltip>\n                <TooltipTrigger asChild>\n                  <button \n                    className={cn(\"p-1.5 hover:bg-muted rounded transition-colors\", drawMode === 'none' ? 'bg-primary text-primary-foreground' : 'text-muted-foreground')}\n                    onClick={() => setDrawMode('none')}\n                  >\n                    <MousePointer className=\"w-3.5 h-3.5\" />\n                  </button>\n                </TooltipTrigger>\n                <TooltipContent side=\"left\">Select</TooltipContent>\n              </Tooltip>\n            </TooltipProvider>\n            <TooltipProvider>\n              <Tooltip>\n                <TooltipTrigger asChild>\n                  <button \n                    className={cn(\"p-1.5 hover:bg-muted rounded transition-colors\", drawMode === 'box' ? 'bg-primary text-primary-foreground' : 'text-muted-foreground')}\n                    onClick={() => setDrawMode('box')}\n                  >\n                    <Square className=\"w-3.5 h-3.5\" />\n                  </button>\n                </TooltipTrigger>\n                <TooltipContent side=\"left\">Rectangle</TooltipContent>\n              </Tooltip>\n            </TooltipProvider>\n            <TooltipProvider>\n              <Tooltip>\n                <TooltipTrigger asChild>\n                  <button \n                    className={cn(\"p-1.5 hover:bg-muted rounded transition-colors\", drawMode === 'point' ? 'bg-primary text-primary-foreground' : 'text-muted-foreground')}\n                    onClick={() => setDrawMode('point')}\n                  >\n                    <MapPin className=\"w-3.5 h-3.5\" />\n                  </button>\n                </TooltipTrigger>\n                <TooltipContent side=\"left\">Pin</TooltipContent>\n              </Tooltip>\n            </TooltipProvider>\n            <TooltipProvider>\n              <Tooltip>\n                <TooltipTrigger asChild>\n                  <button \n                    className={cn(\"p-1.5 hover:bg-muted rounded transition-colors\", drawMode === 'polygon' ? 'bg-primary text-primary-foreground' : 'text-muted-foreground')}\n                    onClick={() => setDrawMode('polygon')}\n                  >\n                    <Pentagon className=\"w-3.5 h-3.5\" />\n                  </button>\n                </TooltipTrigger>\n                <TooltipContent side=\"left\">Polygon</TooltipContent>\n              </Tooltip>\n            </TooltipProvider>\n          </div>\n        </div>\n\n        {/* Stats Overlay */}\n        <div className=\"absolute bottom-3 left-3 z-[600] bg-background/90 backdrop-blur rounded-lg border border-border px-3 py-2 shadow-lg pointer-events-auto\">\n          <div className=\"flex items-center gap-3 text-xs\">\n            <div className=\"flex items-center gap-1.5\">\n              <div className=\"w-2 h-2 rounded-full bg-primary\" />\n              <span className=\"text-muted-foreground\">{validResults.length} visible</span>\n            </div>\n            <div className=\"w-px h-4 bg-border\" />\n            <span className=\"font-medium\">{filteredResults.length} total</span>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":11871,"size_tokens":null},"client/src/components/ui/form.tsx":{"content":"import * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport {\n  Controller,\n  FormProvider,\n  useFormContext,\n  type ControllerProps,\n  type FieldPath,\n  type FieldValues,\n} from \"react-hook-form\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Label } from \"@/components/ui/label\"\n\nconst Form = FormProvider\n\ntype FormFieldContextValue<\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n> = {\n  name: TName\n}\n\nconst FormFieldContext = React.createContext<FormFieldContextValue | null>(null)\n\nconst FormField = <\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n>({\n  ...props\n}: ControllerProps<TFieldValues, TName>) => {\n  return (\n    <FormFieldContext.Provider value={{ name: props.name }}>\n      <Controller {...props} />\n    </FormFieldContext.Provider>\n  )\n}\n\nconst useFormField = () => {\n  const fieldContext = React.useContext(FormFieldContext)\n  const itemContext = React.useContext(FormItemContext)\n  const { getFieldState, formState } = useFormContext()\n\n  if (!fieldContext) {\n    throw new Error(\"useFormField should be used within <FormField>\")\n  }\n\n  if (!itemContext) {\n    throw new Error(\"useFormField should be used within <FormItem>\")\n  }\n\n  const fieldState = getFieldState(fieldContext.name, formState)\n\n  const { id } = itemContext\n\n  return {\n    id,\n    name: fieldContext.name,\n    formItemId: `${id}-form-item`,\n    formDescriptionId: `${id}-form-item-description`,\n    formMessageId: `${id}-form-item-message`,\n    ...fieldState,\n  }\n}\n\ntype FormItemContextValue = {\n  id: string\n}\n\nconst FormItemContext = React.createContext<FormItemContextValue | null>(null)\n\nconst FormItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const id = React.useId()\n\n  return (\n    <FormItemContext.Provider value={{ id }}>\n      <div ref={ref} className={cn(\"space-y-2\", className)} {...props} />\n    </FormItemContext.Provider>\n  )\n})\nFormItem.displayName = \"FormItem\"\n\nconst FormLabel = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  const { error, formItemId } = useFormField()\n\n  return (\n    <Label\n      ref={ref}\n      className={cn(error && \"text-destructive\", className)}\n      htmlFor={formItemId}\n      {...props}\n    />\n  )\n})\nFormLabel.displayName = \"FormLabel\"\n\nconst FormControl = React.forwardRef<\n  React.ElementRef<typeof Slot>,\n  React.ComponentPropsWithoutRef<typeof Slot>\n>(({ ...props }, ref) => {\n  const { error, formItemId, formDescriptionId, formMessageId } = useFormField()\n\n  return (\n    <Slot\n      ref={ref}\n      id={formItemId}\n      aria-describedby={\n        !error\n          ? `${formDescriptionId}`\n          : `${formDescriptionId} ${formMessageId}`\n      }\n      aria-invalid={!!error}\n      {...props}\n    />\n  )\n})\nFormControl.displayName = \"FormControl\"\n\nconst FormDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => {\n  const { formDescriptionId } = useFormField()\n\n  return (\n    <p\n      ref={ref}\n      id={formDescriptionId}\n      className={cn(\"text-[0.8rem] text-muted-foreground\", className)}\n      {...props}\n    />\n  )\n})\nFormDescription.displayName = \"FormDescription\"\n\nconst FormMessage = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, children, ...props }, ref) => {\n  const { error, formMessageId } = useFormField()\n  const body = error ? String(error?.message ?? \"\") : children\n\n  if (!body) {\n    return null\n  }\n\n  return (\n    <p\n      ref={ref}\n      id={formMessageId}\n      className={cn(\"text-[0.8rem] font-medium text-destructive\", className)}\n      {...props}\n    >\n      {body}\n    </p>\n  )\n})\nFormMessage.displayName = \"FormMessage\"\n\nexport {\n  useFormField,\n  Form,\n  FormItem,\n  FormLabel,\n  FormControl,\n  FormDescription,\n  FormMessage,\n  FormField,\n}\n","path":null,"size_bytes":4175,"size_tokens":null},"client/src/pages/search-results-page.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { useLocation, useSearch } from \"wouter\";\nimport { \n  Search, MapPin, Filter, ArrowLeft, History, Clock, Star, Share2, Mail, Copy, Info, ArrowUpDown, PanelRightOpen, PanelRightClose, PanelLeftOpen, PanelLeftClose, Map, User, LogIn, Check, Tag, X, Bookmark, Settings, LogOut\n} from \"lucide-react\";\nimport { ThemeToggle } from \"@/components/theme-toggle\";\nimport { useAuth } from \"@/hooks/useAuth\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport { format } from \"date-fns\";\nimport { DateRange } from \"react-day-picker\";\nimport { useTheme } from \"@/components/theme-provider\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Dialog, DialogContent, DialogDescription, DialogFooter, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { Input } from \"@/components/ui/input\";\nimport { Tooltip, TooltipContent, TooltipProvider, TooltipTrigger } from \"@/components/ui/tooltip\";\nimport { Label } from \"@/components/ui/label\";\nimport { DropdownMenu, DropdownMenuContent, DropdownMenuItem, DropdownMenuSeparator, DropdownMenuTrigger } from \"@/components/ui/dropdown-menu\";\nimport { toast } from \"sonner\";\nimport { cn } from \"@/lib/utils\";\nimport { SearchFilters } from \"@/features/search/components/search-filters\";\nimport { SearchResultsList } from \"@/features/search/components/search-results-list\";\nimport { SearchMap } from \"@/features/search/components/search-map\";\nimport { HIERARCHY_TREE, KEYWORDS } from \"@/features/search/mock-data\";\nimport { useSatelliteItems, useSaveSearch } from \"@/features/search/api\";\nimport { toSearchResult } from \"@/features/search/types\";\n\n\nexport default function SearchResultsPage() {\n  const [location, setLocation] = useLocation();\n  const searchString = useSearch();\n  const params = new URLSearchParams(searchString);\n  const { user, isAuthenticated, isLoading: authLoading } = useAuth();\n  \n  const [query, setQuery] = useState(() => {\n    const q = params.get(\"q\") || \"\";\n    const l = params.get(\"loc\") || \"\";\n    if (q && l) return `${q} in ${l}`;\n    if (l) return l;\n    return q;\n  });\n  const [detectedType, setDetectedType] = useState<'keyword' | 'place' | 'mixed'>('keyword');\n  const [isSearchFocused, setIsSearchFocused] = useState(false);\n\n  // Search State\n  const [keyword, setKeyword] = useState(params.get(\"q\") || \"\");\n  const [place, setPlace] = useState(params.get(\"loc\") || \"\");\n  \n  // UI State\n  const [showMap, setShowMap] = useState(true);\n  const [showFacets, setShowFacets] = useState(true);\n  const [sortBy, setSortBy] = useState(\"relevance\");\n  const [isLoading, setIsLoading] = useState(true);\n  const [isLocationFocused, setIsLocationFocused] = useState(false);\n  const [selectedIndex, setSelectedIndex] = useState(-1);\n\n  // Filter States\n  const [activeFilters, setActiveFilters] = useState<{type: string, value: string, id: string}[]>([]);\n  const [selectedLocationIds, setSelectedLocationIds] = useState<string[]>([]);\n  const [date, setDate] = useState<DateRange | undefined>();\n  const [selectedProperties, setSelectedProperties] = useState<string[]>([]);\n  const [selectedKeywords, setSelectedKeywords] = useState<string[]>([]);\n  const [selectedPlatforms, setSelectedPlatforms] = useState<string[]>([]);\n  const [keywordSearch, setKeywordSearch] = useState(\"\");\n  const [hoveredResultId, setHoveredResultId] = useState<number | null>(null);\n  const [previewedResultId, setPreviewedResultId] = useState<number | null>(null);\n  const [mapStyle, setMapStyle] = useState<'streets' | 'satellite'>('streets');\n  \n  // Saved Search State\n  const [isSaveSearchOpen, setIsSaveSearchOpen] = useState(false);\n  const [saveSearchName, setSaveSearchName] = useState(\"\");\n  const [saveSearchNotify, setSaveSearchNotify] = useState(true);\n  const [isSearchSaved, setIsSearchSaved] = useState(false);\n  const [showShareModal, setShowShareModal] = useState(false);\n  const [savedSearchLink, setSavedSearchLink] = useState(\"https://voyager.ai/s/a8XkD4\");\n  const [showAllSavedSearches, setShowAllSavedSearches] = useState(false);\n  \n  // Mock saved searches data\n  const allSavedSearches = [\n    { id: 1, name: \"Vegetation in California\", keyword: \"vegetation\", place: \"California\", savedAt: \"2 days ago\" },\n    { id: 2, name: \"Urban Growth in Tokyo\", keyword: \"urban\", place: \"Tokyo\", savedAt: \"5 days ago\" },\n    { id: 3, name: \"Deforestation in Amazon\", keyword: \"deforestation\", place: \"Amazon\", savedAt: \"1 week ago\" },\n    { id: 4, name: \"Coastal Erosion in Florida\", keyword: \"coastal erosion\", place: \"Florida\", savedAt: \"2 weeks ago\" },\n    { id: 5, name: \"Agricultural Land in Iowa\", keyword: \"agriculture\", place: \"Iowa\", savedAt: \"3 weeks ago\" },\n    { id: 6, name: \"Glacier Retreat in Alaska\", keyword: \"glacier\", place: \"Alaska\", savedAt: \"1 month ago\" },\n    { id: 7, name: \"Urban Heat Islands in Phoenix\", keyword: \"heat island\", place: \"Phoenix\", savedAt: \"1 month ago\" },\n    { id: 8, name: \"Wetland Changes in Louisiana\", keyword: \"wetland\", place: \"Louisiana\", savedAt: \"2 months ago\" },\n  ];\n\n  const saveSearchMutation = useSaveSearch();\n\n  const handleSaveSearch = () => {\n    saveSearchMutation.mutate({\n      userId: \"demo-user\", // In production, get from auth context\n      name: saveSearchName,\n      keyword,\n      location: place,\n      locationIds: selectedLocationIds.length > 0 ? selectedLocationIds : undefined,\n      keywords: selectedKeywords.length > 0 ? selectedKeywords : undefined,\n      properties: selectedProperties.length > 0 ? selectedProperties : undefined,\n      dateFrom: date?.from,\n      dateTo: date?.to,\n      spatialFilter,\n      notifyOnNewResults: saveSearchNotify ? 1 : 0,\n    }, {\n      onSuccess: () => {\n        setIsSearchSaved(true);\n        setIsSaveSearchOpen(false);\n        toast.success(\"Search saved successfully\", {\n          description: \"You will be notified when new results match this query.\",\n          action: {\n            label: \"Share\",\n            onClick: () => setShowShareModal(true),\n          },\n        });\n      },\n      onError: () => {\n        toast.error(\"Failed to save search\", {\n          description: \"Please try again later.\",\n        });\n      },\n    });\n  };\n\n  const copyLink = () => {\n    navigator.clipboard.writeText(savedSearchLink);\n    toast.success(\"Link copied to clipboard\");\n  };\n\n  const PLACE_SUGGESTIONS = [\n    // Major Cities\n    \"New York, USA\",\n    \"Los Angeles, USA\",\n    \"Chicago, USA\",\n    \"Houston, USA\",\n    \"Phoenix, USA\",\n    \"San Francisco, USA\",\n    \"Seattle, USA\",\n    \"Miami, USA\",\n    \"Boston, USA\",\n    \"Denver, USA\",\n    \"Atlanta, USA\",\n    \"London, UK\",\n    \"Manchester, UK\",\n    \"Edinburgh, UK\",\n    \"Tokyo, Japan\",\n    \"Osaka, Japan\",\n    \"Kyoto, Japan\",\n    \"Paris, France\",\n    \"Lyon, France\",\n    \"Marseille, France\",\n    \"Berlin, Germany\",\n    \"Munich, Germany\",\n    \"Frankfurt, Germany\",\n    \"Sydney, Australia\",\n    \"Melbourne, Australia\",\n    \"Brisbane, Australia\",\n    \"Perth, Australia\",\n    \"Singapore\",\n    \"Dubai, UAE\",\n    \"Abu Dhabi, UAE\",\n    \"Rio de Janeiro, Brazil\",\n    \"So Paulo, Brazil\",\n    \"Toronto, Canada\",\n    \"Vancouver, Canada\",\n    \"Montreal, Canada\",\n    \"Mexico City, Mexico\",\n    \"Mumbai, India\",\n    \"Delhi, India\",\n    \"Bangalore, India\",\n    \"Beijing, China\",\n    \"Shanghai, China\",\n    \"Hong Kong, China\",\n    \"Seoul, South Korea\",\n    \"Bangkok, Thailand\",\n    \"Jakarta, Indonesia\",\n    \"Moscow, Russia\",\n    \"Cape Town, South Africa\",\n    \"Cairo, Egypt\",\n    \"Lagos, Nigeria\",\n    // US States\n    \"California, USA\",\n    \"Texas, USA\",\n    \"Florida, USA\",\n    \"New York State, USA\",\n    \"Alaska, USA\",\n    \"Hawaii, USA\",\n    \"Arizona, USA\",\n    \"Colorado, USA\",\n    \"Washington, USA\",\n    \"Oregon, USA\",\n    \"Nevada, USA\",\n    \"Utah, USA\",\n    \"Montana, USA\",\n    \"Wyoming, USA\",\n    \"Iowa, USA\",\n    \"Louisiana, USA\",\n    // Countries\n    \"United States\",\n    \"United Kingdom\",\n    \"Canada\",\n    \"Australia\",\n    \"Germany\",\n    \"France\",\n    \"Japan\",\n    \"China\",\n    \"India\",\n    \"Brazil\",\n    \"Mexico\",\n    \"Italy\",\n    \"Spain\",\n    \"South Korea\",\n    \"Russia\",\n    \"Indonesia\",\n    \"Thailand\",\n    \"Vietnam\",\n    \"Philippines\",\n    \"Egypt\",\n    \"South Africa\",\n    \"Nigeria\",\n    \"Kenya\",\n    \"Morocco\",\n    // Continents & Regions\n    \"North America\",\n    \"South America\",\n    \"Europe\",\n    \"Asia\",\n    \"Africa\",\n    \"Australia\",\n    \"Antarctica\",\n    \"Middle East\",\n    \"Southeast Asia\",\n    \"Central America\",\n    \"Caribbean\",\n    \"Scandinavia\",\n    // Natural Features\n    \"Amazon Rainforest, Brazil\",\n    \"Sahara Desert, Africa\",\n    \"Great Barrier Reef, Australia\",\n    \"Himalayas, Nepal\",\n    \"Mount Everest, Nepal\",\n    \"Grand Canyon, USA\",\n    \"Yellowstone, USA\",\n    \"Yosemite, USA\",\n    \"Rocky Mountains, USA\",\n    \"Alps, Europe\",\n    \"Andes Mountains, South America\",\n    \"Great Lakes, USA\",\n    \"Mississippi River, USA\",\n    \"Nile River, Egypt\",\n    \"Amazon River, Brazil\",\n    \"Arctic Circle\",\n    \"Antarctic Peninsula\",\n    \"Greenland\",\n    \"Iceland\",\n    \"Galapagos Islands, Ecuador\",\n    \"Madagascar\",\n    \"Borneo, Indonesia\",\n    \"Congo Rainforest, Africa\",\n    \"Serengeti, Tanzania\",\n    \"Great Rift Valley, Africa\"\n  ];\n\n  const filteredPlaces = PLACE_SUGGESTIONS.filter(p => \n    p.toLowerCase().includes(place.toLowerCase())\n  );\n\n  // Reset selection when suggestions change\n  useEffect(() => {\n    setSelectedIndex(-1);\n  }, [place]);\n\n  const { theme } = useTheme();\n  const [isDark, setIsDark] = useState(true);\n\n  useEffect(() => {\n    const checkTheme = () => {\n      if (theme === 'system') {\n        setIsDark(window.matchMedia('(prefers-color-scheme: dark)').matches);\n      } else {\n        setIsDark(theme === 'dark');\n      }\n    };\n    checkTheme();\n    \n    // Listener for system changes if theme is system\n    const mediaQuery = window.matchMedia('(prefers-color-scheme: dark)');\n    const handleChange = () => {\n      if (theme === 'system') checkTheme();\n    };\n    mediaQuery.addEventListener('change', handleChange);\n    return () => mediaQuery.removeEventListener('change', handleChange);\n  }, [theme]);\n\n  // Drawing State\n  const [drawMode, setDrawMode] = useState<'none' | 'box' | 'point' | 'polygon'>('none');\n  const [spatialFilter, setSpatialFilter] = useState<{type: 'box' | 'point' | 'polygon', data: any} | null>(null);\n\n  // API call to fetch satellite items\n  const { data: satelliteData, isLoading: isApiLoading, error } = useSatelliteItems({\n    keyword,\n    locationIds: selectedLocationIds.length > 0 ? selectedLocationIds : undefined,\n    keywords: selectedKeywords.length > 0 ? selectedKeywords : undefined,\n    properties: selectedProperties.length > 0 ? selectedProperties : undefined,\n    dateFrom: date?.from?.toISOString(),\n    dateTo: date?.to?.toISOString(),\n    sortBy: sortBy === 'relevance' ? undefined : sortBy,\n    limit: 100,\n  });\n\n  useEffect(() => {\n    const timer = setTimeout(() => setIsLoading(false), 1000);\n    return () => clearTimeout(timer);\n  }, []);\n\n  // Convert database results to search results\n  const filteredResults = satelliteData ? satelliteData.map(toSearchResult) : [];\n\n  const [searchHistory, setSearchHistory] = useState<string[]>([\n    \"Vegetation in California\",\n    \"Urban Growth in Tokyo\",\n    \"Deforestation in Amazon\",\n    \"Floods in Pakistan\"\n  ]);\n\n  const handleHistorySelect = (historyItem: string) => {\n      setQuery(historyItem);\n      \n      // Trigger search logic\n      let searchKeyword = historyItem;\n      let searchLocation = \"\";\n      const lowerQuery = historyItem.toLowerCase();\n      \n      if (lowerQuery.includes(\" in \")) {\n          const parts = historyItem.split(/ in /i);\n          searchKeyword = parts[0];\n          searchLocation = parts[1];\n      } else if (PLACE_SUGGESTIONS.some(p => p.toLowerCase().includes(lowerQuery))) {\n          searchKeyword = \"\";\n          searchLocation = historyItem;\n      }\n\n      setKeyword(searchKeyword);\n      setPlace(searchLocation);\n      setLocation(`/search?q=${encodeURIComponent(searchKeyword)}&loc=${encodeURIComponent(searchLocation)}`);\n      setIsSearchFocused(false);\n      setIsLoading(true);\n      setTimeout(() => setIsLoading(false), 800);\n  };\n\n  // Detect input type for visual feedback\n  useEffect(() => {\n    const lowerQuery = query.toLowerCase();\n    if (lowerQuery.includes(\" in \")) {\n      setDetectedType('mixed');\n    } else if (PLACE_SUGGESTIONS.some(p => p.toLowerCase().includes(lowerQuery)) && query.length > 2) {\n      setDetectedType('place');\n    } else {\n      setDetectedType('keyword');\n    }\n  }, [query]);\n\n  const handleSearch = (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    // Simple \"Intelligent\" parsing\n    let searchKeyword = query;\n    let searchLocation = \"\";\n\n    const lowerQuery = query.toLowerCase();\n    \n    // Check for \"keyword in location\" pattern\n    if (lowerQuery.includes(\" in \")) {\n        const parts = query.split(/ in /i);\n        searchKeyword = parts[0];\n        searchLocation = parts[1];\n    } \n    // Check if the whole query is a known place\n    else if (PLACE_SUGGESTIONS.some(p => p.toLowerCase().includes(lowerQuery))) {\n        searchKeyword = \"\";\n        searchLocation = query;\n    }\n\n    setKeyword(searchKeyword);\n    setPlace(searchLocation);\n    setLocation(`/search?q=${encodeURIComponent(searchKeyword)}&loc=${encodeURIComponent(searchLocation)}`);\n    setIsLoading(true);\n    setTimeout(() => setIsLoading(false), 800);\n  };\n\n  const handleLocationFilterSelect = (id: string, label: string) => {\n    setSelectedLocationIds(prev => {\n      const isSelected = prev.includes(id);\n      let newSelection;\n      \n      if (isSelected) {\n        newSelection = prev.filter(locId => locId !== id);\n        setActiveFilters(curr => curr.filter(f => f.id !== `loc-${id}`));\n      } else {\n        newSelection = [...prev, id];\n        if (!activeFilters.find(f => f.id === `loc-${id}`)) {\n          setActiveFilters(curr => [...curr, { type: 'location', value: label, id: `loc-${id}` }]);\n        }\n      }\n      return newSelection;\n    });\n  };\n\n  const toggleProperty = (prop: string) => {\n    setSelectedProperties(prev => {\n      if (prev.includes(prop)) return prev.filter(p => p !== prop);\n      return [...prev, prop];\n    });\n  };\n\n  const toggleKeyword = (kw: string) => {\n    setSelectedKeywords(prev => {\n      if (prev.includes(kw)) {\n        setActiveFilters(curr => curr.filter(f => f.id !== `kw-${kw}`));\n        return prev.filter(k => k !== kw);\n      }\n      if (!activeFilters.find(f => f.id === `kw-${kw}`)) {\n        setActiveFilters(curr => [...curr, { type: 'keyword', value: kw, id: `kw-${kw}` }]);\n      }\n      return [...prev, kw];\n    });\n  };\n\n  const togglePlatform = (platform: string) => {\n    setSelectedPlatforms(prev => {\n      if (prev.includes(platform)) return prev.filter(p => p !== platform);\n      return [...prev, platform];\n    });\n  };\n\n  const removeFilter = (id: string) => {\n    if (id.startsWith('loc-')) {\n      const locId = id.replace('loc-', '');\n      setSelectedLocationIds(prev => prev.filter(lid => locId !== lid));\n    } else if (id.startsWith('kw-')) {\n      const kw = id.replace('kw-', '');\n      setSelectedKeywords(prev => prev.filter(k => k !== kw));\n    }\n    setActiveFilters(prev => prev.filter(f => f.id !== id));\n  };\n\n  const clearLocation = () => {\n    setPlace(\"\");\n    setSpatialFilter(null);\n    setLocation(`/search?q=${encodeURIComponent(keyword)}&loc=`);\n  };\n\n  return (\n    <div \n      className=\"flex flex-col h-screen w-full bg-background text-foreground overflow-hidden\"\n    >\n      \n      {/* Row 1: Search Bar Row */}\n      <header className=\"border-b border-border bg-background/95 backdrop-blur-md z-20 shrink-0\">\n        <div className=\"h-14 flex items-center px-4 gap-3\">\n          {/* Logo */}\n          <button \n            onClick={() => setLocation(\"/\")}\n            className=\"flex items-center gap-2 shrink-0 hover:opacity-80 transition-opacity\"\n          >\n            <span className=\"font-display font-bold text-lg tracking-tight\">\n              <span className=\"text-[#3b82f6]\">V</span>\n              <span className=\"text-[#0c3a6d] dark:text-white\">o</span>\n              <span className=\"text-[#3b82f6]\">yager</span>\n            </span>\n          </button>\n\n          {/* Keyword Search Bar */}\n          <form onSubmit={handleSearch} className=\"flex-1 max-w-md relative\">\n            <div className=\"relative flex items-center bg-muted/50 dark:bg-black/50 border border-border rounded-lg px-3 h-9 focus-within:ring-2 focus-within:ring-primary/20 focus-within:border-primary/50 transition-all\">\n              <Search className=\"w-4 h-4 text-muted-foreground shrink-0\" />\n              <input \n                value={keyword}\n                onChange={(e) => setKeyword(e.target.value)}\n                className=\"bg-transparent border-none outline-none text-sm w-full placeholder:text-muted-foreground/70 text-foreground font-medium ml-2\"\n                placeholder=\"Search keywords...\"\n                data-testid=\"input-keyword-search\"\n              />\n            </div>\n          </form>\n\n          {/* Place Search Bar */}\n          <div className=\"flex-1 max-w-sm relative\">\n            <div className={`relative flex items-center bg-muted/50 dark:bg-black/50 border border-border rounded-lg px-3 h-9 transition-all ${isLocationFocused ? 'ring-2 ring-primary/20 border-primary/50' : ''}`}>\n              <MapPin className=\"w-4 h-4 text-muted-foreground shrink-0\" />\n              <input \n                value={place}\n                onChange={(e) => setPlace(e.target.value)}\n                onFocus={() => setIsLocationFocused(true)}\n                onBlur={() => setTimeout(() => setIsLocationFocused(false), 150)}\n                className=\"bg-transparent border-none outline-none text-sm w-full placeholder:text-muted-foreground/70 text-foreground font-medium ml-2\"\n                placeholder=\"Location...\"\n                data-testid=\"input-location-search\"\n              />\n            </div>\n            {/* Location Suggestions */}\n            {isLocationFocused && place.length > 0 && filteredPlaces.length > 0 && (\n              <div className=\"absolute top-full left-0 w-full mt-1 bg-background border border-border rounded-lg shadow-lg z-50 max-h-48 overflow-y-auto\">\n                {filteredPlaces.slice(0, 6).map((p, i) => (\n                  <button\n                    key={i}\n                    type=\"button\"\n                    onClick={() => { setPlace(p); setIsLocationFocused(false); }}\n                    className=\"w-full text-left px-3 py-2 text-sm hover:bg-muted transition-colors flex items-center gap-2\"\n                  >\n                    <MapPin className=\"w-3 h-3 text-muted-foreground\" />\n                    {p}\n                  </button>\n                ))}\n              </div>\n            )}\n          </div>\n\n          {/* Search Button */}\n          <Button type=\"submit\" size=\"sm\" className=\"h-9 px-4\" onClick={handleSearch}>\n            <Search className=\"w-4 h-4\" />\n          </Button>\n\n          {/* Spacer to push right items */}\n          <div className=\"flex-1\" />\n\n          {/* Theme Toggle */}\n          <ThemeToggle />\n\n          {/* Saved Searches Button */}\n          <Button \n            variant=\"ghost\" \n            size=\"sm\" \n            className=\"h-9 gap-2\"\n            onClick={() => setShowAllSavedSearches(true)}\n            data-testid=\"button-saved-searches\"\n          >\n            <Bookmark className=\"w-4 h-4\" />\n            <span className=\"hidden sm:inline\">Saved</span>\n          </Button>\n\n          {/* Account / Login */}\n          {isAuthenticated && user ? (\n            <DropdownMenu>\n              <DropdownMenuTrigger asChild>\n                <Button variant=\"ghost\" size=\"icon\" className=\"rounded-full w-9 h-9 p-0\" data-testid=\"button-account\">\n                  <Avatar className=\"w-8 h-8\">\n                    <AvatarImage src={user.profileImageUrl || undefined} alt={user.firstName || \"User\"} />\n                    <AvatarFallback className=\"text-xs\">\n                      {user.firstName?.[0] || user.email?.[0] || \"U\"}\n                    </AvatarFallback>\n                  </Avatar>\n                </Button>\n              </DropdownMenuTrigger>\n              <DropdownMenuContent align=\"end\" className=\"w-48\">\n                <div className=\"px-2 py-1.5 text-sm font-medium\">{user.firstName || user.email || \"User\"}</div>\n                <DropdownMenuSeparator />\n                <DropdownMenuItem className=\"cursor-pointer gap-2\">\n                  <User className=\"w-4 h-4\" />\n                  Profile\n                </DropdownMenuItem>\n                <DropdownMenuItem className=\"cursor-pointer gap-2\">\n                  <Settings className=\"w-4 h-4\" />\n                  Settings\n                </DropdownMenuItem>\n                <DropdownMenuSeparator />\n                <DropdownMenuItem \n                  className=\"cursor-pointer gap-2 text-destructive focus:text-destructive\"\n                  onClick={() => window.location.href = '/api/logout'}\n                >\n                  <LogOut className=\"w-4 h-4\" />\n                  Logout\n                </DropdownMenuItem>\n              </DropdownMenuContent>\n            </DropdownMenu>\n          ) : (\n            <Button variant=\"outline\" size=\"sm\" className=\"h-9 gap-2\" onClick={() => window.location.href = '/api/login'} data-testid=\"button-login\">\n              <LogIn className=\"w-4 h-4\" />\n              <span className=\"hidden sm:inline\">Login</span>\n            </Button>\n          )}\n        </div>\n\n        {/* Row 2: Toolbar Row */}\n        <div className=\"h-10 flex items-center px-4 gap-3 border-t border-border/50 bg-muted/30\">\n          {/* Filter Panel Toggle - Left Side */}\n          <TooltipProvider>\n            <Tooltip>\n              <TooltipTrigger asChild>\n                <Button \n                  variant={showFacets ? \"secondary\" : \"ghost\"}\n                  size=\"sm\"\n                  className=\"h-7 px-2 gap-1 shrink-0\"\n                  onClick={() => setShowFacets(!showFacets)}\n                  data-testid=\"button-toggle-filters\"\n                >\n                  {showFacets ? <PanelLeftClose className=\"w-4 h-4\" /> : <PanelLeftOpen className=\"w-4 h-4\" />}\n                  <Filter className=\"w-3.5 h-3.5\" />\n                </Button>\n              </TooltipTrigger>\n              <TooltipContent>{showFacets ? 'Collapse Filters' : 'Expand Filters'}</TooltipContent>\n            </Tooltip>\n          </TooltipProvider>\n\n          {/* Active Filters Breadcrumb */}\n          <div className=\"flex-1 flex items-center gap-2 overflow-x-auto no-scrollbar\">\n            {keyword && (\n              <Badge variant=\"secondary\" className=\"gap-1 pl-2 pr-1 py-0.5 font-normal text-xs\">\n                <Search className=\"w-3 h-3 opacity-50\" />\n                {keyword}\n                <button onClick={() => setKeyword(\"\")} className=\"ml-1 hover:bg-background/20 rounded-full p-0.5\">\n                  <X className=\"w-3 h-3\" />\n                </button>\n              </Badge>\n            )}\n            \n            {place && (\n              <Badge variant=\"secondary\" className=\"gap-1 pl-2 pr-1 py-0.5 font-normal text-xs\">\n                <MapPin className=\"w-3 h-3 opacity-50\" />\n                {place}\n                <button onClick={clearLocation} className=\"ml-1 hover:bg-background/20 rounded-full p-0.5\">\n                  <X className=\"w-3 h-3\" />\n                </button>\n              </Badge>\n            )}\n\n            {date?.from && (\n              <Badge variant=\"secondary\" className=\"gap-1 pl-2 pr-1 py-0.5 font-normal text-xs\">\n                <Clock className=\"w-3 h-3 opacity-50\" />\n                {date.to ? (\n                  <>{format(date.from, \"MMM dd\")} - {format(date.to, \"MMM dd\")}</>\n                ) : (\n                  format(date.from, \"MMM dd\")\n                )}\n                <button onClick={() => setDate(undefined)} className=\"ml-1 hover:bg-background/20 rounded-full p-0.5\">\n                  <X className=\"w-3 h-3\" />\n                </button>\n              </Badge>\n            )}\n\n            {activeFilters.map(filter => (\n              <Badge key={filter.id} variant=\"secondary\" className=\"gap-1 pl-2 pr-1 py-0.5 font-normal text-xs\">\n                <span className=\"opacity-50 capitalize\">{filter.type}:</span>\n                {filter.value}\n                <button onClick={() => removeFilter(filter.id)} className=\"ml-1 hover:bg-background/20 rounded-full p-0.5\">\n                  <X className=\"w-3 h-3\" />\n                </button>\n              </Badge>\n            ))}\n\n            {selectedProperties.map(prop => {\n              const label = prop === 'has_thumbnail' ? 'Has Thumbnail' : \n                           prop === 'has_spatial' ? 'Has Spatial' : \n                           prop === 'has_temporal' ? 'Has Temporal' : \n                           prop === 'is_downloadable' ? 'Downloadable' : prop;\n              return (\n                <Badge key={prop} variant=\"secondary\" className=\"gap-1 pl-2 pr-1 py-0.5 font-normal text-xs\">\n                  <Check className=\"w-3 h-3 opacity-50\" />\n                  {label}\n                  <button onClick={() => toggleProperty(prop)} className=\"ml-1 hover:bg-background/20 rounded-full p-0.5\">\n                    <X className=\"w-3 h-3\" />\n                  </button>\n                </Badge>\n              );\n            })}\n\n            {selectedKeywords.map(kw => (\n              <Badge key={kw} variant=\"secondary\" className=\"gap-1 pl-2 pr-1 py-0.5 font-normal text-xs\">\n                <Tag className=\"w-3 h-3 opacity-50\" />\n                {kw}\n                <button onClick={() => toggleKeyword(kw)} className=\"ml-1 hover:bg-background/20 rounded-full p-0.5\">\n                  <X className=\"w-3 h-3\" />\n                </button>\n              </Badge>\n            ))}\n\n            {selectedPlatforms.map(platform => (\n              <Badge key={platform} variant=\"secondary\" className=\"gap-1 pl-2 pr-1 py-0.5 font-normal text-xs\">\n                <Check className=\"w-3 h-3 opacity-50\" />\n                {platform}\n                <button onClick={() => togglePlatform(platform)} className=\"ml-1 hover:bg-background/20 rounded-full p-0.5\">\n                  <X className=\"w-3 h-3\" />\n                </button>\n              </Badge>\n            ))}\n\n            {(keyword || place || activeFilters.length > 0 || date || selectedProperties.length > 0 || selectedKeywords.length > 0 || selectedPlatforms.length > 0 || spatialFilter) && (\n              <button \n                onClick={() => {\n                  setKeyword(\"\");\n                  setPlace(\"\");\n                  setSpatialFilter(null);\n                  setActiveFilters([]);\n                  setSelectedLocationIds([]);\n                  setSelectedProperties([]);\n                  setSelectedKeywords([]);\n                  setSelectedPlatforms([]);\n                  setDate(undefined);\n                  setLocation(\"/search\");\n                }} \n                className=\"text-xs text-muted-foreground hover:text-destructive transition-colors whitespace-nowrap\"\n              >\n                Clear all\n              </button>\n            )}\n          </div>\n\n          <div className=\"w-px h-5 bg-border\" />\n\n          {/* Results Count */}\n          <span className=\"text-xs text-muted-foreground whitespace-nowrap\">\n            {filteredResults.length} results\n          </span>\n\n          {/* Sort Options */}\n          <Select value={sortBy} onValueChange={setSortBy}>\n            <SelectTrigger className=\"w-[140px] h-7 text-xs bg-transparent border-border\">\n              <div className=\"flex items-center gap-2\">\n                <ArrowUpDown className=\"w-3 h-3\" />\n                <SelectValue />\n              </div>\n            </SelectTrigger>\n            <SelectContent>\n              <SelectItem value=\"relevance\">Relevance</SelectItem>\n              <SelectItem value=\"date_desc\">Newest first</SelectItem>\n              <SelectItem value=\"date_asc\">Oldest first</SelectItem>\n              <SelectItem value=\"name_asc\">Name A-Z</SelectItem>\n            </SelectContent>\n          </Select>\n\n          {/* Save Search */}\n          <TooltipProvider>\n            <Tooltip>\n              <TooltipTrigger asChild>\n                <Button \n                  variant={isSearchSaved ? \"secondary\" : \"ghost\"}\n                  size=\"sm\"\n                  className={cn(\n                    \"h-7 gap-1.5 text-xs\",\n                    isSearchSaved && \"bg-primary/10 text-primary\"\n                  )}\n                  onClick={() => {\n                    if (isSearchSaved) {\n                      setShowShareModal(true);\n                    } else {\n                      setIsSaveSearchOpen(true);\n                      setSaveSearchName(keyword || place || \"New Search\");\n                    }\n                  }}\n                  data-testid=\"button-save-search\"\n                >\n                  {isSearchSaved ? <Star className=\"w-3.5 h-3.5 fill-primary\" /> : <Star className=\"w-3.5 h-3.5\" />}\n                  <span className=\"hidden sm:inline\">{isSearchSaved ? \"Saved\" : \"Save\"}</span>\n                </Button>\n              </TooltipTrigger>\n              <TooltipContent>\n                {isSearchSaved ? \"Manage saved search\" : \"Save this search\"}\n              </TooltipContent>\n            </Tooltip>\n          </TooltipProvider>\n\n          {/* Map Panel Toggle - Right Side */}\n          <TooltipProvider>\n            <Tooltip>\n              <TooltipTrigger asChild>\n                <Button \n                  variant={showMap ? \"secondary\" : \"ghost\"}\n                  size=\"sm\"\n                  className=\"h-7 px-2 gap-1 shrink-0\"\n                  onClick={() => setShowMap(!showMap)}\n                  data-testid=\"button-toggle-map\"\n                >\n                  <Map className=\"w-3.5 h-3.5\" />\n                  {showMap ? <PanelRightClose className=\"w-4 h-4\" /> : <PanelRightOpen className=\"w-4 h-4\" />}\n                </Button>\n              </TooltipTrigger>\n              <TooltipContent>{showMap ? 'Collapse Map' : 'Expand Map'}</TooltipContent>\n            </Tooltip>\n          </TooltipProvider>\n        </div>\n\n           {/* Save Search Modal */}\n           <Dialog open={isSaveSearchOpen} onOpenChange={setIsSaveSearchOpen}>\n              <DialogContent className=\"sm:max-w-[425px]\">\n                <DialogHeader>\n                  <DialogTitle className=\"flex items-center gap-2\">\n                    <Star className=\"w-5 h-5 text-primary fill-primary/20\" />\n                    Save Search\n                  </DialogTitle>\n                  <DialogDescription>\n                    Save this search configuration to easily access it later and receive updates.\n                  </DialogDescription>\n                </DialogHeader>\n                \n                <div className=\"grid gap-4 py-4\">\n                  <div className=\"grid gap-2\">\n                    <Label htmlFor=\"name\">Search Name</Label>\n                    <Input \n                      id=\"name\" \n                      value={saveSearchName} \n                      onChange={(e) => setSaveSearchName(e.target.value)} \n                      className=\"col-span-3\" \n                    />\n                  </div>\n                  \n                  {/* Search Preview Summary */}\n                  <div className=\"bg-muted/30 rounded-lg p-3 space-y-2 border border-border/50\">\n                     <div className=\"text-xs font-semibold text-muted-foreground uppercase tracking-wider mb-2\">Search Preview</div>\n                     <div className=\"space-y-1\">\n                        <div className=\"flex items-start gap-2 text-sm\">\n                           <Search className=\"w-3.5 h-3.5 mt-0.5 text-primary\" />\n                           <span className=\"text-foreground/80\">{keyword || \"All keywords\"}</span>\n                        </div>\n                        <div className=\"flex items-start gap-2 text-sm\">\n                           <MapPin className=\"w-3.5 h-3.5 mt-0.5 text-primary\" />\n                           <span className=\"text-foreground/80\">{place || spatialFilter ? (place || \"Custom Area\") : \"Global\"}</span>\n                        </div>\n                        {(activeFilters.length > 0 || date) && (\n                           <div className=\"flex items-start gap-2 text-sm\">\n                             <Filter className=\"w-3.5 h-3.5 mt-0.5 text-primary\" />\n                             <span className=\"text-foreground/80\">\n                               {[\n                                 date ? \"Date Range\" : null,\n                                 ...activeFilters.map(f => f.value),\n                                 ...selectedProperties.map(p => p.replace('has_', '').replace('is_', ''))\n                               ].filter(Boolean).join(\", \")}\n                             </span>\n                           </div>\n                        )}\n                     </div>\n                  </div>\n\n                  <div className=\"flex items-center justify-between space-x-2 border rounded-lg p-3 bg-muted/10\">\n                    <div className=\"flex flex-col gap-1\">\n                      <Label htmlFor=\"notify\" className=\"font-medium cursor-pointer\">Email Notifications</Label>\n                      <span className=\"text-xs text-muted-foreground\">Get notified when new results appear</span>\n                    </div>\n                    <Switch id=\"notify\" checked={saveSearchNotify} onCheckedChange={setSaveSearchNotify} />\n                  </div>\n                </div>\n\n                <DialogFooter className=\"gap-2 sm:gap-0\">\n                  <Button variant=\"outline\" onClick={() => setIsSaveSearchOpen(false)}>Cancel</Button>\n                  <Button onClick={handleSaveSearch}>Save Search</Button>\n                </DialogFooter>\n              </DialogContent>\n           </Dialog>\n\n           {/* Share Modal */}\n           <Dialog open={showShareModal} onOpenChange={setShowShareModal}>\n             <DialogContent className=\"sm:max-w-md\">\n               <DialogHeader>\n                 <DialogTitle className=\"flex items-center gap-2\">\n                   <Share2 className=\"w-5 h-5 text-primary\" />\n                   Share Search\n                 </DialogTitle>\n                 <DialogDescription>\n                   Anyone with this link can view these search results.\n                 </DialogDescription>\n               </DialogHeader>\n               <div className=\"flex items-center space-x-2 mt-2\">\n                 <div className=\"grid flex-1 gap-2\">\n                   <Label htmlFor=\"link\" className=\"sr-only\">\n                     Link\n                   </Label>\n                   <Input\n                     id=\"link\"\n                     defaultValue={savedSearchLink}\n                     readOnly\n                     className=\"bg-muted/30 font-mono text-xs\"\n                   />\n                 </div>\n                 <Button type=\"submit\" size=\"sm\" className=\"px-3\" onClick={copyLink}>\n                   <span className=\"sr-only\">Copy</span>\n                   <Copy className=\"h-4 w-4\" />\n                 </Button>\n               </div>\n               <div className=\"flex flex-col gap-2 mt-4\">\n                  <Button variant=\"outline\" className=\"w-full justify-start text-muted-foreground hover:text-foreground\">\n                    <Mail className=\"w-4 h-4 mr-2\" />\n                    Email to colleague\n                  </Button>\n               </div>\n               <DialogFooter className=\"sm:justify-start\">\n                 <div className=\"flex items-center space-x-2\">\n                    <div className=\"text-[10px] text-muted-foreground flex items-center gap-1\">\n                      <Info className=\"w-3 h-3\" />\n                      Results may vary based on user permissions\n                    </div>\n                 </div>\n               </DialogFooter>\n             </DialogContent>\n           </Dialog>\n\n           {/* All Saved Searches Dialog */}\n           <Dialog open={showAllSavedSearches} onOpenChange={setShowAllSavedSearches}>\n             <DialogContent className=\"sm:max-w-lg\">\n               <DialogHeader>\n                 <DialogTitle className=\"flex items-center gap-2\">\n                   <Bookmark className=\"w-5 h-5\" />\n                   All Saved Searches\n                 </DialogTitle>\n                 <DialogDescription>\n                   Select a saved search to load its results.\n                 </DialogDescription>\n               </DialogHeader>\n               <div className=\"max-h-[400px] overflow-y-auto\">\n                 <div className=\"flex flex-col gap-1\">\n                   {allSavedSearches.map((search) => (\n                     <button\n                       key={search.id}\n                       className=\"w-full text-left p-3 rounded-lg hover:bg-muted transition-colors flex items-center justify-between group\"\n                       onClick={() => {\n                         setKeyword(search.keyword);\n                         setPlace(search.place);\n                         setShowAllSavedSearches(false);\n                         toast.success(`Loaded \"${search.name}\"`);\n                       }}\n                       data-testid={`saved-search-${search.id}`}\n                     >\n                       <div className=\"flex flex-col gap-0.5\">\n                         <span className=\"font-medium text-sm\">{search.name}</span>\n                         <div className=\"flex items-center gap-2 text-xs text-muted-foreground\">\n                           <span className=\"flex items-center gap-1\">\n                             <Search className=\"w-3 h-3\" />\n                             {search.keyword}\n                           </span>\n                           <span className=\"flex items-center gap-1\">\n                             <MapPin className=\"w-3 h-3\" />\n                             {search.place}\n                           </span>\n                         </div>\n                       </div>\n                       <span className=\"text-xs text-muted-foreground group-hover:text-foreground transition-colors\">\n                         {search.savedAt}\n                       </span>\n                     </button>\n                   ))}\n                 </div>\n               </div>\n             </DialogContent>\n           </Dialog>\n      </header>\n\n      {/* Main Split Layout */}\n      <div className=\"flex-1 flex overflow-hidden relative min-h-0\">\n        {/* Facets Panel (Refactored) */}\n        <SearchFilters\n          showFacets={showFacets}\n          setShowFacets={setShowFacets}\n          date={date}\n          setDate={setDate}\n          hierarchyTree={HIERARCHY_TREE}\n          handleLocationFilterSelect={handleLocationFilterSelect}\n          selectedLocationIds={selectedLocationIds}\n          keywords={KEYWORDS}\n          keywordSearch={keywordSearch}\n          setKeywordSearch={setKeywordSearch}\n          toggleKeyword={toggleKeyword}\n          selectedKeywords={selectedKeywords}\n          selectedProperties={selectedProperties}\n          toggleProperty={toggleProperty}\n          selectedPlatforms={selectedPlatforms}\n          togglePlatform={togglePlatform}\n        />\n\n        {/* Results Grid (Refactored) */}\n        <SearchResultsList\n          isLoading={isLoading}\n          filteredResults={filteredResults}\n          setHoveredResultId={setHoveredResultId}\n          setPreviewedResultId={setPreviewedResultId}\n          setLocation={setLocation}\n          onFilterByFormat={(format) => setKeyword(format)}\n          onFilterByProvider={(provider) => setKeyword(provider)}\n          showFacets={showFacets}\n          showMap={showMap}\n        />\n\n        {/* Right Panel - Map (Refactored) */}\n        <SearchMap\n           showMap={showMap}\n           setShowMap={setShowMap}\n           mapStyle={mapStyle}\n           setMapStyle={setMapStyle}\n           isDark={isDark}\n           filteredResults={filteredResults}\n           hoveredResultId={hoveredResultId}\n           previewedResultId={previewedResultId}\n           drawMode={drawMode}\n           setDrawMode={setDrawMode}\n           setSpatialFilter={setSpatialFilter}\n           setPlace={setPlace}\n           spatialFilter={spatialFilter}\n        />\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":40578,"size_tokens":null},"client/src/components/ui/label.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst labelVariants = cva(\n  \"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n)\n\nconst Label = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &\n    VariantProps<typeof labelVariants>\n>(({ className, ...props }, ref) => (\n  <LabelPrimitive.Root\n    ref={ref}\n    className={cn(labelVariants(), className)}\n    {...props}\n  />\n))\nLabel.displayName = LabelPrimitive.Root.displayName\n\nexport { Label }\n","path":null,"size_bytes":724,"size_tokens":null},"vite.config.ts":{"content":"import { defineConfig } from \"vite\";\nimport react from \"@vitejs/plugin-react\";\nimport tailwindcss from \"@tailwindcss/vite\";\nimport path from \"path\";\nimport runtimeErrorOverlay from \"@replit/vite-plugin-runtime-error-modal\";\nimport { metaImagesPlugin } from \"./vite-plugin-meta-images\";\n\nexport default defineConfig({\n  plugins: [\n    react(),\n    runtimeErrorOverlay(),\n    tailwindcss(),\n    metaImagesPlugin(),\n    ...(process.env.NODE_ENV !== \"production\" &&\n    process.env.REPL_ID !== undefined\n      ? [\n          await import(\"@replit/vite-plugin-cartographer\").then((m) =>\n            m.cartographer(),\n          ),\n          await import(\"@replit/vite-plugin-dev-banner\").then((m) =>\n            m.devBanner(),\n          ),\n        ]\n      : []),\n  ],\n  resolve: {\n    alias: {\n      \"@\": path.resolve(import.meta.dirname, \"client\", \"src\"),\n      \"@shared\": path.resolve(import.meta.dirname, \"shared\"),\n      \"@assets\": path.resolve(import.meta.dirname, \"attached_assets\"),\n    },\n  },\n  css: {\n    postcss: {\n      plugins: [],\n    },\n  },\n  root: path.resolve(import.meta.dirname, \"client\"),\n  build: {\n    outDir: path.resolve(import.meta.dirname, \"dist/public\"),\n    emptyOutDir: true,\n  },\n  server: {\n    host: \"0.0.0.0\",\n    allowedHosts: true,\n    fs: {\n      strict: true,\n      deny: [\"**/.*\"],\n    },\n  },\n});\n","path":null,"size_bytes":1330,"size_tokens":null},"server/index.ts":{"content":"import express, { type Request, Response, NextFunction } from \"express\";\nimport { registerRoutes } from \"./routes\";\nimport { serveStatic } from \"./static\";\nimport { createServer } from \"http\";\n\nconst app = express();\nconst httpServer = createServer(app);\n\ndeclare module \"http\" {\n  interface IncomingMessage {\n    rawBody: unknown;\n  }\n}\n\napp.use(\n  express.json({\n    verify: (req, _res, buf) => {\n      req.rawBody = buf;\n    },\n  }),\n);\n\napp.use(express.urlencoded({ extended: false }));\n\nexport function log(message: string, source = \"express\") {\n  const formattedTime = new Date().toLocaleTimeString(\"en-US\", {\n    hour: \"numeric\",\n    minute: \"2-digit\",\n    second: \"2-digit\",\n    hour12: true,\n  });\n\n  console.log(`${formattedTime} [${source}] ${message}`);\n}\n\napp.use((req, res, next) => {\n  const start = Date.now();\n  const path = req.path;\n  let capturedJsonResponse: Record<string, any> | undefined = undefined;\n\n  const originalResJson = res.json;\n  res.json = function (bodyJson, ...args) {\n    capturedJsonResponse = bodyJson;\n    return originalResJson.apply(res, [bodyJson, ...args]);\n  };\n\n  res.on(\"finish\", () => {\n    const duration = Date.now() - start;\n    if (path.startsWith(\"/api\")) {\n      let logLine = `${req.method} ${path} ${res.statusCode} in ${duration}ms`;\n      if (capturedJsonResponse) {\n        logLine += ` :: ${JSON.stringify(capturedJsonResponse)}`;\n      }\n\n      log(logLine);\n    }\n  });\n\n  next();\n});\n\n(async () => {\n  await registerRoutes(httpServer, app);\n\n  app.use((err: any, _req: Request, res: Response, _next: NextFunction) => {\n    const status = err.status || err.statusCode || 500;\n    const message = err.message || \"Internal Server Error\";\n\n    res.status(status).json({ message });\n    throw err;\n  });\n\n  // importantly only setup vite in development and after\n  // setting up all the other routes so the catch-all route\n  // doesn't interfere with the other routes\n  if (process.env.NODE_ENV === \"production\") {\n    serveStatic(app);\n  } else {\n    const { setupVite } = await import(\"./vite\");\n    await setupVite(httpServer, app);\n  }\n\n  // ALWAYS serve the app on the port specified in the environment variable PORT\n  // Other ports are firewalled. Default to 5000 if not specified.\n  // this serves both the API and the client.\n  // It is the only port that is not firewalled.\n  const port = parseInt(process.env.PORT || \"5000\", 10);\n  httpServer.listen(\n    {\n      port,\n      host: \"0.0.0.0\",\n      reusePort: true,\n    },\n    () => {\n      log(`serving on port ${port}`);\n    },\n  );\n})();\n","path":null,"size_bytes":2560,"size_tokens":null},"client/src/components/ui/sidebar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, VariantProps } from \"class-variance-authority\"\nimport { PanelLeftIcon } from \"lucide-react\"\n\nimport { useIsMobile } from \"@/hooks/use-mobile\"\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\nimport { Input } from \"@/components/ui/input\"\nimport { Separator } from \"@/components/ui/separator\"\nimport {\n  Sheet,\n  SheetContent,\n  SheetDescription,\n  SheetHeader,\n  SheetTitle,\n} from \"@/components/ui/sheet\"\nimport { Skeleton } from \"@/components/ui/skeleton\"\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipProvider,\n  TooltipTrigger,\n} from \"@/components/ui/tooltip\"\n\nconst SIDEBAR_COOKIE_NAME = \"sidebar_state\"\nconst SIDEBAR_COOKIE_MAX_AGE = 60 * 60 * 24 * 7\nconst SIDEBAR_WIDTH = \"16rem\"\nconst SIDEBAR_WIDTH_MOBILE = \"18rem\"\nconst SIDEBAR_WIDTH_ICON = \"3rem\"\nconst SIDEBAR_KEYBOARD_SHORTCUT = \"b\"\n\ntype SidebarContextProps = {\n  state: \"expanded\" | \"collapsed\"\n  open: boolean\n  setOpen: (open: boolean) => void\n  openMobile: boolean\n  setOpenMobile: (open: boolean) => void\n  isMobile: boolean\n  toggleSidebar: () => void\n}\n\nconst SidebarContext = React.createContext<SidebarContextProps | null>(null)\n\nfunction useSidebar() {\n  const context = React.useContext(SidebarContext)\n  if (!context) {\n    throw new Error(\"useSidebar must be used within a SidebarProvider.\")\n  }\n\n  return context\n}\n\nfunction SidebarProvider({\n  defaultOpen = true,\n  open: openProp,\n  onOpenChange: setOpenProp,\n  className,\n  style,\n  children,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  defaultOpen?: boolean\n  open?: boolean\n  onOpenChange?: (open: boolean) => void\n}) {\n  const isMobile = useIsMobile()\n  const [openMobile, setOpenMobile] = React.useState(false)\n\n  // This is the internal state of the sidebar.\n  // We use openProp and setOpenProp for control from outside the component.\n  const [_open, _setOpen] = React.useState(defaultOpen)\n  const open = openProp ?? _open\n  const setOpen = React.useCallback(\n    (value: boolean | ((value: boolean) => boolean)) => {\n      const openState = typeof value === \"function\" ? value(open) : value\n      if (setOpenProp) {\n        setOpenProp(openState)\n      } else {\n        _setOpen(openState)\n      }\n\n      // This sets the cookie to keep the sidebar state.\n      document.cookie = `${SIDEBAR_COOKIE_NAME}=${openState}; path=/; max-age=${SIDEBAR_COOKIE_MAX_AGE}`\n    },\n    [setOpenProp, open]\n  )\n\n  // Helper to toggle the sidebar.\n  const toggleSidebar = React.useCallback(() => {\n    return isMobile ? setOpenMobile((open) => !open) : setOpen((open) => !open)\n  }, [isMobile, setOpen, setOpenMobile])\n\n  // Adds a keyboard shortcut to toggle the sidebar.\n  React.useEffect(() => {\n    const handleKeyDown = (event: KeyboardEvent) => {\n      if (\n        event.key === SIDEBAR_KEYBOARD_SHORTCUT &&\n        (event.metaKey || event.ctrlKey)\n      ) {\n        event.preventDefault()\n        toggleSidebar()\n      }\n    }\n\n    window.addEventListener(\"keydown\", handleKeyDown)\n    return () => window.removeEventListener(\"keydown\", handleKeyDown)\n  }, [toggleSidebar])\n\n  // We add a state so that we can do data-state=\"expanded\" or \"collapsed\".\n  // This makes it easier to style the sidebar with Tailwind classes.\n  const state = open ? \"expanded\" : \"collapsed\"\n\n  const contextValue = React.useMemo<SidebarContextProps>(\n    () => ({\n      state,\n      open,\n      setOpen,\n      isMobile,\n      openMobile,\n      setOpenMobile,\n      toggleSidebar,\n    }),\n    [state, open, setOpen, isMobile, openMobile, setOpenMobile, toggleSidebar]\n  )\n\n  return (\n    <SidebarContext.Provider value={contextValue}>\n      <TooltipProvider delayDuration={0}>\n        <div\n          data-slot=\"sidebar-wrapper\"\n          style={\n            {\n              \"--sidebar-width\": SIDEBAR_WIDTH,\n              \"--sidebar-width-icon\": SIDEBAR_WIDTH_ICON,\n              ...style,\n            } as React.CSSProperties\n          }\n          className={cn(\n            \"group/sidebar-wrapper has-data-[variant=inset]:bg-sidebar flex min-h-svh w-full\",\n            className\n          )}\n          {...props}\n        >\n          {children}\n        </div>\n      </TooltipProvider>\n    </SidebarContext.Provider>\n  )\n}\n\nfunction Sidebar({\n  side = \"left\",\n  variant = \"sidebar\",\n  collapsible = \"offcanvas\",\n  className,\n  children,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  side?: \"left\" | \"right\"\n  variant?: \"sidebar\" | \"floating\" | \"inset\"\n  collapsible?: \"offcanvas\" | \"icon\" | \"none\"\n}) {\n  const { isMobile, state, openMobile, setOpenMobile } = useSidebar()\n\n  if (collapsible === \"none\") {\n    return (\n      <div\n        data-slot=\"sidebar\"\n        className={cn(\n          \"bg-sidebar text-sidebar-foreground flex h-full w-[var(--sidebar-width)] flex-col\",\n          className\n        )}\n        {...props}\n      >\n        {children}\n      </div>\n    )\n  }\n\n  if (isMobile) {\n    return (\n      <Sheet open={openMobile} onOpenChange={setOpenMobile} {...props}>\n        <SheetContent\n          data-sidebar=\"sidebar\"\n          data-slot=\"sidebar\"\n          data-mobile=\"true\"\n          className=\"bg-sidebar text-sidebar-foreground w-[var(--sidebar-width)] p-0 [&>button]:hidden\"\n          style={\n            {\n              \"--sidebar-width\": SIDEBAR_WIDTH_MOBILE,\n            } as React.CSSProperties\n          }\n          side={side}\n        >\n          <SheetHeader className=\"sr-only\">\n            <SheetTitle>Sidebar</SheetTitle>\n            <SheetDescription>Displays the mobile sidebar.</SheetDescription>\n          </SheetHeader>\n          <div className=\"flex h-full w-full flex-col\">{children}</div>\n        </SheetContent>\n      </Sheet>\n    )\n  }\n\n  return (\n    <div\n      className=\"group peer text-sidebar-foreground hidden md:block\"\n      data-state={state}\n      data-collapsible={state === \"collapsed\" ? collapsible : \"\"}\n      data-variant={variant}\n      data-side={side}\n      data-slot=\"sidebar\"\n    >\n      {/* This is what handles the sidebar gap on desktop */}\n      <div\n        data-slot=\"sidebar-gap\"\n        className={cn(\n          \"relative w-[var(--sidebar-width)] bg-transparent transition-[width] duration-200 ease-linear\",\n          \"group-data-[collapsible=offcanvas]:w-0\",\n          \"group-data-[side=right]:rotate-180\",\n          variant === \"floating\" || variant === \"inset\"\n            ? \"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4))]\"\n            : \"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)]\"\n        )}\n      />\n      <div\n        data-slot=\"sidebar-container\"\n        className={cn(\n          \"fixed inset-y-0 z-10 hidden h-svh w-[var(--sidebar-width)] transition-[left,right,width] duration-200 ease-linear md:flex\",\n          side === \"left\"\n            ? \"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]\"\n            : \"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]\",\n          // Adjust the padding for floating and inset variants.\n          variant === \"floating\" || variant === \"inset\"\n            ? \"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4)+2px)]\"\n            : \"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)] group-data-[side=left]:border-r group-data-[side=right]:border-l\",\n          className\n        )}\n        {...props}\n      >\n        <div\n          data-sidebar=\"sidebar\"\n          data-slot=\"sidebar-inner\"\n          className=\"bg-sidebar group-data-[variant=floating]:border-sidebar-border flex h-full w-full flex-col group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:shadow-sm\"\n        >\n          {children}\n        </div>\n      </div>\n    </div>\n  )\n}\n\nfunction SidebarTrigger({\n  className,\n  onClick,\n  ...props\n}: React.ComponentProps<typeof Button>) {\n  const { toggleSidebar } = useSidebar()\n\n  return (\n    <Button\n      data-sidebar=\"trigger\"\n      data-slot=\"sidebar-trigger\"\n      variant=\"ghost\"\n      size=\"icon\"\n      className={cn(\"h-7 w-7\", className)}\n      onClick={(event) => {\n        onClick?.(event)\n        toggleSidebar()\n      }}\n      {...props}\n    >\n      <PanelLeftIcon />\n      <span className=\"sr-only\">Toggle Sidebar</span>\n    </Button>\n  )\n}\n\nfunction SidebarRail({ className, ...props }: React.ComponentProps<\"button\">) {\n  const { toggleSidebar } = useSidebar()\n\n  // Note: Tailwind v3.4 doesn't support \"in-\" selectors. So the rail won't work perfectly.\n  return (\n    <button\n      data-sidebar=\"rail\"\n      data-slot=\"sidebar-rail\"\n      aria-label=\"Toggle Sidebar\"\n      tabIndex={-1}\n      onClick={toggleSidebar}\n      title=\"Toggle Sidebar\"\n      className={cn(\n        \"hover:after:bg-sidebar-border absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear group-data-[side=left]:-right-4 group-data-[side=right]:left-0 after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] sm:flex\",\n        \"in-data-[side=left]:cursor-w-resize in-data-[side=right]:cursor-e-resize\",\n        \"[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize\",\n        \"hover:group-data-[collapsible=offcanvas]:bg-sidebar group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full\",\n        \"[[data-side=left][data-collapsible=offcanvas]_&]:-right-2\",\n        \"[[data-side=right][data-collapsible=offcanvas]_&]:-left-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarInset({ className, ...props }: React.ComponentProps<\"main\">) {\n  return (\n    <main\n      data-slot=\"sidebar-inset\"\n      className={cn(\n        \"bg-background relative flex w-full flex-1 flex-col\",\n        \"md:peer-data-[variant=inset]:m-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow-sm md:peer-data-[variant=inset]:peer-data-[state=collapsed]:ml-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarInput({\n  className,\n  ...props\n}: React.ComponentProps<typeof Input>) {\n  return (\n    <Input\n      data-slot=\"sidebar-input\"\n      data-sidebar=\"input\"\n      className={cn(\"bg-background h-8 w-full shadow-none\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarHeader({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-header\"\n      data-sidebar=\"header\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarFooter({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-footer\"\n      data-sidebar=\"footer\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarSeparator({\n  className,\n  ...props\n}: React.ComponentProps<typeof Separator>) {\n  return (\n    <Separator\n      data-slot=\"sidebar-separator\"\n      data-sidebar=\"separator\"\n      className={cn(\"bg-sidebar-border mx-2 w-auto\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-content\"\n      data-sidebar=\"content\"\n      className={cn(\n        \"flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroup({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-group\"\n      data-sidebar=\"group\"\n      className={cn(\"relative flex w-full min-w-0 flex-col p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupLabel({\n  className,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"div\"> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"div\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-group-label\"\n      data-sidebar=\"group-label\"\n      className={cn(\n        \"text-sidebar-foreground/70 ring-sidebar-ring flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium outline-hidden transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&>svg]:h-4 [&>svg]:w-4 [&>svg]:shrink-0\",\n        \"group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupAction({\n  className,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"button\"> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-group-action\"\n      data-sidebar=\"group-action\"\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground absolute top-3.5 right-3 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 md:after:hidden\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupContent({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-group-content\"\n      data-sidebar=\"group-content\"\n      className={cn(\"w-full text-sm\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenu({ className, ...props }: React.ComponentProps<\"ul\">) {\n  return (\n    <ul\n      data-slot=\"sidebar-menu\"\n      data-sidebar=\"menu\"\n      className={cn(\"flex w-full min-w-0 flex-col gap-1\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuItem({ className, ...props }: React.ComponentProps<\"li\">) {\n  return (\n    <li\n      data-slot=\"sidebar-menu-item\"\n      data-sidebar=\"menu-item\"\n      className={cn(\"group/menu-item relative\", className)}\n      {...props}\n    />\n  )\n}\n\nconst sidebarMenuButtonVariants = cva(\n  \"peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-hidden ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:w-8! group-data-[collapsible=icon]:h-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground\",\n        outline:\n          \"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]\",\n      },\n      size: {\n        default: \"h-8 text-sm\",\n        sm: \"h-7 text-xs\",\n        lg: \"h-12 text-sm group-data-[collapsible=icon]:p-0!\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nfunction SidebarMenuButton({\n  asChild = false,\n  isActive = false,\n  variant = \"default\",\n  size = \"default\",\n  tooltip,\n  className,\n  ...props\n}: React.ComponentProps<\"button\"> & {\n  asChild?: boolean\n  isActive?: boolean\n  tooltip?: string | React.ComponentProps<typeof TooltipContent>\n} & VariantProps<typeof sidebarMenuButtonVariants>) {\n  const Comp = asChild ? Slot : \"button\"\n  const { isMobile, state } = useSidebar()\n\n  const button = (\n    <Comp\n      data-slot=\"sidebar-menu-button\"\n      data-sidebar=\"menu-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(sidebarMenuButtonVariants({ variant, size }), className)}\n      {...props}\n    />\n  )\n\n  if (!tooltip) {\n    return button\n  }\n\n  if (typeof tooltip === \"string\") {\n    tooltip = {\n      children: tooltip,\n    }\n  }\n\n  return (\n    <Tooltip>\n      <TooltipTrigger asChild>{button}</TooltipTrigger>\n      <TooltipContent\n        side=\"right\"\n        align=\"center\"\n        hidden={state !== \"collapsed\" || isMobile}\n        {...tooltip}\n      />\n    </Tooltip>\n  )\n}\n\nfunction SidebarMenuAction({\n  className,\n  asChild = false,\n  showOnHover = false,\n  ...props\n}: React.ComponentProps<\"button\"> & {\n  asChild?: boolean\n  showOnHover?: boolean\n}) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-menu-action\"\n      data-sidebar=\"menu-action\"\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer-hover/menu-button:text-sidebar-accent-foreground absolute top-1.5 right-1 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 md:after:hidden\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        showOnHover &&\n          \"peer-data-[active=true]/menu-button:text-sidebar-accent-foreground group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 md:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuBadge({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-menu-badge\"\n      data-sidebar=\"menu-badge\"\n      className={cn(\n        \"text-sidebar-foreground pointer-events-none absolute right-1 flex h-5 min-w-5 items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums select-none\",\n        \"peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSkeleton({\n  className,\n  showIcon = false,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  showIcon?: boolean\n}) {\n  // Random width between 50 to 90%.\n  const width = React.useMemo(() => {\n    return `${Math.floor(Math.random() * 40) + 50}%`\n  }, [])\n\n  return (\n    <div\n      data-slot=\"sidebar-menu-skeleton\"\n      data-sidebar=\"menu-skeleton\"\n      className={cn(\"flex h-8 items-center gap-2 rounded-md px-2\", className)}\n      {...props}\n    >\n      {showIcon && (\n        <Skeleton\n          className=\"size-4 rounded-md\"\n          data-sidebar=\"menu-skeleton-icon\"\n        />\n      )}\n      <Skeleton\n        className=\"h-4 max-w-[var(--skeleton-width)] flex-1\"\n        data-sidebar=\"menu-skeleton-text\"\n        style={\n          {\n            \"--skeleton-width\": width,\n          } as React.CSSProperties\n        }\n      />\n    </div>\n  )\n}\n\nfunction SidebarMenuSub({ className, ...props }: React.ComponentProps<\"ul\">) {\n  return (\n    <ul\n      data-slot=\"sidebar-menu-sub\"\n      data-sidebar=\"menu-sub\"\n      className={cn(\n        \"border-sidebar-border mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l px-2.5 py-0.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSubItem({\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) {\n  return (\n    <li\n      data-slot=\"sidebar-menu-sub-item\"\n      data-sidebar=\"menu-sub-item\"\n      className={cn(\"group/menu-sub-item relative\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSubButton({\n  asChild = false,\n  size = \"md\",\n  isActive = false,\n  className,\n  ...props\n}: React.ComponentProps<\"a\"> & {\n  asChild?: boolean\n  size?: \"sm\" | \"md\"\n  isActive?: boolean\n}) {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-menu-sub-button\"\n      data-sidebar=\"menu-sub-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground active:bg-sidebar-accent active:text-sidebar-accent-foreground [&>svg]:text-sidebar-accent-foreground flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 outline outline-2 outline-transparent outline-offset-2 focus-visible:ring-2 disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n        \"data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground\",\n        size === \"sm\" && \"text-xs\",\n        size === \"md\" && \"text-sm\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Sidebar,\n  SidebarContent,\n  SidebarFooter,\n  SidebarGroup,\n  SidebarGroupAction,\n  SidebarGroupContent,\n  SidebarGroupLabel,\n  SidebarHeader,\n  SidebarInput,\n  SidebarInset,\n  SidebarMenu,\n  SidebarMenuAction,\n  SidebarMenuBadge,\n  SidebarMenuButton,\n  SidebarMenuItem,\n  SidebarMenuSkeleton,\n  SidebarMenuSub,\n  SidebarMenuSubButton,\n  SidebarMenuSubItem,\n  SidebarProvider,\n  SidebarRail,\n  SidebarSeparator,\n  SidebarTrigger,\n  useSidebar,\n}\n","path":null,"size_bytes":21846,"size_tokens":null},"PRD.md":{"content":"# Product Requirements Document (PRD): Voyager Geospatial Search\n\n## 1. Executive Summary\n**Voyager** is a next-generation geospatial search interface designed to simplify the discovery, analysis, and acquisition of satellite imagery and Earth observation data. It bridges the gap between complex query languages and intuitive user experiences, offering \"intelligent\" search capabilities that distinguish between semantic keywords and geospatial locations automatically.\n\n## 2. Problem Statement\nCurrent geospatial catalogs often require users to manually draw bounding boxes or use complex query parameters to find relevant data. Users struggle to:\n- Distinguish between searching for a \"place\" (e.g., \"Paris\") vs. a \"thing\" (e.g., \"Vegetation\").\n- Understand the history and processing lineage of a satellite image.\n- Quickly preview footprint coverage without downloading heavy files.\n- Share specific search contexts with colleagues securely.\n\n## 3. Target Audience\n- **GIS Analysts:** Need precise filtering and visual verification of coverage.\n- **Remote Sensing Scientists:** Care about data provenance, processing levels, and spectral bands.\n- **Data Engineers:** Need to download or integrate data into pipelines efficiently.\n\n## 4. Key Features & Requirements\n\n### 4.1. Intelligent Search\n- **Unified Search Bar:** A single input field that parses natural language.\n- **Intent Detection:** Automatically classifies input terms as `KEYWORD` (e.g., \"Fire\", \"Vegetation\") or `LOCATION` (e.g., \"California\", \"Amazon Rainforest\").\n- **Visual Feedback:** distinct UI badges/labels in the search bar showing how terms were interpreted.\n- **Search History:** Quick access to recent queries via a dropdown.\n\n### 4.2. Spatial Discovery & Filtering\n- **Map-Based Search:** Interactive map tightly coupled with list results.\n- **Drawing Tools:**\n  - **Bounding Box:** Drag to select a rectangular Area of Interest (AOI).\n  - **Point:** Click to select a specific coordinate.\n  - **Polygon:** Draw custom shapes for irregular areas.\n- **Location Hierarchy:** Faceted browsing by continent, country, and region (mocked hierarchy).\n\n### 4.3. Results Visualization\n- **List View:** Cards displaying thumbnail, cloud cover, resolution, platform (e.g., Sentinel-2, Landsat 9), and date.\n- **Map Overlays:** Hovering over a result projects its footprint and thumbnail overlay onto the map for context.\n- **Fly-to Animation:** Clicking a result or filter automatically zooms the map to the relevant bounds.\n\n### 4.4. Item Details & Lineage\n- **Metadata View:** Comprehensive table of spectral bands, processing levels, and acquisition details.\n- **Lineage Tab:** Displays relationships to other items:\n  - *Derived From:* Source Level-1C data.\n  - *Co-located:* Other satellites capturing the same area at similar times.\n  - *Next Pass:* Future acquisition predictions.\n- **Provenance Tab:** Timeline view of the data's lifecycle (Ingestion -> Processing -> Archival) with timestamps and system agents.\n- **Context Map:** Mini-map showing the item's specific footprint with a toggle for Satellite/Street basemaps.\n\n### 4.5. Collaboration & Acquisition\n- **Saved Searches:** Users can save complex query configurations (AOI + Keywords + Date) and toggle \"Notifications\" for new matches.\n- **Deep Linking (Share):** Generates a URL with an auth token parameter to share specific items or search contexts with authorized users.\n- **Download Simulation:** \"Download\" action initiates a file transfer simulation with toast notifications.\n\n## 5. User Flows\n1. **Discovery:** User types \"Vegetation in California\". System identifies \"Vegetation\" (Keyword) and \"California\" (Location) and zooms map.\n2. **Refinement:** User selects \"Last 30 Days\" and draws a smaller box over Northern California.\n3. **Selection:** User clicks a result. Map flies to bounds. Thumbnail projects on map.\n4. **Analysis:** User views \"Lineage\" to ensure data is derived from a trusted source.\n5. **Action:** User saves the search as \"NorCal Veg Monitor\" or downloads the GeoTIFF.\n\n## 6. Technical Architecture (Prototype)\n- **Framework:** React (Vite)\n- **Styling:** Tailwind CSS + Shadcn UI\n- **Mapping Engine:** Leaflet (react-leaflet)\n- **Routing:** Wouter\n- **State Management:** React Context / Local State (No Redux)\n- **Data Source:** In-memory mock data generators with realistic geospatial bounds.\n\n## 7. Future Roadmap (Post-Mockup)\n- **Backend Integration:** Connect to STAC (SpatioTemporal Asset Catalog) API.\n- **Auth Integration:** Real user authentication and RBAC for \"Authorized Link\" sharing.\n- **Tile Server:** Replace static thumbnails with dynamic COG (Cloud Optimized GeoTIFF) tiling.\n- **Analysis Tools:** Client-side spectral analysis (NDVI calculator) on the item detail page.\n","path":null,"size_bytes":4763,"size_tokens":null},"postcss.config.js":{"content":"export default {\n  plugins: {\n    tailwindcss: {},\n    autoprefixer: {},\n  },\n}\n","path":null,"size_bytes":80,"size_tokens":null},"replit.md":{"content":"# Voyager Geospatial Search\n\n## Overview\n\nVoyager is a next-generation geospatial search interface for discovering, analyzing, and acquiring satellite imagery and Earth observation data. The application enables users to search using natural language, draw spatial boundaries on interactive maps, and explore satellite imagery with detailed metadata, lineage tracking, and provenance information.\n\n## User Preferences\n\nPreferred communication style: Simple, everyday language.\n\n## System Architecture\n\n### Frontend Architecture\n\n- **Framework**: React 18 with TypeScript, bundled using Vite\n- **Routing**: Wouter for lightweight client-side routing\n- **State Management**: TanStack React Query for server state and caching\n- **UI Components**: shadcn/ui component library built on Radix UI primitives\n- **Styling**: Tailwind CSS v4 with custom theme variables supporting light/dark modes\n- **Mapping**: Leaflet with React-Leaflet for interactive geospatial visualization\n- **Animations**: Framer Motion for UI transitions\n\nThe frontend follows a feature-based organization pattern where search-related components, API hooks, and types are grouped under `client/src/features/search/`.\n\n### Backend Architecture\n\n- **Runtime**: Node.js with Express\n- **Language**: TypeScript with ES modules\n- **API Design**: RESTful endpoints under `/api/` prefix\n- **Database ORM**: Drizzle ORM with PostgreSQL dialect\n- **Session Management**: Express sessions with PostgreSQL store (connect-pg-simple)\n\nThe server uses a storage abstraction layer (`server/storage.ts`) that implements database operations, making it easier to swap storage implementations if needed.\n\n### Data Model\n\nCore entities defined in `shared/schema.ts`:\n- **Users**: Basic authentication with username/password\n- **Satellite Items**: Imagery records with geospatial bounds, metadata, bands, keywords, and properties\n- **Related Items**: Relationships between satellite items (derived from, co-located, etc.)\n- **Provenance Events**: Timeline tracking of data lifecycle (ingestion, processing, archival)\n- **Saved Searches**: User-saved query configurations with notification preferences\n\nThe schema uses JSONB for flexible metadata storage and text arrays for tags, keywords, and spectral bands.\n\n### Key Design Decisions\n\n1. **Unified Search with Intent Detection**: The search bar parses natural language to distinguish between keywords (e.g., \"vegetation\") and locations (e.g., \"California\"), providing visual feedback through badges.\n\n2. **Map-Centric Interface**: The application tightly couples list results with an interactive map, allowing users to draw bounding boxes, points, or polygons for spatial filtering.\n\n3. **Shared Schema**: Types and validation schemas are defined once in `shared/schema.ts` using Drizzle and Zod, ensuring consistency between frontend and backend.\n\n4. **Theme System**: Custom CSS variables enable seamless light/dark mode switching with geospatial-appropriate color palettes.\n\n## External Dependencies\n\n### Database\n- **PostgreSQL**: Primary data store, connection via `DATABASE_URL` environment variable\n- **Drizzle Kit**: Database migrations and schema management\n\n### Frontend Libraries\n- **Leaflet**: Open-source mapping library for interactive map components\n- **React-Leaflet**: React bindings for Leaflet\n- **Radix UI**: Accessible, unstyled component primitives\n- **TanStack Query**: Data fetching and caching\n\n### Build Tools\n- **Vite**: Development server and production bundler\n- **esbuild**: Server-side bundling for production\n- **TypeScript**: Type checking across the entire codebase\n\n### Fonts\n- **Inter**: Primary sans-serif font for body text\n- **Space Grotesk**: Display font for headings (loaded via Google Fonts)","path":null,"size_bytes":3731,"size_tokens":null},"client/src/components/ui/toast.tsx":{"content":"import * as React from \"react\"\nimport * as ToastPrimitives from \"@radix-ui/react-toast\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ToastProvider = ToastPrimitives.Provider\n\nconst ToastViewport = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Viewport>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Viewport>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Viewport\n    ref={ref}\n    className={cn(\n      \"fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]\",\n      className\n    )}\n    {...props}\n  />\n))\nToastViewport.displayName = ToastPrimitives.Viewport.displayName\n\nconst toastVariants = cva(\n  \"group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full\",\n  {\n    variants: {\n      variant: {\n        default: \"border bg-background text-foreground\",\n        destructive:\n          \"destructive group border-destructive bg-destructive text-destructive-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Toast = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Root> &\n    VariantProps<typeof toastVariants>\n>(({ className, variant, ...props }, ref) => {\n  return (\n    <ToastPrimitives.Root\n      ref={ref}\n      className={cn(toastVariants({ variant }), className)}\n      {...props}\n    />\n  )\n})\nToast.displayName = ToastPrimitives.Root.displayName\n\nconst ToastAction = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Action>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Action>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Action\n    ref={ref}\n    className={cn(\n      \"inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive\",\n      className\n    )}\n    {...props}\n  />\n))\nToastAction.displayName = ToastPrimitives.Action.displayName\n\nconst ToastClose = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Close>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Close>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Close\n    ref={ref}\n    className={cn(\n      \"absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600\",\n      className\n    )}\n    toast-close=\"\"\n    {...props}\n  >\n    <X className=\"h-4 w-4\" />\n  </ToastPrimitives.Close>\n))\nToastClose.displayName = ToastPrimitives.Close.displayName\n\nconst ToastTitle = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Title>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Title>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Title\n    ref={ref}\n    className={cn(\"text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nToastTitle.displayName = ToastPrimitives.Title.displayName\n\nconst ToastDescription = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Description>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Description>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Description\n    ref={ref}\n    className={cn(\"text-sm opacity-90\", className)}\n    {...props}\n  />\n))\nToastDescription.displayName = ToastPrimitives.Description.displayName\n\ntype ToastProps = React.ComponentPropsWithoutRef<typeof Toast>\n\ntype ToastActionElement = React.ReactElement<typeof ToastAction>\n\nexport {\n  type ToastProps,\n  type ToastActionElement,\n  ToastProvider,\n  ToastViewport,\n  Toast,\n  ToastTitle,\n  ToastDescription,\n  ToastClose,\n  ToastAction,\n}\n","path":null,"size_bytes":4845,"size_tokens":null},"client/src/components/ui/menubar.tsx":{"content":"import * as React from \"react\"\nimport * as MenubarPrimitive from \"@radix-ui/react-menubar\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction MenubarMenu({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Menu>) {\n  return <MenubarPrimitive.Menu {...props} />\n}\n\nfunction MenubarGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Group>) {\n  return <MenubarPrimitive.Group {...props} />\n}\n\nfunction MenubarPortal({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Portal>) {\n  return <MenubarPrimitive.Portal {...props} />\n}\n\nfunction MenubarRadioGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.RadioGroup>) {\n  return <MenubarPrimitive.RadioGroup {...props} />\n}\n\nfunction MenubarSub({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Sub>) {\n  return <MenubarPrimitive.Sub data-slot=\"menubar-sub\" {...props} />\n}\n\nconst Menubar = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"flex h-9 items-center space-x-1 rounded-md border bg-background p-1 shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubar.displayName = MenubarPrimitive.Root.displayName\n\nconst MenubarTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-3 py-1 text-sm font-medium outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarTrigger.displayName = MenubarPrimitive.Trigger.displayName\n\nconst MenubarSubTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <MenubarPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </MenubarPrimitive.SubTrigger>\n))\nMenubarSubTrigger.displayName = MenubarPrimitive.SubTrigger.displayName\n\nconst MenubarSubContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarSubContent.displayName = MenubarPrimitive.SubContent.displayName\n\nconst MenubarContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Content>\n>(\n  (\n    { className, align = \"start\", alignOffset = -4, sideOffset = 8, ...props },\n    ref\n  ) => (\n    <MenubarPrimitive.Portal>\n      <MenubarPrimitive.Content\n        ref={ref}\n        align={align}\n        alignOffset={alignOffset}\n        sideOffset={sideOffset}\n        className={cn(\n          \"z-50 min-w-[12rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n          className\n        )}\n        {...props}\n      />\n    </MenubarPrimitive.Portal>\n  )\n)\nMenubarContent.displayName = MenubarPrimitive.Content.displayName\n\nconst MenubarItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarItem.displayName = MenubarPrimitive.Item.displayName\n\nconst MenubarCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <MenubarPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.CheckboxItem>\n))\nMenubarCheckboxItem.displayName = MenubarPrimitive.CheckboxItem.displayName\n\nconst MenubarRadioItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <MenubarPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Circle className=\"h-4 w-4 fill-current\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.RadioItem>\n))\nMenubarRadioItem.displayName = MenubarPrimitive.RadioItem.displayName\n\nconst MenubarLabel = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarLabel.displayName = MenubarPrimitive.Label.displayName\n\nconst MenubarSeparator = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nMenubarSeparator.displayName = MenubarPrimitive.Separator.displayName\n\nconst MenubarShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nMenubarShortcut.displayname = \"MenubarShortcut\"\n\nexport {\n  Menubar,\n  MenubarMenu,\n  MenubarTrigger,\n  MenubarContent,\n  MenubarItem,\n  MenubarSeparator,\n  MenubarLabel,\n  MenubarCheckboxItem,\n  MenubarRadioGroup,\n  MenubarRadioItem,\n  MenubarPortal,\n  MenubarSubContent,\n  MenubarSubTrigger,\n  MenubarGroup,\n  MenubarSub,\n  MenubarShortcut,\n}\n","path":null,"size_bytes":8608,"size_tokens":null},"client/src/components/ui/button.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\" +\n\" hover-elevate active-elevate-2\",\n  {\n    variants: {\n      variant: {\n        default:\n           // @replit: no hover, and add primary border\n           \"bg-primary text-primary-foreground border border-primary-border\",\n        destructive:\n          \"bg-destructive text-destructive-foreground shadow-sm border-destructive-border\",\n        outline:\n          // @replit Shows the background color of whatever card / sidebar / accent background it is inside of.\n          // Inherits the current text color. Uses shadow-xs. no shadow on active\n          // No hover state\n          \" border [border-color:var(--button-outline)] shadow-xs active:shadow-none \",\n        secondary:\n          // @replit border, no hover, no shadow, secondary border.\n          \"border bg-secondary text-secondary-foreground border border-secondary-border \",\n        // @replit no hover, transparent border\n        ghost: \"border border-transparent\",\n        link: \"text-primary underline-offset-4 hover:underline\",\n      },\n      size: {\n        // @replit changed sizes\n        default: \"min-h-9 px-4 py-2\",\n        sm: \"min-h-8 rounded-md px-3 text-xs\",\n        lg: \"min-h-10 rounded-md px-8\",\n        icon: \"h-9 w-9\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof buttonVariants> {\n  asChild?: boolean\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : \"button\"\n    return (\n      <Comp\n        className={cn(buttonVariants({ variant, size, className }))}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nButton.displayName = \"Button\"\n\nexport { Button, buttonVariants }\n","path":null,"size_bytes":2356,"size_tokens":null},"client/src/components/ui/sonner.tsx":{"content":"\"use client\"\n\nimport { useTheme } from \"next-themes\"\nimport { Toaster as Sonner } from \"sonner\"\n\ntype ToasterProps = React.ComponentProps<typeof Sonner>\n\nconst Toaster = ({ ...props }: ToasterProps) => {\n  const { theme = \"system\" } = useTheme()\n\n  return (\n    <Sonner\n      theme={theme as ToasterProps[\"theme\"]}\n      className=\"toaster group\"\n      toastOptions={{\n        classNames: {\n          toast:\n            \"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg\",\n          description: \"group-[.toast]:text-muted-foreground\",\n          actionButton:\n            \"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground\",\n          cancelButton:\n            \"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground\",\n        },\n      }}\n      {...props}\n    />\n  )\n}\n\nexport { Toaster }\n","path":null,"size_bytes":894,"size_tokens":null},"client/src/components/ui/resizable.tsx":{"content":"\"use client\"\n\nimport { GripVertical } from \"lucide-react\"\nimport * as ResizablePrimitive from \"react-resizable-panels\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ResizablePanelGroup = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelGroup>) => (\n  <ResizablePrimitive.PanelGroup\n    className={cn(\n      \"flex h-full w-full data-[panel-group-direction=vertical]:flex-col\",\n      className\n    )}\n    {...props}\n  />\n)\n\nconst ResizablePanel = ResizablePrimitive.Panel\n\nconst ResizableHandle = ({\n  withHandle,\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelResizeHandle> & {\n  withHandle?: boolean\n}) => (\n  <ResizablePrimitive.PanelResizeHandle\n    className={cn(\n      \"relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90\",\n      className\n    )}\n    {...props}\n  >\n    {withHandle && (\n      <div className=\"z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border\">\n        <GripVertical className=\"h-2.5 w-2.5\" />\n      </div>\n    )}\n  </ResizablePrimitive.PanelResizeHandle>\n)\n\nexport { ResizablePanelGroup, ResizablePanel, ResizableHandle }\n","path":null,"size_bytes":1723,"size_tokens":null},"client/src/App.tsx":{"content":"import { Switch, Route } from \"wouter\";\nimport { queryClient } from \"./lib/queryClient\";\nimport { QueryClientProvider } from \"@tanstack/react-query\";\nimport { Toaster } from \"@/components/ui/toaster\";\nimport { TooltipProvider } from \"@/components/ui/tooltip\";\nimport { ThemeProvider } from \"@/components/theme-provider\";\nimport NotFound from \"@/pages/not-found\";\nimport LandingPage from \"@/pages/landing-page\";\nimport SearchResultsPage from \"@/pages/search-results-page\";\nimport ItemDetailPage from \"@/pages/item-detail-page\";\nimport \"leaflet/dist/leaflet.css\";\n\nfunction Router() {\n  return (\n    <Switch>\n      <Route path=\"/\" component={LandingPage} />\n      <Route path=\"/search\" component={SearchResultsPage} />\n      <Route path=\"/item/:id\" component={ItemDetailPage} />\n      <Route component={NotFound} />\n    </Switch>\n  );\n}\n\nfunction App() {\n  return (\n    <ThemeProvider defaultTheme=\"dark\" storageKey=\"vite-ui-theme\">\n      <QueryClientProvider client={queryClient}>\n        <TooltipProvider>\n          <Toaster />\n          <Router />\n        </TooltipProvider>\n      </QueryClientProvider>\n    </ThemeProvider>\n  );\n}\n\nexport default App;","path":null,"size_bytes":1153,"size_tokens":null},"client/src/components/theme-provider.tsx":{"content":"import { createContext, useContext, useEffect, useState } from \"react\";\n\ntype Theme = \"dark\" | \"light\" | \"system\";\n\ntype ThemeProviderProps = {\n  children: React.ReactNode;\n  defaultTheme?: Theme;\n  storageKey?: string;\n};\n\ntype ThemeProviderState = {\n  theme: Theme;\n  setTheme: (theme: Theme) => void;\n};\n\nconst initialState: ThemeProviderState = {\n  theme: \"system\",\n  setTheme: () => null,\n};\n\nconst ThemeProviderContext = createContext<ThemeProviderState>(initialState);\n\nexport function ThemeProvider({\n  children,\n  defaultTheme = \"system\",\n  storageKey = \"vite-ui-theme\",\n}: ThemeProviderProps) {\n  const [theme, setTheme] = useState<Theme>(\n    () => (localStorage.getItem(storageKey) as Theme) || defaultTheme\n  );\n\n  useEffect(() => {\n    const root = window.document.documentElement;\n\n    root.classList.remove(\"light\", \"dark\");\n\n    if (theme === \"system\") {\n      const systemTheme = window.matchMedia(\"(prefers-color-scheme: dark)\")\n        .matches\n        ? \"dark\"\n        : \"light\";\n\n      root.classList.add(systemTheme);\n      return;\n    }\n\n    root.classList.add(theme);\n  }, [theme]);\n\n  const value = {\n    theme,\n    setTheme: (theme: Theme) => {\n      localStorage.setItem(storageKey, theme);\n      setTheme(theme);\n    },\n  };\n\n  return (\n    <ThemeProviderContext.Provider value={value}>\n      {children}\n    </ThemeProviderContext.Provider>\n  );\n}\n\nexport const useTheme = () => {\n  const context = useContext(ThemeProviderContext);\n\n  if (context === undefined)\n    throw new Error(\"useTheme must be used within a ThemeProvider\");\n\n  return context;\n};","path":null,"size_bytes":1582,"size_tokens":null},"client/src/components/ui/toaster.tsx":{"content":"import { useToast } from \"@/hooks/use-toast\"\nimport {\n  Toast,\n  ToastClose,\n  ToastDescription,\n  ToastProvider,\n  ToastTitle,\n  ToastViewport,\n} from \"@/components/ui/toast\"\n\nexport function Toaster() {\n  const { toasts } = useToast()\n\n  return (\n    <ToastProvider>\n      {toasts.map(function ({ id, title, description, action, ...props }) {\n        return (\n          <Toast key={id} {...props}>\n            <div className=\"grid gap-1\">\n              {title && <ToastTitle>{title}</ToastTitle>}\n              {description && (\n                <ToastDescription>{description}</ToastDescription>\n              )}\n            </div>\n            {action}\n            <ToastClose />\n          </Toast>\n        )\n      })}\n      <ToastViewport />\n    </ToastProvider>\n  )\n}\n","path":null,"size_bytes":772,"size_tokens":null},"client/src/components/ui/accordion.tsx":{"content":"import * as React from \"react\"\nimport * as AccordionPrimitive from \"@radix-ui/react-accordion\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Accordion = AccordionPrimitive.Root\n\nconst AccordionItem = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <AccordionPrimitive.Item\n    ref={ref}\n    className={cn(\"border-b\", className)}\n    {...props}\n  />\n))\nAccordionItem.displayName = \"AccordionItem\"\n\nconst AccordionTrigger = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Header className=\"flex\">\n    <AccordionPrimitive.Trigger\n      ref={ref}\n      className={cn(\n        \"flex flex-1 items-center justify-between py-4 text-sm font-medium transition-all hover:underline text-left [&[data-state=open]>svg]:rotate-180\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <ChevronDown className=\"h-4 w-4 shrink-0 text-muted-foreground transition-transform duration-200\" />\n    </AccordionPrimitive.Trigger>\n  </AccordionPrimitive.Header>\n))\nAccordionTrigger.displayName = AccordionPrimitive.Trigger.displayName\n\nconst AccordionContent = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Content\n    ref={ref}\n    className=\"overflow-hidden text-sm data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down\"\n    {...props}\n  >\n    <div className={cn(\"pb-4 pt-0\", className)}>{children}</div>\n  </AccordionPrimitive.Content>\n))\nAccordionContent.displayName = AccordionPrimitive.Content.displayName\n\nexport { Accordion, AccordionItem, AccordionTrigger, AccordionContent }\n","path":null,"size_bytes":2001,"size_tokens":null},"client/src/components/ui/aspect-ratio.tsx":{"content":"import * as AspectRatioPrimitive from \"@radix-ui/react-aspect-ratio\"\n\nconst AspectRatio = AspectRatioPrimitive.Root\n\nexport { AspectRatio }\n","path":null,"size_bytes":140,"size_tokens":null},"client/src/pages/landing-page.tsx":{"content":"import { useState } from \"react\";\nimport { useLocation } from \"wouter\";\nimport { motion } from \"framer-motion\";\nimport { Search, MapPin, ArrowRight, Map as MapIcon, LogOut } from \"lucide-react\";\nimport heroBg from \"@assets/generated_images/dark_earth_night_view.png\";\nimport { LocationPicker } from \"@/components/location-picker\";\nimport { ThemeToggle } from \"@/components/theme-toggle\";\nimport { useAuth } from \"@/hooks/useAuth\";\n\nexport default function LandingPage() {\n  const [, setLocation] = useLocation();\n  const { user, isAuthenticated, isLoading } = useAuth();\n  const [query, setQuery] = useState(\"\");\n  const [place, setPlace] = useState(\"\");\n\n  const [isPickerOpen, setIsPickerOpen] = useState(false);\n  const [isLocationFocused, setIsLocationFocused] = useState(false);\n  const [isSearchFocused, setIsSearchFocused] = useState(false);\n\n  const handleSearch = (e: React.FormEvent) => {\n    e.preventDefault();\n    console.log(\"Searching for:\", query, \"in\", place);\n    setLocation(`/search?q=${encodeURIComponent(query)}&loc=${encodeURIComponent(place)}`);\n  };\n\n  const openPicker = () => {\n    setIsPickerOpen(true);\n  };\n\n  const handleLocationSelect = (bounds: string) => {\n    setPlace(bounds);\n  };\n\n  return (\n    <div className=\"min-h-screen w-full bg-background text-foreground overflow-hidden relative selection:bg-primary/30\">\n      {/* Background Asset */}\n      <div \n        className={`absolute inset-0 z-0 pointer-events-none transition-all duration-500 ease-out ${isSearchFocused ? 'opacity-0 dark:opacity-30 scale-105' : 'opacity-0 dark:opacity-100 scale-100'}`}\n        style={{\n          backgroundImage: `url(${heroBg})`,\n          backgroundSize: 'cover',\n          backgroundPosition: 'center',\n        }}\n      />\n      <div className={`absolute inset-0 z-0 bg-background/20 pointer-events-none transition-opacity duration-500 ${isSearchFocused ? 'bg-background/40' : 'bg-background/20'}`} />\n\n      {/* Overlay Grid */}\n      <div className=\"absolute inset-0 bg-[linear-gradient(to_right,#80808012_1px,transparent_1px),linear-gradient(to_bottom,#80808012_1px,transparent_1px)] bg-[size:24px_24px] pointer-events-none z-0\" />\n\n      {/* Navbar */}\n      <nav className=\"relative z-10 w-full px-6 py-6 flex justify-between items-center max-w-7xl mx-auto\">\n        <div className=\"flex items-center gap-2\">\n          <span className=\"font-display font-bold text-3xl tracking-tight\">\n            <span className=\"text-[#3b82f6]\">V</span>\n            <span className=\"text-[#0c3a6d] dark:text-white\">o</span>\n            <span className=\"text-[#3b82f6]\">yager</span>\n          </span>\n        </div>\n        <div className=\"flex items-center gap-4\">\n          {isLoading ? (\n            <div className=\"w-8 h-8 rounded-full bg-muted animate-pulse\" />\n          ) : isAuthenticated && user ? (\n            <div className=\"flex items-center gap-3\">\n              {user.profileImageUrl && (\n                <img \n                  src={user.profileImageUrl} \n                  alt=\"Profile\" \n                  className=\"w-8 h-8 rounded-full object-cover border border-border\"\n                />\n              )}\n              <span className=\"text-sm font-medium hidden sm:inline\">\n                {user.firstName || user.email?.split('@')[0] || 'User'}\n              </span>\n              <a\n                href=\"/api/logout\"\n                className=\"text-sm px-4 py-2 rounded-full bg-black/5 dark:bg-white/5 border border-black/10 dark:border-white/10 hover:bg-black/10 dark:hover:bg-white/10 transition-all font-medium backdrop-blur-sm flex items-center gap-2\"\n                data-testid=\"button-logout\"\n              >\n                <LogOut className=\"w-4 h-4\" />\n                <span className=\"hidden sm:inline\">Sign Out</span>\n              </a>\n            </div>\n          ) : (\n            <a\n              href=\"/api/login\"\n              className=\"text-sm px-4 py-2 rounded-full bg-black/5 dark:bg-white/5 border border-black/10 dark:border-white/10 hover:bg-black/10 dark:hover:bg-white/10 transition-all font-medium backdrop-blur-sm\"\n              data-testid=\"button-login\"\n            >\n              Sign In\n            </a>\n          )}\n          <ThemeToggle />\n        </div>\n      </nav>\n\n      {/* Main Content */}\n      <main className=\"relative z-10 flex flex-col items-center justify-center min-h-[80vh] px-4 w-full max-w-5xl mx-auto\">\n        <motion.div\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          transition={{ duration: 0.8, ease: \"easeOut\" }}\n          className=\"text-center mb-12\"\n        >\n          <h1 className=\"text-5xl md:text-7xl font-display font-bold mb-6 tracking-tight text-foreground drop-shadow-2xl\">\n            Find. Map. Discover.\n          </h1>\n          <p className=\"text-lg md:text-xl text-muted-foreground max-w-2xl mx-auto leading-relaxed\">\n            \n          </p>\n        </motion.div>\n\n        <motion.div\n          initial={{ opacity: 0, scale: 0.95 }}\n          animate={{ opacity: 1, scale: 1 }}\n          transition={{ delay: 0.2, duration: 0.6 }}\n          className=\"w-full max-w-3xl\"\n        >\n          <form onSubmit={handleSearch} className=\"relative group\">\n            <div className={`absolute inset-0 bg-primary/20 rounded-2xl blur-xl transition-opacity duration-500 ${(isSearchFocused || isLocationFocused) ? 'opacity-50' : 'opacity-0 group-hover:opacity-30'}`} />\n            \n            <div className=\"relative flex flex-col md:flex-row items-stretch gap-2\">\n              {/* Keyword Search Bar */}\n              <div className={`flex-1 flex items-center bg-white/80 dark:bg-black/80 backdrop-blur-xl border border-black/10 dark:border-white/10 rounded-2xl p-2 shadow-2xl transition-all duration-300 ${isSearchFocused ? 'border-primary/50 bg-white/90 dark:bg-black/90' : ''}`}>\n                <div className=\"flex items-center flex-1 px-2 relative\">\n                  <label htmlFor=\"keyword-input\" className=\"sr-only\">Search keywords</label>\n                  <div className=\"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground\">\n                    <Search className=\"w-5 h-5\" />\n                  </div>\n                  <input\n                    id=\"keyword-input\"\n                    type=\"text\"\n                    value={query}\n                    onChange={(e) => setQuery(e.target.value)}\n                    onFocus={() => setIsSearchFocused(true)}\n                    onBlur={() => setIsSearchFocused(false)}\n                    placeholder=\"Keywords...\"\n                    className=\"w-full bg-transparent border-none text-base pl-10 pr-3 py-3 text-foreground placeholder:text-muted-foreground/70 focus:outline-none font-medium\"\n                    data-testid=\"input-search-keyword\"\n                    autoFocus\n                    aria-label=\"Search keywords\"\n                  />\n                </div>\n              </div>\n\n              {/* Location Search Bar with Map Controls */}\n              <div className={`flex-1 flex items-center bg-white/80 dark:bg-black/80 backdrop-blur-xl border border-black/10 dark:border-white/10 rounded-2xl p-2 shadow-2xl transition-all duration-300 ${isLocationFocused ? 'border-green-500/50 bg-white/90 dark:bg-black/90' : ''}`}>\n                <div className=\"flex items-center flex-1 px-2 relative\">\n                  <label htmlFor=\"location-input\" className=\"sr-only\">Search location</label>\n                  <div className=\"absolute left-3 top-1/2 -translate-y-1/2 text-green-600 dark:text-green-400\">\n                    <MapPin className=\"w-5 h-5\" />\n                  </div>\n                  <input\n                    id=\"location-input\"\n                    type=\"text\"\n                    value={place}\n                    onChange={(e) => setPlace(e.target.value)}\n                    onFocus={() => setIsLocationFocused(true)}\n                    onBlur={() => setIsLocationFocused(false)}\n                    placeholder=\"Location...\"\n                    className=\"w-full bg-transparent border-none text-base pl-10 pr-3 py-3 text-foreground placeholder:text-muted-foreground/70 focus:outline-none font-medium\"\n                    data-testid=\"input-search-location\"\n                    aria-label=\"Search location\"\n                  />\n                </div>\n\n                {/* Divider */}\n                <div className=\"h-8 w-[1px] bg-black/10 dark:bg-white/10 mx-1\" />\n\n                {/* Map Draw Button */}\n                <button\n                  type=\"button\"\n                  onClick={openPicker}\n                  className={`flex items-center gap-1.5 px-3 py-2 rounded-xl hover:bg-black/5 dark:hover:bg-white/10 transition-colors shrink-0 ${place ? 'text-green-600 dark:text-green-400 bg-green-500/10' : 'text-muted-foreground hover:text-foreground'}`}\n                  title=\"Draw area on map\"\n                  data-testid=\"button-open-map-picker\"\n                >\n                  <MapIcon className=\"w-4 h-4\" />\n                  <span className=\"text-xs font-medium hidden lg:inline\">{place ? 'Area Set' : 'Draw'}</span>\n                  {place && <div className=\"w-1.5 h-1.5 rounded-full bg-green-500 animate-pulse\" />}\n                </button>\n              </div>\n\n              {/* Search Button */}\n              <button \n                type=\"submit\"\n                className=\"p-4 rounded-2xl bg-primary hover:bg-primary/90 text-primary-foreground transition-colors flex items-center justify-center shadow-lg\"\n                data-testid=\"button-search-submit\"\n                title=\"Search\"\n              >\n                <ArrowRight className=\"w-5 h-5\" />\n              </button>\n            </div>\n          </form>\n        </motion.div>\n      </main>\n\n      {/* Footer Details */}\n      <footer className=\"absolute bottom-0 w-full p-6 border-t border-white/5 bg-black/40 backdrop-blur-sm z-10\">\n        <div className=\"max-w-7xl mx-auto flex flex-col md:flex-row justify-between items-center gap-4 text-xs text-muted-foreground\">\n          <div className=\"flex gap-6 font-mono\">\n            <span className=\"flex items-center gap-2\"><span className=\"w-2 h-2 rounded-full bg-green-500\"></span> SYSTEM ONLINE</span>\n            <span>LAT: 34.0522 N</span>\n            <span>LNG: 118.2437 W</span>\n          </div>\n          <div>\n            &copy; 2026 Voyager Search.\n          </div>\n        </div>\n      </footer>\n\n      <LocationPicker \n        isOpen={isPickerOpen} \n        onClose={() => setIsPickerOpen(false)} \n        onSelect={handleLocationSelect} \n      />\n    </div>\n  );\n}","path":null,"size_bytes":10581,"size_tokens":null},"client/src/components/theme-toggle.tsx":{"content":"import { Moon, Sun } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { useTheme } from \"@/components/theme-provider\";\n\nexport function ThemeToggle() {\n  const { theme, setTheme } = useTheme();\n\n  return (\n    <Button\n      variant=\"ghost\"\n      size=\"icon\"\n      onClick={() => setTheme(theme === \"light\" ? \"dark\" : \"light\")}\n      className=\"rounded-full w-8 h-8 bg-background/50 border border-border hover:bg-accent hover:text-accent-foreground\"\n      title=\"Toggle Theme\"\n    >\n      <Sun className=\"h-[1.2rem] w-[1.2rem] rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0\" />\n      <Moon className=\"absolute h-[1.2rem] w-[1.2rem] rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100\" />\n      <span className=\"sr-only\">Toggle theme</span>\n    </Button>\n  );\n}","path":null,"size_bytes":813,"size_tokens":null},"client/src/components/ui/popover.tsx":{"content":"import * as React from \"react\"\nimport * as PopoverPrimitive from \"@radix-ui/react-popover\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Popover = PopoverPrimitive.Root\n\nconst PopoverTrigger = PopoverPrimitive.Trigger\n\nconst PopoverAnchor = PopoverPrimitive.Anchor\n\nconst PopoverContent = React.forwardRef<\n  React.ElementRef<typeof PopoverPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof PopoverPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <PopoverPrimitive.Portal>\n    <PopoverPrimitive.Content\n      ref={ref}\n      align={align}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </PopoverPrimitive.Portal>\n))\nPopoverContent.displayName = PopoverPrimitive.Content.displayName\n\nexport { Popover, PopoverTrigger, PopoverContent, PopoverAnchor }\n","path":null,"size_bytes":1342,"size_tokens":null},"client/src/components/ui/sheet.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SheetPrimitive from \"@radix-ui/react-dialog\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Sheet = SheetPrimitive.Root\n\nconst SheetTrigger = SheetPrimitive.Trigger\n\nconst SheetClose = SheetPrimitive.Close\n\nconst SheetPortal = SheetPrimitive.Portal\n\nconst SheetOverlay = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nSheetOverlay.displayName = SheetPrimitive.Overlay.displayName\n\nconst sheetVariants = cva(\n  \"fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500 data-[state=open]:animate-in data-[state=closed]:animate-out\",\n  {\n    variants: {\n      side: {\n        top: \"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top\",\n        bottom:\n          \"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom\",\n        left: \"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm\",\n        right:\n          \"inset-y-0 right-0 h-full w-3/4 border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm\",\n      },\n    },\n    defaultVariants: {\n      side: \"right\",\n    },\n  }\n)\n\ninterface SheetContentProps\n  extends React.ComponentPropsWithoutRef<typeof SheetPrimitive.Content>,\n    VariantProps<typeof sheetVariants> {}\n\nconst SheetContent = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Content>,\n  SheetContentProps\n>(({ side = \"right\", className, children, ...props }, ref) => (\n  <SheetPortal>\n    <SheetOverlay />\n    <SheetPrimitive.Content\n      ref={ref}\n      className={cn(sheetVariants({ side }), className)}\n      {...props}\n    >\n      <SheetPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </SheetPrimitive.Close>\n      {children}\n    </SheetPrimitive.Content>\n  </SheetPortal>\n))\nSheetContent.displayName = SheetPrimitive.Content.displayName\n\nconst SheetHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetHeader.displayName = \"SheetHeader\"\n\nconst SheetFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetFooter.displayName = \"SheetFooter\"\n\nconst SheetTitle = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold text-foreground\", className)}\n    {...props}\n  />\n))\nSheetTitle.displayName = SheetPrimitive.Title.displayName\n\nconst SheetDescription = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nSheetDescription.displayName = SheetPrimitive.Description.displayName\n\nexport {\n  Sheet,\n  SheetPortal,\n  SheetOverlay,\n  SheetTrigger,\n  SheetClose,\n  SheetContent,\n  SheetHeader,\n  SheetFooter,\n  SheetTitle,\n  SheetDescription,\n}\n","path":null,"size_bytes":4280,"size_tokens":null},"client/src/index.css":{"content":"@import \"tailwindcss\";\n@import \"tw-animate-css\";\n\n@custom-variant dark (&:is(.dark *));\n\n@theme inline {\n  --radius-sm: calc(var(--radius) - 4px);\n  --radius-md: calc(var(--radius) - 2px);\n  --radius-lg: var(--radius);\n  --radius-xl: calc(var(--radius) + 4px);\n  \n  --color-background: hsl(var(--background));\n  --color-foreground: hsl(var(--foreground));\n  --color-card: hsl(var(--card));\n  --color-card-foreground: hsl(var(--card-foreground));\n  --color-popover: hsl(var(--popover));\n  --color-popover-foreground: hsl(var(--popover-foreground));\n  --color-primary: hsl(var(--primary));\n  --color-primary-foreground: hsl(var(--primary-foreground));\n  --color-secondary: hsl(var(--secondary));\n  --color-secondary-foreground: hsl(var(--secondary-foreground));\n  --color-muted: hsl(var(--muted));\n  --color-muted-foreground: hsl(var(--muted-foreground));\n  --color-accent: hsl(var(--accent));\n  --color-accent-foreground: hsl(var(--accent-foreground));\n  --color-destructive: hsl(var(--destructive));\n  --color-destructive-foreground: hsl(var(--destructive-foreground));\n  --color-border: hsl(var(--border));\n  --color-input: hsl(var(--input));\n  --color-ring: hsl(var(--ring));\n  --color-chart-1: hsl(var(--chart-1));\n  --color-chart-2: hsl(var(--chart-2));\n  --color-chart-3: hsl(var(--chart-3));\n  --color-chart-4: hsl(var(--chart-4));\n  --color-chart-5: hsl(var(--chart-5));\n  \n  --font-sans: 'Inter', sans-serif;\n  --font-display: 'Space Grotesk', sans-serif;\n  \n  --radius: 0.5rem;\n}\n\n:root {\n  /* Light Theme (Clean Geospatial) */\n  --background: 210 40% 98%;\n  --foreground: 220 40% 10%;\n\n  --card: 0 0% 100%;\n  --card-foreground: 220 40% 10%;\n\n  --popover: 0 0% 100%;\n  --popover-foreground: 220 40% 10%;\n\n  --primary: 217 91% 60%; /* Logo Blue #3b82f6 */\n  --primary-foreground: 0 0% 100%;\n\n  --secondary: 210 20% 94%;\n  --secondary-foreground: 220 40% 10%;\n\n  --muted: 210 20% 94%;\n  --muted-foreground: 215 15% 45%;\n\n  --accent: 217 30% 90%;\n  --accent-foreground: 217 91% 60%;\n\n  --destructive: 0 84% 60%;\n  --destructive-foreground: 210 40% 98%;\n\n  --border: 214 32% 91%;\n  --input: 214 32% 91%;\n  --ring: 217 91% 60%;\n\n  --chart-1: 217 91% 60%;\n  --chart-2: 210 70% 50%;\n  --chart-3: 280 60% 60%;\n  --chart-4: 32 80% 60%;\n  --chart-5: 340 75% 55%;\n}\n\n.dark {\n  /* Geospatial Dark Theme - Logo Blue Focus */\n  --background: 220 40% 4%;\n  --foreground: 210 40% 98%;\n\n  --card: 220 40% 6%;\n  --card-foreground: 210 40% 98%;\n\n  --popover: 220 40% 6%;\n  --popover-foreground: 210 40% 98%;\n\n  --primary: 217 91% 60%; /* Logo Blue #3b82f6 */\n  --primary-foreground: 220 40% 4%;\n\n  --secondary: 215 25% 20%;\n  --secondary-foreground: 210 40% 98%;\n\n  --muted: 215 25% 20%;\n  --muted-foreground: 215 20% 65%;\n\n  --accent: 217 30% 20%;\n  --accent-foreground: 217 91% 80%;\n\n  --destructive: 0 62% 30%;\n  --destructive-foreground: 210 40% 98%;\n\n  --border: 215 25% 20%;\n  --input: 215 25% 20%;\n  --ring: 217 91% 60%;\n\n  --chart-1: 217 91% 60%;\n  --chart-2: 210 70% 50%;\n  --chart-3: 280 60% 60%;\n  --chart-4: 32 80% 60%;\n  --chart-5: 340 75% 55%;\n}\n\n@layer base {\n  * {\n    @apply border-border;\n  }\n  body {\n    @apply font-sans antialiased bg-background text-foreground;\n  }\n  h1, h2, h3, h4, h5, h6 {\n    @apply font-display;\n  }\n}\n\n@layer utilities {\n  .glass-panel {\n    @apply bg-black/40 backdrop-blur-xl border border-white/10 shadow-2xl;\n  }\n  \n  .text-glow {\n    text-shadow: 0 0 20px rgba(255, 255, 255, 0.5);\n  }\n}","path":null,"size_bytes":3427,"size_tokens":null},"client/src/components/ui/breadcrumb.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Breadcrumb = React.forwardRef<\n  HTMLElement,\n  React.ComponentPropsWithoutRef<\"nav\"> & {\n    separator?: React.ReactNode\n  }\n>(({ ...props }, ref) => <nav ref={ref} aria-label=\"breadcrumb\" {...props} />)\nBreadcrumb.displayName = \"Breadcrumb\"\n\nconst BreadcrumbList = React.forwardRef<\n  HTMLOListElement,\n  React.ComponentPropsWithoutRef<\"ol\">\n>(({ className, ...props }, ref) => (\n  <ol\n    ref={ref}\n    className={cn(\n      \"flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5\",\n      className\n    )}\n    {...props}\n  />\n))\nBreadcrumbList.displayName = \"BreadcrumbList\"\n\nconst BreadcrumbItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentPropsWithoutRef<\"li\">\n>(({ className, ...props }, ref) => (\n  <li\n    ref={ref}\n    className={cn(\"inline-flex items-center gap-1.5\", className)}\n    {...props}\n  />\n))\nBreadcrumbItem.displayName = \"BreadcrumbItem\"\n\nconst BreadcrumbLink = React.forwardRef<\n  HTMLAnchorElement,\n  React.ComponentPropsWithoutRef<\"a\"> & {\n    asChild?: boolean\n  }\n>(({ asChild, className, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      ref={ref}\n      className={cn(\"transition-colors hover:text-foreground\", className)}\n      {...props}\n    />\n  )\n})\nBreadcrumbLink.displayName = \"BreadcrumbLink\"\n\nconst BreadcrumbPage = React.forwardRef<\n  HTMLSpanElement,\n  React.ComponentPropsWithoutRef<\"span\">\n>(({ className, ...props }, ref) => (\n  <span\n    ref={ref}\n    role=\"link\"\n    aria-disabled=\"true\"\n    aria-current=\"page\"\n    className={cn(\"font-normal text-foreground\", className)}\n    {...props}\n  />\n))\nBreadcrumbPage.displayName = \"BreadcrumbPage\"\n\nconst BreadcrumbSeparator = ({\n  children,\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) => (\n  <li\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"[&>svg]:w-3.5 [&>svg]:h-3.5\", className)}\n    {...props}\n  >\n    {children ?? <ChevronRight />}\n  </li>\n)\nBreadcrumbSeparator.displayName = \"BreadcrumbSeparator\"\n\nconst BreadcrumbEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More</span>\n  </span>\n)\nBreadcrumbEllipsis.displayName = \"BreadcrumbElipssis\"\n\nexport {\n  Breadcrumb,\n  BreadcrumbList,\n  BreadcrumbItem,\n  BreadcrumbLink,\n  BreadcrumbPage,\n  BreadcrumbSeparator,\n  BreadcrumbEllipsis,\n}\n","path":null,"size_bytes":2712,"size_tokens":null},"client/src/components/ui/button-group.tsx":{"content":"import { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Separator } from \"@/components/ui/separator\"\n\nconst buttonGroupVariants = cva(\n  \"flex w-fit items-stretch has-[>[data-slot=button-group]]:gap-2 [&>*]:focus-visible:relative [&>*]:focus-visible:z-10 has-[select[aria-hidden=true]:last-child]:[&>[data-slot=select-trigger]:last-of-type]:rounded-r-md [&>[data-slot=select-trigger]:not([class*='w-'])]:w-fit [&>input]:flex-1\",\n  {\n    variants: {\n      orientation: {\n        horizontal:\n          \"[&>*:not(:first-child)]:rounded-l-none [&>*:not(:first-child)]:border-l-0 [&>*:not(:last-child)]:rounded-r-none\",\n        vertical:\n          \"flex-col [&>*:not(:first-child)]:rounded-t-none [&>*:not(:first-child)]:border-t-0 [&>*:not(:last-child)]:rounded-b-none\",\n      },\n    },\n    defaultVariants: {\n      orientation: \"horizontal\",\n    },\n  }\n)\n\nfunction ButtonGroup({\n  className,\n  orientation,\n  ...props\n}: React.ComponentProps<\"div\"> & VariantProps<typeof buttonGroupVariants>) {\n  return (\n    <div\n      role=\"group\"\n      data-slot=\"button-group\"\n      data-orientation={orientation}\n      className={cn(buttonGroupVariants({ orientation }), className)}\n      {...props}\n    />\n  )\n}\n\nfunction ButtonGroupText({\n  className,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  asChild?: boolean\n}) {\n  const Comp = asChild ? Slot : \"div\"\n\n  return (\n    <Comp\n      className={cn(\n        \"bg-muted shadow-xs flex items-center gap-2 rounded-md border px-4 text-sm font-medium [&_svg:not([class*='size-'])]:size-4 [&_svg]:pointer-events-none\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction ButtonGroupSeparator({\n  className,\n  orientation = \"vertical\",\n  ...props\n}: React.ComponentProps<typeof Separator>) {\n  return (\n    <Separator\n      data-slot=\"button-group-separator\"\n      orientation={orientation}\n      className={cn(\n        \"bg-input relative !m-0 self-stretch data-[orientation=vertical]:h-auto\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport {\n  ButtonGroup,\n  ButtonGroupSeparator,\n  ButtonGroupText,\n  buttonGroupVariants,\n}\n","path":null,"size_bytes":2209,"size_tokens":null},"client/src/components/ui/input-group.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\nimport { Input } from \"@/components/ui/input\"\nimport { Textarea } from \"@/components/ui/textarea\"\n\nfunction InputGroup({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"input-group\"\n      role=\"group\"\n      className={cn(\n        \"group/input-group border-input dark:bg-input/30 shadow-xs relative flex w-full items-center rounded-md border outline-none transition-[color,box-shadow]\",\n        \"h-9 has-[>textarea]:h-auto\",\n\n        // Variants based on alignment.\n        \"has-[>[data-align=inline-start]]:[&>input]:pl-2\",\n        \"has-[>[data-align=inline-end]]:[&>input]:pr-2\",\n        \"has-[>[data-align=block-start]]:h-auto has-[>[data-align=block-start]]:flex-col has-[>[data-align=block-start]]:[&>input]:pb-3\",\n        \"has-[>[data-align=block-end]]:h-auto has-[>[data-align=block-end]]:flex-col has-[>[data-align=block-end]]:[&>input]:pt-3\",\n\n        // Focus state.\n        \"has-[[data-slot=input-group-control]:focus-visible]:ring-ring has-[[data-slot=input-group-control]:focus-visible]:ring-1\",\n\n        // Error state.\n        \"has-[[data-slot][aria-invalid=true]]:ring-destructive/20 has-[[data-slot][aria-invalid=true]]:border-destructive dark:has-[[data-slot][aria-invalid=true]]:ring-destructive/40\",\n\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nconst inputGroupAddonVariants = cva(\n  \"text-muted-foreground flex h-auto cursor-text select-none items-center justify-center gap-2 py-1.5 text-sm font-medium group-data-[disabled=true]/input-group:opacity-50 [&>kbd]:rounded-[calc(var(--radius)-5px)] [&>svg:not([class*='size-'])]:size-4\",\n  {\n    variants: {\n      align: {\n        \"inline-start\":\n          \"order-first pl-3 has-[>button]:ml-[-0.45rem] has-[>kbd]:ml-[-0.35rem]\",\n        \"inline-end\":\n          \"order-last pr-3 has-[>button]:mr-[-0.4rem] has-[>kbd]:mr-[-0.35rem]\",\n        \"block-start\":\n          \"[.border-b]:pb-3 order-first w-full justify-start px-3 pt-3 group-has-[>input]/input-group:pt-2.5\",\n        \"block-end\":\n          \"[.border-t]:pt-3 order-last w-full justify-start px-3 pb-3 group-has-[>input]/input-group:pb-2.5\",\n      },\n    },\n    defaultVariants: {\n      align: \"inline-start\",\n    },\n  }\n)\n\nfunction InputGroupAddon({\n  className,\n  align = \"inline-start\",\n  ...props\n}: React.ComponentProps<\"div\"> & VariantProps<typeof inputGroupAddonVariants>) {\n  return (\n    <div\n      role=\"group\"\n      data-slot=\"input-group-addon\"\n      data-align={align}\n      className={cn(inputGroupAddonVariants({ align }), className)}\n      onClick={(e) => {\n        if ((e.target as HTMLElement).closest(\"button\")) {\n          return\n        }\n        e.currentTarget.parentElement?.querySelector(\"input\")?.focus()\n      }}\n      {...props}\n    />\n  )\n}\n\nconst inputGroupButtonVariants = cva(\n  \"flex items-center gap-2 text-sm shadow-none\",\n  {\n    variants: {\n      size: {\n        xs: \"h-6 gap-1 rounded-[calc(var(--radius)-5px)] px-2 has-[>svg]:px-2 [&>svg:not([class*='size-'])]:size-3.5\",\n        sm: \"h-8 gap-1.5 rounded-md px-2.5 has-[>svg]:px-2.5\",\n        \"icon-xs\":\n          \"size-6 rounded-[calc(var(--radius)-5px)] p-0 has-[>svg]:p-0\",\n        \"icon-sm\": \"size-8 p-0 has-[>svg]:p-0\",\n      },\n    },\n    defaultVariants: {\n      size: \"xs\",\n    },\n  }\n)\n\nfunction InputGroupButton({\n  className,\n  type = \"button\",\n  variant = \"ghost\",\n  size = \"xs\",\n  ...props\n}: Omit<React.ComponentProps<typeof Button>, \"size\"> &\n  VariantProps<typeof inputGroupButtonVariants>) {\n  return (\n    <Button\n      type={type}\n      data-size={size}\n      variant={variant}\n      className={cn(inputGroupButtonVariants({ size }), className)}\n      {...props}\n    />\n  )\n}\n\nfunction InputGroupText({ className, ...props }: React.ComponentProps<\"span\">) {\n  return (\n    <span\n      className={cn(\n        \"text-muted-foreground flex items-center gap-2 text-sm [&_svg:not([class*='size-'])]:size-4 [&_svg]:pointer-events-none\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction InputGroupInput({\n  className,\n  ...props\n}: React.ComponentProps<\"input\">) {\n  return (\n    <Input\n      data-slot=\"input-group-control\"\n      className={cn(\n        \"flex-1 rounded-none border-0 bg-transparent shadow-none focus-visible:ring-0 dark:bg-transparent\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction InputGroupTextarea({\n  className,\n  ...props\n}: React.ComponentProps<\"textarea\">) {\n  return (\n    <Textarea\n      data-slot=\"input-group-control\"\n      className={cn(\n        \"flex-1 resize-none rounded-none border-0 bg-transparent py-3 shadow-none focus-visible:ring-0 dark:bg-transparent\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport {\n  InputGroup,\n  InputGroupAddon,\n  InputGroupButton,\n  InputGroupText,\n  InputGroupInput,\n  InputGroupTextarea,\n}\n","path":null,"size_bytes":4971,"size_tokens":null},"client/src/components/ui/radio-group.tsx":{"content":"import * as React from \"react\"\nimport * as RadioGroupPrimitive from \"@radix-ui/react-radio-group\"\nimport { Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst RadioGroup = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Root\n      className={cn(\"grid gap-2\", className)}\n      {...props}\n      ref={ref}\n    />\n  )\n})\nRadioGroup.displayName = RadioGroupPrimitive.Root.displayName\n\nconst RadioGroupItem = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Item>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        \"aspect-square h-4 w-4 rounded-full border border-primary text-primary shadow focus:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    >\n      <RadioGroupPrimitive.Indicator className=\"flex items-center justify-center\">\n        <Circle className=\"h-3.5 w-3.5 fill-primary\" />\n      </RadioGroupPrimitive.Indicator>\n    </RadioGroupPrimitive.Item>\n  )\n})\nRadioGroupItem.displayName = RadioGroupPrimitive.Item.displayName\n\nexport { RadioGroup, RadioGroupItem }\n","path":null,"size_bytes":1410,"size_tokens":null},"client/src/components/ui/separator.tsx":{"content":"import * as React from \"react\"\nimport * as SeparatorPrimitive from \"@radix-ui/react-separator\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Separator = React.forwardRef<\n  React.ElementRef<typeof SeparatorPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SeparatorPrimitive.Root>\n>(\n  (\n    { className, orientation = \"horizontal\", decorative = true, ...props },\n    ref\n  ) => (\n    <SeparatorPrimitive.Root\n      ref={ref}\n      decorative={decorative}\n      orientation={orientation}\n      className={cn(\n        \"shrink-0 bg-border\",\n        orientation === \"horizontal\" ? \"h-[1px] w-full\" : \"h-full w-[1px]\",\n        className\n      )}\n      {...props}\n    />\n  )\n)\nSeparator.displayName = SeparatorPrimitive.Root.displayName\n\nexport { Separator }\n","path":null,"size_bytes":756,"size_tokens":null},"client/src/hooks/use-mobile.tsx":{"content":"import * as React from \"react\"\n\nconst MOBILE_BREAKPOINT = 768\n\nexport function useIsMobile() {\n  const [isMobile, setIsMobile] = React.useState<boolean | undefined>(undefined)\n\n  React.useEffect(() => {\n    const mql = window.matchMedia(`(max-width: ${MOBILE_BREAKPOINT - 1}px)`)\n    const onChange = () => {\n      setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    }\n    mql.addEventListener(\"change\", onChange)\n    setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    return () => mql.removeEventListener(\"change\", onChange)\n  }, [])\n\n  return !!isMobile\n}\n","path":null,"size_bytes":565,"size_tokens":null},"client/src/components/ui/item.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Separator } from \"@/components/ui/separator\"\n\nfunction ItemGroup({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      role=\"list\"\n      data-slot=\"item-group\"\n      className={cn(\"group/item-group flex flex-col\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction ItemSeparator({\n  className,\n  ...props\n}: React.ComponentProps<typeof Separator>) {\n  return (\n    <Separator\n      data-slot=\"item-separator\"\n      orientation=\"horizontal\"\n      className={cn(\"my-0\", className)}\n      {...props}\n    />\n  )\n}\n\nconst itemVariants = cva(\n  \"group/item [a]:hover:bg-accent/50 focus-visible:border-ring focus-visible:ring-ring/50 [a]:transition-colors flex flex-wrap items-center rounded-md border border-transparent text-sm outline-none transition-colors duration-100 focus-visible:ring-[3px]\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-transparent\",\n        outline: \"border-border\",\n        muted: \"bg-muted/50\",\n      },\n      size: {\n        default: \"gap-4 p-4 \",\n        sm: \"gap-2.5 px-4 py-3\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nfunction Item({\n  className,\n  variant = \"default\",\n  size = \"default\",\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"div\"> &\n  VariantProps<typeof itemVariants> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"div\"\n  return (\n    <Comp\n      data-slot=\"item\"\n      data-variant={variant}\n      data-size={size}\n      className={cn(itemVariants({ variant, size, className }))}\n      {...props}\n    />\n  )\n}\n\nconst itemMediaVariants = cva(\n  \"flex shrink-0 items-center justify-center gap-2 group-has-[[data-slot=item-description]]/item:translate-y-0.5 group-has-[[data-slot=item-description]]/item:self-start [&_svg]:pointer-events-none\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-transparent\",\n        icon: \"bg-muted size-8 rounded-sm border [&_svg:not([class*='size-'])]:size-4\",\n        image:\n          \"size-10 overflow-hidden rounded-sm [&_img]:size-full [&_img]:object-cover\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nfunction ItemMedia({\n  className,\n  variant = \"default\",\n  ...props\n}: React.ComponentProps<\"div\"> & VariantProps<typeof itemMediaVariants>) {\n  return (\n    <div\n      data-slot=\"item-media\"\n      data-variant={variant}\n      className={cn(itemMediaVariants({ variant, className }))}\n      {...props}\n    />\n  )\n}\n\nfunction ItemContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"item-content\"\n      className={cn(\n        \"flex flex-1 flex-col gap-1 [&+[data-slot=item-content]]:flex-none\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction ItemTitle({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"item-title\"\n      className={cn(\n        \"flex w-fit items-center gap-2 text-sm font-medium leading-snug\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction ItemDescription({ className, ...props }: React.ComponentProps<\"p\">) {\n  return (\n    <p\n      data-slot=\"item-description\"\n      className={cn(\n        \"text-muted-foreground line-clamp-2 text-balance text-sm font-normal leading-normal\",\n        \"[&>a:hover]:text-primary [&>a]:underline [&>a]:underline-offset-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction ItemActions({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"item-actions\"\n      className={cn(\"flex items-center gap-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction ItemHeader({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"item-header\"\n      className={cn(\n        \"flex basis-full items-center justify-between gap-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction ItemFooter({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"item-footer\"\n      className={cn(\n        \"flex basis-full items-center justify-between gap-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Item,\n  ItemMedia,\n  ItemContent,\n  ItemActions,\n  ItemGroup,\n  ItemSeparator,\n  ItemTitle,\n  ItemDescription,\n  ItemHeader,\n  ItemFooter,\n}\n","path":null,"size_bytes":4494,"size_tokens":null},"shared/schema.ts":{"content":"import { sql } from \"drizzle-orm\";\nimport { pgTable, text, varchar, serial, timestamp, jsonb, integer, real, index } from \"drizzle-orm/pg-core\";\nimport { relations } from \"drizzle-orm\";\nimport { createInsertSchema } from \"drizzle-zod\";\nimport { z } from \"zod\";\n\n// Session storage table for Replit Auth\nexport const sessions = pgTable(\n  \"sessions\",\n  {\n    sid: varchar(\"sid\").primaryKey(),\n    sess: jsonb(\"sess\").notNull(),\n    expire: timestamp(\"expire\").notNull(),\n  },\n  (table) => [index(\"IDX_session_expire\").on(table.expire)],\n);\n\n// Users table for Replit Auth\nexport const users = pgTable(\"users\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  email: varchar(\"email\").unique(),\n  firstName: varchar(\"first_name\"),\n  lastName: varchar(\"last_name\"),\n  profileImageUrl: varchar(\"profile_image_url\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\nexport type UpsertUser = typeof users.$inferInsert;\nexport type User = typeof users.$inferSelect;\n\n// Satellite Imagery Items table\nexport const satelliteItems = pgTable(\"satellite_items\", {\n  id: serial(\"id\").primaryKey(),\n  title: text(\"title\").notNull(),\n  platform: text(\"platform\").notNull(),\n  provider: text(\"provider\").notNull(),\n  acquisitionDate: timestamp(\"acquisition_date\").notNull(),\n  cloudCover: text(\"cloud_cover\"),\n  processingLevel: text(\"processing_level\"),\n  resolution: text(\"resolution\"),\n  format: text(\"format\"),\n  thumbnail: text(\"thumbnail\").notNull(),\n  \n  // Geospatial data (stored as JSON for simplicity, could use PostGIS in production)\n  bounds: jsonb(\"bounds\").notNull().$type<[[number, number], [number, number]]>(),\n  \n  // Location/Region association\n  locationId: text(\"location_id\"),\n  \n  // Metadata\n  metadata: jsonb(\"metadata\").$type<Record<string, string>>(),\n  bands: text(\"bands\").array(),\n  properties: text(\"properties\").array(),\n  keywords: text(\"keywords\").array(),\n  \n  // File info\n  fileSizeMb: integer(\"file_size_mb\").default(850),\n  \n  createdAt: timestamp(\"created_at\").defaultNow(),\n}, (table) => ({\n  platformIdx: index(\"platform_idx\").on(table.platform),\n  dateIdx: index(\"date_idx\").on(table.acquisitionDate),\n  locationIdx: index(\"location_idx\").on(table.locationId),\n}));\n\nexport const insertSatelliteItemSchema = createInsertSchema(satelliteItems).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport type InsertSatelliteItem = z.infer<typeof insertSatelliteItemSchema>;\nexport type SatelliteItem = typeof satelliteItems.$inferSelect;\n\n// Related Items (for lineage tracking)\nexport const relatedItems = pgTable(\"related_items\", {\n  id: serial(\"id\").primaryKey(),\n  itemId: integer(\"item_id\").notNull().references(() => satelliteItems.id, { onDelete: \"cascade\" }),\n  relatedItemId: text(\"related_item_id\").notNull(), // Could be external ID or our ID\n  relatedItemTitle: text(\"related_item_title\").notNull(),\n  relationshipType: text(\"relationship_type\").notNull(), // \"Derived From\", \"Co-located\", \"Next Pass\"\n});\n\nexport const insertRelatedItemSchema = createInsertSchema(relatedItems).omit({\n  id: true,\n});\n\nexport type InsertRelatedItem = z.infer<typeof insertRelatedItemSchema>;\nexport type RelatedItem = typeof relatedItems.$inferSelect;\n\n// Provenance tracking\nexport const provenanceEvents = pgTable(\"provenance_events\", {\n  id: serial(\"id\").primaryKey(),\n  itemId: integer(\"item_id\").notNull().references(() => satelliteItems.id, { onDelete: \"cascade\" }),\n  eventDate: timestamp(\"event_date\").notNull(),\n  system: text(\"system\").notNull(),\n  event: text(\"event\").notNull(),\n  sortOrder: integer(\"sort_order\").notNull(),\n});\n\nexport const insertProvenanceEventSchema = createInsertSchema(provenanceEvents).omit({\n  id: true,\n});\n\nexport type InsertProvenanceEvent = z.infer<typeof insertProvenanceEventSchema>;\nexport type ProvenanceEvent = typeof provenanceEvents.$inferSelect;\n\n// Saved Searches\nexport const savedSearches = pgTable(\"saved_searches\", {\n  id: serial(\"id\").primaryKey(),\n  userId: varchar(\"user_id\").references(() => users.id, { onDelete: \"cascade\" }),\n  name: text(\"name\").notNull(),\n  keyword: text(\"keyword\"),\n  location: text(\"location\"),\n  dateFrom: timestamp(\"date_from\"),\n  dateTo: timestamp(\"date_to\"),\n  locationIds: text(\"location_ids\").array(),\n  keywords: text(\"keywords\").array(),\n  properties: text(\"properties\").array(),\n  spatialFilter: jsonb(\"spatial_filter\"),\n  notifyOnNewResults: integer(\"notify_on_new_results\").default(1), // 1 = true, 0 = false (using integer for simplicity)\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const insertSavedSearchSchema = createInsertSchema(savedSearches).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport type InsertSavedSearch = z.infer<typeof insertSavedSearchSchema>;\nexport type SavedSearch = typeof savedSearches.$inferSelect;\n\n// Relations\nexport const satelliteItemsRelations = relations(satelliteItems, ({ many }) => ({\n  relatedItems: many(relatedItems),\n  provenanceEvents: many(provenanceEvents),\n}));\n\nexport const relatedItemsRelations = relations(relatedItems, ({ one }) => ({\n  item: one(satelliteItems, {\n    fields: [relatedItems.itemId],\n    references: [satelliteItems.id],\n  }),\n}));\n\nexport const provenanceEventsRelations = relations(provenanceEvents, ({ one }) => ({\n  item: one(satelliteItems, {\n    fields: [provenanceEvents.itemId],\n    references: [satelliteItems.id],\n  }),\n}));\n\nexport const savedSearchesRelations = relations(savedSearches, ({ one }) => ({\n  user: one(users, {\n    fields: [savedSearches.userId],\n    references: [users.id],\n  }),\n}));\n","path":null,"size_bytes":5580,"size_tokens":null},"client/src/components/ui/spinner.tsx":{"content":"import { Loader2Icon } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Spinner({ className, ...props }: React.ComponentProps<\"svg\">) {\n  return (\n    <Loader2Icon\n      role=\"status\"\n      aria-label=\"Loading\"\n      className={cn(\"size-4 animate-spin\", className)}\n      {...props}\n    />\n  )\n}\n\nexport { Spinner }\n","path":null,"size_bytes":331,"size_tokens":null},"client/src/pages/item-detail-page.tsx":{"content":"import { useState } from \"react\";\nimport { useLocation, useRoute } from \"wouter\";\nimport { motion, AnimatePresence } from \"framer-motion\";\nimport { ArrowLeft, Calendar, Layers, Download, Share2, ExternalLink, Info, Globe, Cloud, Clock, Database, Tag, Check, Map as MapIcon, X, PanelRightOpen, PanelRightClose } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\nimport { ThemeToggle } from \"@/components/theme-toggle\";\nimport { LatLngBoundsExpression } from \"leaflet\";\nimport { MapContainer, TileLayer, Rectangle, ImageOverlay } from 'react-leaflet';\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from \"@/components/ui/table\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { useTheme } from \"@/components/theme-provider\";\nimport { toast } from \"sonner\";\n\n// Reusing Mock Data logic (in a real app this would come from an API or store)\nconst MOCK_RESULTS = [\n  {\n    id: 1,\n    title: \"Sentinel-2B MSI Level-2A\",\n    date: \"2024-03-15\",\n    cloudCover: \"12%\",\n    platform: \"Sentinel-2\",\n    provider: \"ESA\",\n    thumbnail: \"https://images.unsplash.com/photo-1451187580459-43490279c0fa?q=80&w=300&auto=format&fit=crop\",\n    bounds: [[34.0, -118.3], [34.1, -118.2]] as LatLngBoundsExpression,\n    description: \"Sentinel-2B is an Earth observation satellite from the Copernicus Programme that systematically acquires optical imagery at high spatial resolution (10 m to 60 m) over land and coastal waters. The mission is a constellation with two twin satellites, Sentinel-2A and Sentinel-2B.\",\n    processingLevel: \"Level-2A\",\n    resolution: \"10m\",\n    bands: [\"B1\", \"B2\", \"B3\", \"B4\", \"B5\", \"B6\", \"B7\", \"B8\", \"B8A\", \"B9\", \"B11\", \"B12\"],\n    tags: [\"Optical\", \"Multispectral\", \"Land Monitoring\", \"Vegetation\"],\n    metadata: {\n        \"Last Indexed\": \"2025-10-07T15:04:56.684Z\",\n        \"Format Category\": \"GIS\",\n        \"Format\": \"GeoTIFF\",\n        \"Spatial Reference\": \"WGS 84 / UTM zone 11N\",\n        \"Field Name\": \"bands\",\n        \"Agent\": \"h1999a1216a1\",\n        \"Driver\": \"GTiff/GeoTIFF\",\n        \"Field Count\": \"12\",\n        \"Field Type\": \"Integer\",\n        \"Format Acronym\": \"GTiff\",\n        \"Format Keyword\": \"Raster\",\n        \"Format Type\": \"File\",\n        \"Agent Extract\": \"h1999a1216a1\"\n    },\n    relationships: [\n      { type: \"Derived From\", title: \"Sentinel-2B L1C Source\", id: \"S2B_MSIL1C_20240315\" },\n      { type: \"Co-located\", title: \"Landsat 9 Scene (Same Date)\", id: \"LC09_L1TP_042036_20240315\" },\n      { type: \"Next Pass\", title: \"Sentinel-2A (5 days later)\", id: \"S2A_MSIL2A_20240320\" }\n    ],\n    provenance: [\n        { date: \"2024-03-15T10:23:00Z\", system: \"Sentinel-2B\", event: \"Data Capture\" },\n        { date: \"2024-03-15T10:45:00Z\", system: \"Sentinel-Processor-A\", event: \"Processing L1C\" },\n        { date: \"2024-03-15T11:15:00Z\", system: \"Sen2Cor-2.11\", event: \"Atmospheric Correction\" },\n        { date: \"2024-03-15T11:20:00Z\", system: \"QA-Bot-9000\", event: \"Quality Check Passed\" },\n        { date: \"2024-03-15T11:25:00Z\", system: \"Archive-System\", event: \"Archival\" }\n    ]\n  },\n  // ... (other items would need similar metadata structure, applying generic for now)\n];\n\n// Helper to get item with metadata fallback\nconst getItem = (id: number | null) => {\n    const item = MOCK_RESULTS.find(r => r.id === id) || MOCK_RESULTS[0];\n    if (!item.metadata) {\n        item.metadata = {\n            \"Last Indexed\": \"2025-10-07T15:04:56.684Z\",\n            \"Format Category\": \"GIS\",\n            \"Format\": \"GeoTIFF\",\n            \"Spatial Reference\": \"WGS 84\",\n            \"Driver\": \"GTiff\",\n            \"Resolution\": item.resolution,\n            \"Platform\": item.platform,\n            \"Provider\": item.provider\n        } as any;\n    }\n    if (!item.relationships) {\n        item.relationships = [\n            { type: \"Related\", title: `Similar ${item.platform} Item`, id: `${item.platform}_REL_001` }\n        ] as any;\n    }\n    if (!item.provenance) {\n        item.provenance = [\n            { date: \"2024-03-15T10:00:00Z\", system: \"System\", event: \"Ingestion\" },\n            { date: \"2024-03-15T10:30:00Z\", system: \"Processor-v1\", event: \"Processing\" }\n        ] as any;\n    }\n    return item;\n}\n\nexport default function ItemDetailPage() {\n  const [, params] = useRoute(\"/item/:id\");\n  const [, setLocation] = useLocation();\n  const [isMapOpen, setIsMapOpen] = useState(false);\n  const [showMap, setShowMap] = useState(true);\n  const [mapStyle, setMapStyle] = useState<'streets' | 'satellite'>('streets');\n  const { theme } = useTheme();\n  const isDark = theme === 'dark' || (theme === 'system' && window.matchMedia('(prefers-color-scheme: dark)').matches);\n\n  const id = params?.id ? parseInt(params.id) : null;\n  \n  const item = getItem(id);\n\n  if (!item) return <div>Item not found</div>;\n\n  const handleShare = () => {\n      const url = new URL(window.location.href);\n      url.searchParams.set(\"auth\", \"mock_token_123\");\n      navigator.clipboard.writeText(url.toString());\n      toast.success(\"Link copied to clipboard\", {\n          description: \"Deep link created for authorized users.\"\n      });\n  };\n\n  const handleDownload = async () => {\n      toast.info(\"Preparing download...\", { duration: 1000 });\n      \n      try {\n        // Simulate downloading the file (using thumbnail as proxy)\n        const response = await fetch(item.thumbnail);\n        const blob = await response.blob();\n        const url = window.URL.createObjectURL(blob);\n        const a = document.createElement('a');\n        a.href = url;\n        a.download = `${item.title.replace(/\\s+/g, '_')}.jpg`;\n        document.body.appendChild(a);\n        a.click();\n        window.URL.revokeObjectURL(url);\n        document.body.removeChild(a);\n        \n        toast.success(\"Download started\", {\n            description: `${item.title}.tif (~850 MB)`\n        });\n      } catch (e) {\n        // Fallback\n        toast.success(\"Download started\", {\n            description: `${item.title}.tif (~850 MB)`\n        });\n      }\n  };\n\n  return (\n    <div className=\"flex flex-col h-screen w-full bg-background text-foreground overflow-hidden\">\n      {/* Header */}\n      <header className=\"h-16 border-b border-border bg-background/80 backdrop-blur-md flex items-center px-4 gap-4 z-20 shrink-0 justify-between\">\n        <div className=\"flex items-center gap-4\">\n          <button \n            onClick={() => setLocation(\"/search\")}\n            className=\"p-2 rounded-full hover:bg-muted text-muted-foreground hover:text-foreground transition-colors\"\n          >\n            <ArrowLeft className=\"w-5 h-5\" />\n          </button>\n          \n          <div className=\"flex flex-col\">\n             <h1 className=\"font-display font-bold text-lg leading-none\">{item.title}</h1>\n             <span className=\"text-xs text-muted-foreground font-mono\">{item.id}  {item.date}</span>\n          </div>\n        </div>\n\n        <div className=\"flex items-center gap-3\">\n           <ThemeToggle />\n           <div className=\"w-8 h-8 rounded-full bg-secondary border border-border\" />\n        </div>\n      </header>\n\n      <div className=\"flex-1 flex overflow-hidden\">\n        {/* Left Panel - Details */}\n        <ScrollArea className=\"flex-1 border-r border-border bg-background/50\">\n          <div className=\"p-6 max-w-5xl mx-auto space-y-8 relative\">\n            {/* Map Toggle Button - top right of content */}\n            <Button \n              variant=\"outline\" \n              size=\"sm\"\n              onClick={() => setShowMap(!showMap)}\n              className=\"absolute top-6 right-6 hidden xl:flex gap-1 text-xs z-10\"\n            >\n              <MapIcon className=\"w-3.5 h-3.5\" />\n              {showMap ? <PanelRightClose className=\"w-4 h-4\" /> : <PanelRightOpen className=\"w-4 h-4\" />}\n            </Button>\n            \n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-8\">\n                {/* Hero Image / Preview */}\n                <div className=\"col-span-1 md:col-span-1\">\n                    <div className=\"rounded-xl overflow-hidden border border-border bg-muted relative aspect-square group shadow-lg\">\n                    <img src={item.thumbnail} alt={item.title} className=\"w-full h-full object-cover\" />\n                    </div>\n                    \n                    {/* Sidebar Actions - Download & Share */}\n                    <div className=\"mt-4 space-y-3\">\n                        <div className=\"grid grid-cols-2 gap-2\">\n                            <Button className=\"w-full gap-2\" variant=\"default\" onClick={handleDownload}>\n                                <Download className=\"w-4 h-4\" /> Download\n                            </Button>\n                            <Button variant=\"outline\" className=\"w-full gap-2\" onClick={handleShare}>\n                                <Share2 className=\"w-4 h-4\" /> Share\n                            </Button>\n                        </div>\n                        {!showMap && (\n                             <Button variant=\"outline\" className=\"w-full gap-2\" onClick={() => setIsMapOpen(true)}>\n                                <MapIcon className=\"w-4 h-4\" /> View Extent\n                             </Button>\n                        )}\n                    </div>\n                </div>\n\n                {/* Main Content */}\n                <div className=\"col-span-1 md:col-span-2 space-y-6\">\n                    <div>\n                        <h2 className=\"text-2xl font-display font-bold mb-4\">{item.title}</h2>\n                        <p className=\"text-muted-foreground leading-relaxed text-lg\">\n                            {item.description}\n                        </p>\n                    </div>\n\n                    <Tabs defaultValue=\"details\" className=\"w-full\">\n                        <TabsList className=\"grid w-full grid-cols-3\">\n                            <TabsTrigger value=\"details\">Details</TabsTrigger>\n                            <TabsTrigger value=\"lineage\">Lineage</TabsTrigger>\n                            <TabsTrigger value=\"provenance\">Provenance</TabsTrigger>\n                        </TabsList>\n                        <TabsContent value=\"details\" className=\"mt-4\">\n                            <div className=\"rounded-md border border-border overflow-hidden\">\n                                <Table>\n                                    <TableBody>\n                                        <TableRow className=\"bg-muted/30\">\n                                            <TableCell className=\"font-medium text-muted-foreground w-1/3\">Cloud Cover</TableCell>\n                                            <TableCell>{item.cloudCover}</TableCell>\n                                        </TableRow>\n                                        <TableRow>\n                                            <TableCell className=\"font-medium text-muted-foreground\">Acquisition Date</TableCell>\n                                            <TableCell>{item.date}</TableCell>\n                                        </TableRow>\n                                        <TableRow className=\"bg-muted/30\">\n                                            <TableCell className=\"font-medium text-muted-foreground\">Size</TableCell>\n                                            <TableCell>~850 MB</TableCell>\n                                        </TableRow>\n                                        {Object.entries(item.metadata || {}).map(([key, value], i) => (\n                                            <TableRow key={key} className={i % 2 === 1 ? \"bg-muted/30\" : \"bg-transparent\"}>\n                                                <TableCell className=\"font-medium text-muted-foreground w-1/3\">{key}</TableCell>\n                                                <TableCell>{value as string}</TableCell>\n                                            </TableRow>\n                                        ))}\n                                        <TableRow className=\"bg-muted/30\">\n                                            <TableCell className=\"font-medium text-muted-foreground\">Spectral Bands</TableCell>\n                                            <TableCell>{item.bands.join(\", \")}</TableCell>\n                                        </TableRow>\n                                        <TableRow>\n                                            <TableCell className=\"font-medium text-muted-foreground\">Resolution</TableCell>\n                                            <TableCell>{item.resolution}</TableCell>\n                                        </TableRow>\n                                    </TableBody>\n                                </Table>\n                            </div>\n                        </TabsContent>\n                        <TabsContent value=\"lineage\" className=\"mt-4\">\n                            <div className=\"rounded-md border border-border overflow-hidden\">\n                                <Table>\n                                    <TableHeader>\n                                        <TableRow className=\"bg-muted/30\">\n                                            <TableHead className=\"w-[200px]\">Relationship Type</TableHead>\n                                            <TableHead>Related Item</TableHead>\n                                        </TableRow>\n                                    </TableHeader>\n                                    <TableBody>\n                                        {item.relationships?.map((rel: any, i: number) => (\n                                            <TableRow key={i}>\n                                                <TableCell className=\"font-medium text-muted-foreground\">\n                                                    <Badge variant=\"outline\" className=\"font-normal\">\n                                                        {rel.type}\n                                                    </Badge>\n                                                </TableCell>\n                                                <TableCell>\n                                                    <div \n                                                      className=\"flex flex-col cursor-pointer hover:underline\"\n                                                      onClick={() => setLocation(`/item/1`)}\n                                                    >\n                                                        <span className=\"font-medium text-primary\">{rel.title}</span>\n                                                        <span className=\"text-xs text-muted-foreground font-mono\">{rel.id}</span>\n                                                    </div>\n                                                </TableCell>\n                                            </TableRow>\n                                        ))}\n                                    </TableBody>\n                                </Table>\n                            </div>\n                        </TabsContent>\n                        <TabsContent value=\"provenance\" className=\"mt-4\">\n                            <div className=\"rounded-md border border-border overflow-hidden\">\n                                <Table>\n                                    <TableHeader>\n                                        <TableRow className=\"bg-muted/30\">\n                                            <TableHead>Date</TableHead>\n                                            <TableHead>System / Agent</TableHead>\n                                            <TableHead className=\"text-right\">Event / Modification</TableHead>\n                                        </TableRow>\n                                    </TableHeader>\n                                    <TableBody>\n                                        {item.provenance?.map((prov: any, i: number) => (\n                                            <TableRow key={i}>\n                                                <TableCell className=\"text-muted-foreground text-xs font-mono\">\n                                                    {new Date(prov.date).toLocaleString()}\n                                                </TableCell>\n                                                <TableCell className=\"font-medium\">{prov.system}</TableCell>\n                                                <TableCell className=\"text-right text-muted-foreground\">\n                                                    {prov.event}\n                                                </TableCell>\n                                            </TableRow>\n                                        ))}\n                                    </TableBody>\n                                </Table>\n                            </div>\n                        </TabsContent>\n                    </Tabs>\n                </div>\n            </div>\n          </div>\n        </ScrollArea>\n\n        {/* Right Panel - Context Map */}\n        {showMap && (\n            <div className=\"w-[400px] hidden xl:block border-l border-border bg-muted/10 relative\">\n                <MapContainer \n                    center={item.bounds ? [\n                    ((item.bounds as any)[0][0] + (item.bounds as any)[1][0]) / 2,\n                    ((item.bounds as any)[0][1] + (item.bounds as any)[1][1]) / 2\n                    ] : [34.05, -118.25]} \n                    zoom={10} \n                    style={{ height: '100%', width: '100%' }}\n                    className=\"z-0 bg-muted/20\"\n                >\n                    <TileLayer\n                        attribution={mapStyle === 'streets' \n                        ? '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors &copy; <a href=\"https://carto.com/attributions\">CARTO</a>'\n                        : '&copy; <a href=\"https://www.esri.com/\">Esri</a> &copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors'\n                        }\n                        url={mapStyle === 'streets'\n                        ? (isDark \n                            ? \"https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png\"\n                            : \"https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png\")\n                        : \"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}\"\n                        }\n                    />\n                    <ImageOverlay\n                        url={item.thumbnail}\n                        bounds={item.bounds}\n                        opacity={0.8}\n                    />\n                    <Rectangle \n                        bounds={item.bounds} \n                        pathOptions={{ \n                        color: '#00ffff', \n                        weight: 2, \n                        fillOpacity: 0,\n                        }} \n                    />\n                </MapContainer>\n                \n                {/* Map Style Toggle */}\n                <div className=\"absolute top-4 right-4 z-[400] flex flex-col gap-2\">\n                    <div className=\"bg-background/80 backdrop-blur rounded-lg border border-border p-1 flex flex-col gap-1\">\n                        <button \n                        className={`p-2 hover:bg-muted rounded transition-colors ${mapStyle === 'streets' ? 'bg-primary text-primary-foreground' : 'text-muted-foreground'}`} \n                        title=\"Street Map\"\n                        onClick={() => setMapStyle('streets')}\n                        >\n                        <MapIcon className=\"w-4 h-4\" />\n                        </button>\n                        <button \n                        className={`p-2 hover:bg-muted rounded transition-colors ${mapStyle === 'satellite' ? 'bg-primary text-primary-foreground' : 'text-muted-foreground'}`}\n                        title=\"Satellite Map\"\n                        onClick={() => setMapStyle('satellite')}\n                        >\n                        <Globe className=\"w-4 h-4\" />\n                        </button>\n                    </div>\n                </div>\n\n                <div className=\"absolute bottom-4 right-4 z-[400] bg-background/80 backdrop-blur px-3 py-1.5 rounded-lg border border-border text-xs font-mono text-foreground/70\">\n                Footprint Preview\n                </div>\n            </div>\n        )}\n      </div>\n      \n      <AnimatePresence>\n        {isMapOpen && (\n          <motion.div \n            initial={{opacity: 0}} \n            animate={{opacity: 1}} \n            exit={{opacity: 0}} \n            className=\"fixed inset-0 z-50 bg-background/95 backdrop-blur flex flex-col\"\n          >\n             <div className=\"h-16 border-b border-border flex items-center justify-between px-4 bg-background/50\">\n               <div className=\"flex items-center gap-2\">\n                  <MapIcon className=\"w-5 h-5 text-primary\" />\n                  <h2 className=\"font-display font-bold text-lg\">Extent Preview</h2>\n               </div>\n               <Button variant=\"ghost\" size=\"icon\" onClick={() => setIsMapOpen(false)} className=\"rounded-full hover:bg-muted\">\n                 <X className=\"w-5 h-5\" />\n               </Button>\n             </div>\n             <div className=\"flex-1 relative bg-muted/20\">\n                <MapContainer \n                     center={item.bounds ? [\n                       ((item.bounds as any)[0][0] + (item.bounds as any)[1][0]) / 2,\n                       ((item.bounds as any)[0][1] + (item.bounds as any)[1][1]) / 2\n                     ] : [34.05, -118.25]} \n                     zoom={10} \n                     style={{ height: '100%', width: '100%' }}\n                     className=\"z-0 bg-muted/20\"\n                   >\n                     <TileLayer\n                       attribution={mapStyle === 'streets' \n                         ? '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors &copy; <a href=\"https://carto.com/attributions\">CARTO</a>'\n                         : '&copy; <a href=\"https://www.esri.com/\">Esri</a> &copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors'\n                       }\n                       url={mapStyle === 'streets'\n                         ? (isDark \n                             ? \"https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png\"\n                             : \"https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png\")\n                         : \"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}\"\n                       }\n                     />\n                     <ImageOverlay\n                        url={item.thumbnail}\n                        bounds={item.bounds}\n                        opacity={0.8}\n                     />\n                     <Rectangle \n                        bounds={item.bounds} \n                        pathOptions={{ \n                          color: '#00ffff', \n                          weight: 2, \n                          fillOpacity: 0,\n                          }} \n                     />\n                </MapContainer>\n\n                {/* Map Style Toggle - Full Screen */}\n                <div className=\"absolute top-4 right-4 z-[400] flex flex-col gap-2\">\n                    <div className=\"bg-background/80 backdrop-blur rounded-lg border border-border p-1 flex flex-col gap-1\">\n                        <button \n                        className={`p-2 hover:bg-muted rounded transition-colors ${mapStyle === 'streets' ? 'bg-primary text-primary-foreground' : 'text-muted-foreground'}`} \n                        title=\"Street Map\"\n                        onClick={() => setMapStyle('streets')}\n                        >\n                        <MapIcon className=\"w-4 h-4\" />\n                        </button>\n                        <button \n                        className={`p-2 hover:bg-muted rounded transition-colors ${mapStyle === 'satellite' ? 'bg-primary text-primary-foreground' : 'text-muted-foreground'}`}\n                        title=\"Satellite Map\"\n                        onClick={() => setMapStyle('satellite')}\n                        >\n                        <Globe className=\"w-4 h-4\" />\n                        </button>\n                    </div>\n                </div>\n             </div>\n          </motion.div>\n        )}\n      </AnimatePresence>\n    </div>\n  );\n}","path":null,"size_bytes":24486,"size_tokens":null},"server/routes.ts":{"content":"import type { Express } from \"express\";\nimport { createServer, type Server } from \"http\";\nimport { storage } from \"./storage\";\nimport { insertSatelliteItemSchema, insertSavedSearchSchema } from \"@shared/schema\";\nimport { fromZodError } from \"zod-validation-error\";\nimport { setupAuth, isAuthenticated } from \"./replitAuth\";\n\nexport async function registerRoutes(\n  httpServer: Server,\n  app: Express\n): Promise<Server> {\n  // Setup Replit Auth\n  await setupAuth(app);\n\n  // Auth routes\n  app.get('/api/auth/user', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      res.json(user);\n    } catch (error) {\n      console.error(\"Error fetching user:\", error);\n      res.status(500).json({ message: \"Failed to fetch user\" });\n    }\n  });\n\n  // Search satellite items\n  app.get(\"/api/satellite-items\", async (req, res) => {\n    try {\n      const {\n        keyword,\n        location,\n        locationIds,\n        keywords,\n        properties,\n        dateFrom,\n        dateTo,\n        platform,\n        sortBy,\n        limit,\n        offset\n      } = req.query;\n\n      const filters: any = {};\n      \n      if (keyword) filters.keyword = String(keyword);\n      if (location) filters.location = String(location);\n      if (locationIds) filters.locationIds = Array.isArray(locationIds) ? locationIds : [String(locationIds)];\n      if (keywords) filters.keywords = Array.isArray(keywords) ? keywords : [String(keywords)];\n      if (properties) filters.properties = Array.isArray(properties) ? properties : [String(properties)];\n      if (dateFrom) filters.dateFrom = new Date(String(dateFrom));\n      if (dateTo) filters.dateTo = new Date(String(dateTo));\n      if (platform) filters.platform = String(platform);\n      if (sortBy) filters.sortBy = String(sortBy);\n      if (limit) filters.limit = parseInt(String(limit));\n      if (offset) filters.offset = parseInt(String(offset));\n\n      const items = await storage.searchSatelliteItems(filters);\n      res.json(items);\n    } catch (error) {\n      console.error(\"Error searching satellite items:\", error);\n      res.status(500).json({ error: \"Failed to search satellite items\" });\n    }\n  });\n\n  // Get single satellite item\n  app.get(\"/api/satellite-items/:id\", async (req, res) => {\n    try {\n      const id = parseInt(req.params.id);\n      const item = await storage.getSatelliteItem(id);\n      \n      if (!item) {\n        return res.status(404).json({ error: \"Item not found\" });\n      }\n\n      res.json(item);\n    } catch (error) {\n      console.error(\"Error fetching satellite item:\", error);\n      res.status(500).json({ error: \"Failed to fetch satellite item\" });\n    }\n  });\n\n  // Create satellite item (for admin/testing)\n  app.post(\"/api/satellite-items\", async (req, res) => {\n    try {\n      const validationResult = insertSatelliteItemSchema.safeParse(req.body);\n      \n      if (!validationResult.success) {\n        const validationError = fromZodError(validationResult.error);\n        return res.status(400).json({ error: validationError.message });\n      }\n\n      const item = await storage.createSatelliteItem(validationResult.data);\n      res.status(201).json(item);\n    } catch (error) {\n      console.error(\"Error creating satellite item:\", error);\n      res.status(500).json({ error: \"Failed to create satellite item\" });\n    }\n  });\n\n  // Get related items for lineage\n  app.get(\"/api/satellite-items/:id/related\", async (req, res) => {\n    try {\n      const id = parseInt(req.params.id);\n      const relatedItems = await storage.getRelatedItems(id);\n      res.json(relatedItems);\n    } catch (error) {\n      console.error(\"Error fetching related items:\", error);\n      res.status(500).json({ error: \"Failed to fetch related items\" });\n    }\n  });\n\n  // Get provenance events\n  app.get(\"/api/satellite-items/:id/provenance\", async (req, res) => {\n    try {\n      const id = parseInt(req.params.id);\n      const events = await storage.getProvenanceEvents(id);\n      res.json(events);\n    } catch (error) {\n      console.error(\"Error fetching provenance events:\", error);\n      res.status(500).json({ error: \"Failed to fetch provenance events\" });\n    }\n  });\n\n  // Get saved searches (would need authentication in production)\n  app.get(\"/api/saved-searches\", async (req, res) => {\n    try {\n      // In a real app, get userId from session/auth\n      const userId = req.query.userId as string;\n      \n      if (!userId) {\n        return res.status(400).json({ error: \"userId is required\" });\n      }\n\n      const searches = await storage.getSavedSearches(userId);\n      res.json(searches);\n    } catch (error) {\n      console.error(\"Error fetching saved searches:\", error);\n      res.status(500).json({ error: \"Failed to fetch saved searches\" });\n    }\n  });\n\n  // Create saved search\n  app.post(\"/api/saved-searches\", async (req, res) => {\n    try {\n      const validationResult = insertSavedSearchSchema.safeParse(req.body);\n      \n      if (!validationResult.success) {\n        const validationError = fromZodError(validationResult.error);\n        return res.status(400).json({ error: validationError.message });\n      }\n\n      const search = await storage.createSavedSearch(validationResult.data);\n      res.status(201).json(search);\n    } catch (error) {\n      console.error(\"Error creating saved search:\", error);\n      res.status(500).json({ error: \"Failed to create saved search\" });\n    }\n  });\n\n  // Delete saved search\n  app.delete(\"/api/saved-searches/:id\", async (req, res) => {\n    try {\n      const id = parseInt(req.params.id);\n      await storage.deleteSavedSearch(id);\n      res.status(204).send();\n    } catch (error) {\n      console.error(\"Error deleting saved search:\", error);\n      res.status(500).json({ error: \"Failed to delete saved search\" });\n    }\n  });\n\n  return httpServer;\n}\n","path":null,"size_bytes":5870,"size_tokens":null},"client/src/components/ui/empty.tsx":{"content":"import { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Empty({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"empty\"\n      className={cn(\n        \"flex min-w-0 flex-1 flex-col items-center justify-center gap-6 text-balance rounded-lg border-dashed p-6 text-center md:p-12\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction EmptyHeader({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"empty-header\"\n      className={cn(\n        \"flex max-w-sm flex-col items-center gap-2 text-center\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nconst emptyMediaVariants = cva(\n  \"mb-2 flex shrink-0 items-center justify-center [&_svg]:pointer-events-none [&_svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-transparent\",\n        icon: \"bg-muted text-foreground flex size-10 shrink-0 items-center justify-center rounded-lg [&_svg:not([class*='size-'])]:size-6\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nfunction EmptyMedia({\n  className,\n  variant = \"default\",\n  ...props\n}: React.ComponentProps<\"div\"> & VariantProps<typeof emptyMediaVariants>) {\n  return (\n    <div\n      data-slot=\"empty-icon\"\n      data-variant={variant}\n      className={cn(emptyMediaVariants({ variant, className }))}\n      {...props}\n    />\n  )\n}\n\nfunction EmptyTitle({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"empty-title\"\n      className={cn(\"text-lg font-medium tracking-tight\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction EmptyDescription({ className, ...props }: React.ComponentProps<\"p\">) {\n  return (\n    <div\n      data-slot=\"empty-description\"\n      className={cn(\n        \"text-muted-foreground [&>a:hover]:text-primary text-sm/relaxed [&>a]:underline [&>a]:underline-offset-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction EmptyContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"empty-content\"\n      className={cn(\n        \"flex w-full min-w-0 max-w-sm flex-col items-center gap-4 text-balance text-sm\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Empty,\n  EmptyHeader,\n  EmptyTitle,\n  EmptyDescription,\n  EmptyContent,\n  EmptyMedia,\n}\n","path":null,"size_bytes":2396,"size_tokens":null},"server/seed.ts":{"content":"import { db } from \"./db\";\nimport { satelliteItems, relatedItems, provenanceEvents } from \"@shared/schema\";\n\nasync function seed() {\n  console.log(\"Seeding database with satellite imagery data...\");\n\n  // Sample satellite items representing various locations and platforms\n  const items = await db.insert(satelliteItems).values([\n    {\n      title: \"San Francisco Bay - Landsat 8 OLI/TIRS\",\n      platform: \"Landsat 8\",\n      provider: \"USGS\",\n      acquisitionDate: new Date(\"2024-03-15\"),\n      cloudCover: \"5%\",\n      processingLevel: \"Level-1TP\",\n      resolution: \"30m\",\n      format: \"GeoTIFF\",\n      thumbnail: \"https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=400&h=300&fit=crop\",\n      bounds: [[-122.5, 37.7], [-122.3, 37.9]],\n      locationId: \"san-francisco\",\n      metadata: {\n        \"Scene ID\": \"LC08_L1TP_044034_20240315\",\n        \"Sun Elevation\": \"48.5\",\n        \"Sun Azimuth\": \"142.3\"\n      },\n      bands: [\"Blue\", \"Green\", \"Red\", \"NIR\", \"SWIR1\", \"SWIR2\", \"Thermal\"],\n      properties: [\"Multispectral\", \"High Resolution\", \"Georeferenced\"],\n      keywords: [\"urban\", \"coastal\", \"bay area\", \"california\"],\n      fileSizeMb: 850\n    },\n    {\n      title: \"Amazon Rainforest - Sentinel-2 MSI\",\n      platform: \"Sentinel-2A\",\n      provider: \"ESA\",\n      acquisitionDate: new Date(\"2024-02-20\"),\n      cloudCover: \"12%\",\n      processingLevel: \"Level-2A\",\n      resolution: \"10m\",\n      format: \"JPEG2000\",\n      thumbnail: \"https://images.unsplash.com/photo-1516026672322-bc52d61a55d5?w=400&h=300&fit=crop\",\n      bounds: [[-62.0, -3.5], [-61.5, -3.0]],\n      locationId: \"amazon\",\n      metadata: {\n        \"Tile ID\": \"20LLQ\",\n        \"Processing Baseline\": \"05.09\",\n        \"Cloud Coverage\": \"12.3\"\n      },\n      bands: [\"Blue\", \"Green\", \"Red\", \"Red Edge\", \"NIR\", \"SWIR\"],\n      properties: [\"Multispectral\", \"High Resolution\", \"Atmospheric Correction\"],\n      keywords: [\"forest\", \"tropical\", \"amazon\", \"brazil\", \"vegetation\"],\n      fileSizeMb: 1200\n    },\n    {\n      title: \"Mount Everest - WorldView-3\",\n      platform: \"WorldView-3\",\n      provider: \"Maxar\",\n      acquisitionDate: new Date(\"2024-04-01\"),\n      cloudCover: \"0%\",\n      processingLevel: \"Standard\",\n      resolution: \"0.31m\",\n      format: \"NITF\",\n      thumbnail: \"https://images.unsplash.com/photo-1486870591958-9b9d0d1dda99?w=400&h=300&fit=crop\",\n      bounds: [[86.9, 27.9], [87.0, 28.0]],\n      locationId: \"himalayas\",\n      metadata: {\n        \"Catalog ID\": \"104001005C8D4F00\",\n        \"Off Nadir Angle\": \"15.2\",\n        \"Target Azimuth\": \"85.4\"\n      },\n      bands: [\"Pan\", \"Coastal\", \"Blue\", \"Green\", \"Yellow\", \"Red\", \"Red Edge\", \"NIR1\", \"NIR2\"],\n      properties: [\"Panchromatic\", \"Very High Resolution\", \"Stereo Capable\"],\n      keywords: [\"mountain\", \"himalaya\", \"nepal\", \"snow\", \"terrain\"],\n      fileSizeMb: 2500\n    },\n    {\n      title: \"Sahara Desert - MODIS Terra\",\n      platform: \"Terra\",\n      provider: \"NASA\",\n      acquisitionDate: new Date(\"2024-01-10\"),\n      cloudCover: \"0%\",\n      processingLevel: \"Level-1B\",\n      resolution: \"250m\",\n      format: \"HDF-EOS\",\n      thumbnail: \"https://images.unsplash.com/photo-1509023464722-18d996393ca8?w=400&h=300&fit=crop\",\n      bounds: [[0.0, 20.0], [10.0, 30.0]],\n      locationId: \"sahara\",\n      metadata: {\n        \"Granule ID\": \"MOD021KM.A2024010.1200\",\n        \"Day/Night Flag\": \"Day\"\n      },\n      bands: [\"Red\", \"NIR\", \"Blue\", \"Green\", \"SWIR\"],\n      properties: [\"Multispectral\", \"Wide Coverage\", \"Daily Revisit\"],\n      keywords: [\"desert\", \"sahara\", \"africa\", \"sand\", \"arid\"],\n      fileSizeMb: 450\n    },\n    {\n      title: \"Great Barrier Reef - Landsat 9 OLI-2\",\n      platform: \"Landsat 9\",\n      provider: \"USGS\",\n      acquisitionDate: new Date(\"2024-03-28\"),\n      cloudCover: \"8%\",\n      processingLevel: \"Level-2\",\n      resolution: \"30m\",\n      format: \"GeoTIFF\",\n      thumbnail: \"https://images.unsplash.com/photo-1583212292454-1fe6229603b7?w=400&h=300&fit=crop\",\n      bounds: [[145.5, -18.5], [146.0, -18.0]],\n      locationId: \"great-barrier-reef\",\n      metadata: {\n        \"Scene ID\": \"LC09_L2SP_094071_20240328\",\n        \"Sun Elevation\": \"52.1\",\n        \"Water Vapor\": \"2.3\"\n      },\n      bands: [\"Coastal\", \"Blue\", \"Green\", \"Red\", \"NIR\", \"SWIR1\", \"SWIR2\"],\n      properties: [\"Multispectral\", \"Water Analysis\", \"Surface Reflectance\"],\n      keywords: [\"coral\", \"reef\", \"ocean\", \"australia\", \"marine\"],\n      fileSizeMb: 900\n    },\n    {\n      title: \"Arctic Ice Cap - Sentinel-1 SAR\",\n      platform: \"Sentinel-1B\",\n      provider: \"ESA\",\n      acquisitionDate: new Date(\"2024-02-05\"),\n      cloudCover: \"N/A\",\n      processingLevel: \"Level-1 GRD\",\n      resolution: \"10m\",\n      format: \"GeoTIFF\",\n      thumbnail: \"https://images.unsplash.com/photo-1483664852095-d6cc6870702d?w=400&h=300&fit=crop\",\n      bounds: [[-45.0, 78.0], [-40.0, 80.0]],\n      locationId: \"arctic\",\n      metadata: {\n        \"Product ID\": \"S1B_IW_GRDH_1SDV_20240205\",\n        \"Polarization\": \"VV+VH\",\n        \"Pass Direction\": \"Descending\"\n      },\n      bands: [\"VV\", \"VH\"],\n      properties: [\"SAR\", \"All-Weather\", \"Ice Monitoring\"],\n      keywords: [\"arctic\", \"ice\", \"polar\", \"greenland\", \"glacier\"],\n      fileSizeMb: 1100\n    },\n    {\n      title: \"New York City - SPOT 7\",\n      platform: \"SPOT 7\",\n      provider: \"Airbus\",\n      acquisitionDate: new Date(\"2024-04-10\"),\n      cloudCover: \"3%\",\n      processingLevel: \"Primary\",\n      resolution: \"1.5m\",\n      format: \"DIMAP\",\n      thumbnail: \"https://images.unsplash.com/photo-1496442226666-8d4d0e62e6e9?w=400&h=300&fit=crop\",\n      bounds: [[-74.1, 40.7], [-73.9, 40.9]],\n      locationId: \"new-york\",\n      metadata: {\n        \"Scene ID\": \"DS_SPOT7_202404101533\",\n        \"Incidence Angle\": \"12.5\"\n      },\n      bands: [\"Blue\", \"Green\", \"Red\", \"NIR\"],\n      properties: [\"Multispectral\", \"Very High Resolution\", \"Urban Mapping\"],\n      keywords: [\"urban\", \"city\", \"manhattan\", \"new york\", \"buildings\"],\n      fileSizeMb: 1800\n    },\n    {\n      title: \"Tokyo Bay - ALOS-2 PALSAR-2\",\n      platform: \"ALOS-2\",\n      provider: \"JAXA\",\n      acquisitionDate: new Date(\"2024-03-05\"),\n      cloudCover: \"N/A\",\n      processingLevel: \"Level-1.1\",\n      resolution: \"3m\",\n      format: \"CEOS\",\n      thumbnail: \"https://images.unsplash.com/photo-1540959733332-eab4deabeeaf?w=400&h=300&fit=crop\",\n      bounds: [[139.7, 35.6], [140.0, 35.8]],\n      locationId: \"tokyo\",\n      metadata: {\n        \"Scene ID\": \"ALOS2287580710\",\n        \"Observation Mode\": \"Stripmap\",\n        \"Polarization\": \"HH+HV\"\n      },\n      bands: [\"HH\", \"HV\"],\n      properties: [\"SAR\", \"L-band\", \"High Resolution\"],\n      keywords: [\"urban\", \"city\", \"tokyo\", \"japan\", \"coastal\"],\n      fileSizeMb: 950\n    }\n  ]).returning();\n\n  console.log(`Created ${items.length} satellite items`);\n\n  // Add related items (lineage)\n  if (items.length > 0) {\n    await db.insert(relatedItems).values([\n      {\n        itemId: items[0].id,\n        relatedItemId: \"LC08_L1TP_044034_20240301\",\n        relatedItemTitle: \"San Francisco Bay - Landsat 8 (Previous Pass)\",\n        relationshipType: \"Previous Pass\"\n      },\n      {\n        itemId: items[1].id,\n        relatedItemId: \"S2A_MSIL2A_20240206\",\n        relatedItemTitle: \"Amazon Rainforest - Sentinel-2 (Derived From)\",\n        relationshipType: \"Derived From\"\n      },\n      {\n        itemId: items[4].id,\n        relatedItemId: \"S2B_MSIL1C_20240328\",\n        relatedItemTitle: \"Great Barrier Reef - Sentinel-2 (Co-located)\",\n        relationshipType: \"Co-located\"\n      }\n    ]);\n    console.log(\"Created related items\");\n  }\n\n  // Add provenance events\n  if (items.length > 0) {\n    await db.insert(provenanceEvents).values([\n      // San Francisco item provenance\n      {\n        itemId: items[0].id,\n        eventDate: new Date(\"2024-03-15T10:30:00Z\"),\n        system: \"Landsat 8 OLI/TIRS\",\n        event: \"Raw data capture over San Francisco Bay area\",\n        sortOrder: 1\n      },\n      {\n        itemId: items[0].id,\n        eventDate: new Date(\"2024-03-15T14:00:00Z\"),\n        system: \"USGS Processing System\",\n        event: \"Radiometric calibration and geometric correction applied\",\n        sortOrder: 2\n      },\n      {\n        itemId: items[0].id,\n        eventDate: new Date(\"2024-03-15T16:30:00Z\"),\n        system: \"USGS Archive\",\n        event: \"Level-1TP product generated and archived\",\n        sortOrder: 3\n      },\n      // Amazon item provenance\n      {\n        itemId: items[1].id,\n        eventDate: new Date(\"2024-02-20T11:15:00Z\"),\n        system: \"Sentinel-2A MSI\",\n        event: \"Acquisition over Amazon region\",\n        sortOrder: 1\n      },\n      {\n        itemId: items[1].id,\n        eventDate: new Date(\"2024-02-20T13:45:00Z\"),\n        system: \"ESA Processing Facility\",\n        event: \"Atmospheric correction using Sen2Cor processor\",\n        sortOrder: 2\n      },\n      {\n        itemId: items[1].id,\n        eventDate: new Date(\"2024-02-20T15:00:00Z\"),\n        system: \"Copernicus Data Hub\",\n        event: \"Level-2A product published to catalog\",\n        sortOrder: 3\n      }\n    ]);\n    console.log(\"Created provenance events\");\n  }\n\n  console.log(\"Database seeding completed successfully!\");\n}\n\nseed()\n  .catch((error) => {\n    console.error(\"Error seeding database:\", error);\n    process.exit(1);\n  })\n  .finally(() => {\n    process.exit(0);\n  });\n","path":null,"size_bytes":9343,"size_tokens":null},"client/src/components/ui/table.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Table = React.forwardRef<\n  HTMLTableElement,\n  React.HTMLAttributes<HTMLTableElement>\n>(({ className, ...props }, ref) => (\n  <div className=\"relative w-full overflow-auto\">\n    <table\n      ref={ref}\n      className={cn(\"w-full caption-bottom text-sm\", className)}\n      {...props}\n    />\n  </div>\n))\nTable.displayName = \"Table\"\n\nconst TableHeader = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <thead ref={ref} className={cn(\"[&_tr]:border-b\", className)} {...props} />\n))\nTableHeader.displayName = \"TableHeader\"\n\nconst TableBody = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tbody\n    ref={ref}\n    className={cn(\"[&_tr:last-child]:border-0\", className)}\n    {...props}\n  />\n))\nTableBody.displayName = \"TableBody\"\n\nconst TableFooter = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tfoot\n    ref={ref}\n    className={cn(\n      \"border-t bg-muted/50 font-medium [&>tr]:last:border-b-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableFooter.displayName = \"TableFooter\"\n\nconst TableRow = React.forwardRef<\n  HTMLTableRowElement,\n  React.HTMLAttributes<HTMLTableRowElement>\n>(({ className, ...props }, ref) => (\n  <tr\n    ref={ref}\n    className={cn(\n      \"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nTableRow.displayName = \"TableRow\"\n\nconst TableHead = React.forwardRef<\n  HTMLTableCellElement,\n  React.ThHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <th\n    ref={ref}\n    className={cn(\n      \"h-10 px-2 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]\",\n      className\n    )}\n    {...props}\n  />\n))\nTableHead.displayName = \"TableHead\"\n\nconst TableCell = React.forwardRef<\n  HTMLTableCellElement,\n  React.TdHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <td\n    ref={ref}\n    className={cn(\n      \"p-2 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]\",\n      className\n    )}\n    {...props}\n  />\n))\nTableCell.displayName = \"TableCell\"\n\nconst TableCaption = React.forwardRef<\n  HTMLTableCaptionElement,\n  React.HTMLAttributes<HTMLTableCaptionElement>\n>(({ className, ...props }, ref) => (\n  <caption\n    ref={ref}\n    className={cn(\"mt-4 text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nTableCaption.displayName = \"TableCaption\"\n\nexport {\n  Table,\n  TableHeader,\n  TableBody,\n  TableFooter,\n  TableHead,\n  TableRow,\n  TableCell,\n  TableCaption,\n}\n","path":null,"size_bytes":2859,"size_tokens":null},"client/src/components/location-picker.tsx":{"content":"import { useState, useEffect } from 'react';\nimport { MapContainer, TileLayer, Rectangle, useMapEvents, Pane } from 'react-leaflet';\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription, DialogFooter } from '@/components/ui/dialog';\nimport { Button } from '@/components/ui/button';\nimport { LatLngBounds, LatLng } from 'leaflet';\n\ninterface LocationPickerProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onSelect: (bounds: string) => void;\n}\n\nfunction BoxDrawer({ onBoundsChange }: { onBoundsChange: (bounds: LatLngBounds | null) => void }) {\n  const [startPoint, setStartPoint] = useState<LatLng | null>(null);\n  const [currentPoint, setCurrentPoint] = useState<LatLng | null>(null);\n  const [bounds, setBounds] = useState<LatLngBounds | null>(null);\n\n  useMapEvents({\n    mousedown(e) {\n      // Only start drawing if we use left click and strictly on the map (not controls)\n      // Leaflet handles this mostly, but good to be aware.\n      setStartPoint(e.latlng);\n      setCurrentPoint(e.latlng);\n      setBounds(null);\n      onBoundsChange(null);\n      \n      // Disable map dragging while drawing\n      e.target.dragging.disable();\n    },\n    mousemove(e) {\n      if (startPoint) {\n        setCurrentPoint(e.latlng);\n        const newBounds = new LatLngBounds(startPoint, e.latlng);\n        setBounds(newBounds);\n      }\n    },\n    mouseup(e) {\n      if (startPoint) {\n        const finalBounds = new LatLngBounds(startPoint, e.latlng);\n        setBounds(finalBounds);\n        onBoundsChange(finalBounds);\n        setStartPoint(null);\n        setCurrentPoint(null);\n        \n        // Re-enable map dragging\n        e.target.dragging.enable();\n      }\n    }\n  });\n\n  // Render the rectangle while dragging or if we have a final selection\n  // However, for this simple version, let's just show the dragging one.\n  // The parent can hold the \"final\" one if we wanted to persist it visually, \n  // but here we just want to draw it.\n  \n  // Actually, we should show the rectangle if we have bounds (either dragging or finished)\n  if (bounds) {\n    return <Rectangle bounds={bounds} pathOptions={{ color: '#00ffff', weight: 2, fillOpacity: 0.2 }} />;\n  }\n  \n  return null;\n}\n\nexport function LocationPicker({ isOpen, onClose, onSelect }: LocationPickerProps) {\n  const [selectedBounds, setSelectedBounds] = useState<LatLngBounds | null>(null);\n  const [tempBounds, setTempBounds] = useState<LatLngBounds | null>(null);\n\n  const handleConfirm = () => {\n    // Use tempBounds if we just drew it, or selectedBounds if we had one (logic can be refined)\n    // For now, tempBounds tracks the latest draw action.\n    const boundsToUse = tempBounds || selectedBounds;\n    \n    if (boundsToUse) {\n      const boxString = `[${boundsToUse.getWest().toFixed(4)}, ${boundsToUse.getSouth().toFixed(4)}, ${boundsToUse.getEast().toFixed(4)}, ${boundsToUse.getNorth().toFixed(4)}]`;\n      onSelect(boxString);\n      onClose();\n    }\n  };\n\n  // Reset when opening\n  useEffect(() => {\n    if (isOpen) {\n      setTempBounds(null);\n      setSelectedBounds(null);\n    }\n  }, [isOpen]);\n\n  return (\n    <Dialog open={isOpen} onOpenChange={(open) => !open && onClose()}>\n      <DialogContent className=\"sm:max-w-[800px] bg-background/95 backdrop-blur-xl border-white/10 text-foreground p-0 gap-0 overflow-hidden\">\n        <DialogHeader className=\"p-4 border-b border-white/10\">\n          <DialogTitle>Select Area of Interest</DialogTitle>\n          <DialogDescription>\n            Click and drag on the map to define a bounding box.\n          </DialogDescription>\n        </DialogHeader>\n        \n        <div className=\"h-[500px] w-full relative bg-black/20\">\n           {/* MapContainer needs explicit height. */}\n           {isOpen && (\n             <MapContainer \n               center={[20, 0]} \n               zoom={2} \n               style={{ height: '100%', width: '100%' }}\n               className=\"z-0\"\n             >\n                {/* Dark Matter styled tiles for the \"Voyager\" theme */}\n               <TileLayer\n                 attribution='&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors &copy; <a href=\"https://carto.com/attributions\">CARTO</a>'\n                 url=\"https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png\"\n               />\n               <BoxDrawer onBoundsChange={setTempBounds} />\n               {/* Show the selected bounds if we have one and aren't currently drawing new one (handled by BoxDrawer mostly) */}\n               {/* Actually BoxDrawer handles the visual feedback nicely during draw. */}\n             </MapContainer>\n           )}\n        </div>\n\n        <DialogFooter className=\"p-4 border-t border-white/10 bg-black/20\">\n          <div className=\"flex justify-between w-full items-center\">\n            <div className=\"text-xs font-mono text-muted-foreground\">\n              {tempBounds ? \n                `BBOX: ${tempBounds.getWest().toFixed(2)}, ${tempBounds.getSouth().toFixed(2)}, ${tempBounds.getEast().toFixed(2)}, ${tempBounds.getNorth().toFixed(2)}` \n                : 'No area selected'}\n            </div>\n            <div className=\"flex gap-2\">\n              <Button variant=\"outline\" onClick={onClose} className=\"border-white/10 hover:bg-white/5\">\n                Cancel\n              </Button>\n              <Button \n                onClick={handleConfirm} \n                disabled={!tempBounds}\n                className=\"bg-primary text-primary-foreground hover:bg-primary/90\"\n              >\n                Confirm Area\n              </Button>\n            </div>\n          </div>\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  );\n}","path":null,"size_bytes":5674,"size_tokens":null},"server/vite.ts":{"content":"import { type Express } from \"express\";\nimport { createServer as createViteServer, createLogger } from \"vite\";\nimport { type Server } from \"http\";\nimport viteConfig from \"../vite.config\";\nimport fs from \"fs\";\nimport path from \"path\";\nimport { nanoid } from \"nanoid\";\n\nconst viteLogger = createLogger();\n\nexport async function setupVite(server: Server, app: Express) {\n  const serverOptions = {\n    middlewareMode: true,\n    hmr: { server, path: \"/vite-hmr\" },\n    allowedHosts: true as const,\n  };\n\n  const vite = await createViteServer({\n    ...viteConfig,\n    configFile: false,\n    customLogger: {\n      ...viteLogger,\n      error: (msg, options) => {\n        viteLogger.error(msg, options);\n        process.exit(1);\n      },\n    },\n    server: serverOptions,\n    appType: \"custom\",\n  });\n\n  app.use(vite.middlewares);\n\n  app.use(\"*\", async (req, res, next) => {\n    const url = req.originalUrl;\n\n    try {\n      const clientTemplate = path.resolve(\n        import.meta.dirname,\n        \"..\",\n        \"client\",\n        \"index.html\",\n      );\n\n      // always reload the index.html file from disk incase it changes\n      let template = await fs.promises.readFile(clientTemplate, \"utf-8\");\n      template = template.replace(\n        `src=\"/src/main.tsx\"`,\n        `src=\"/src/main.tsx?v=${nanoid()}\"`,\n      );\n      const page = await vite.transformIndexHtml(url, template);\n      res.status(200).set({ \"Content-Type\": \"text/html\" }).end(page);\n    } catch (e) {\n      vite.ssrFixStacktrace(e as Error);\n      next(e);\n    }\n  });\n}\n","path":null,"size_bytes":1534,"size_tokens":null},"client/src/components/map-draw-control.tsx":{"content":"import { useState, useEffect } from 'react';\nimport { Rectangle, useMapEvents, Marker, Popup, Polygon, Polyline } from 'react-leaflet';\nimport { LatLngBounds, LatLng, Icon } from 'leaflet';\n\n// Fix Leaflet's default icon path issues in React\nimport markerIconPng from \"leaflet/dist/images/marker-icon.png\";\nimport markerIcon2xPng from \"leaflet/dist/images/marker-icon-2x.png\";\nimport markerShadowPng from \"leaflet/dist/images/marker-shadow.png\";\n\nconst defaultIcon = new Icon({\n  iconUrl: markerIconPng,\n  iconRetinaUrl: markerIcon2xPng,\n  shadowUrl: markerShadowPng,\n  iconSize: [25, 41],\n  iconAnchor: [12, 41],\n  popupAnchor: [1, -34],\n  shadowSize: [41, 41]\n});\n\n\ninterface MapDrawControlProps {\n  mode: 'none' | 'box' | 'point' | 'polygon';\n  onDrawBox: (bounds: LatLngBounds) => void;\n  onDrawPoint: (point: LatLng) => void;\n  onDrawPolygon?: (points: LatLng[]) => void;\n}\n\nexport function MapDrawControl({ mode, onDrawBox, onDrawPoint, onDrawPolygon }: MapDrawControlProps) {\n  const [startPoint, setStartPoint] = useState<LatLng | null>(null);\n  const [currentBounds, setCurrentBounds] = useState<LatLngBounds | null>(null);\n  const [polyPoints, setPolyPoints] = useState<LatLng[]>([]);\n\n  // Reset poly points if mode changes\n  useEffect(() => {\n      setPolyPoints([]);\n  }, [mode]);\n\n  const map = useMapEvents({\n    click(e) {\n      if (mode === 'point') {\n        onDrawPoint(e.latlng);\n      } else if (mode === 'polygon') {\n        setPolyPoints(prev => [...prev, e.latlng]);\n      }\n    },\n    dblclick(e) {\n       if (mode === 'polygon') {\n           if (polyPoints.length > 2 && onDrawPolygon) {\n               onDrawPolygon(polyPoints); // Use current points + last double click point if needed, but usually dblclick adds one more point via click event first?\n               // Actually dblclick fires after 2 clicks. Leaflet behavior is tricky.\n               // Let's rely on the points collected so far.\n               setPolyPoints([]);\n           }\n       }\n    },\n    mousedown(e) {\n      if (mode === 'box') {\n        setStartPoint(e.latlng);\n        setCurrentBounds(new LatLngBounds(e.latlng, e.latlng));\n        map.dragging.disable();\n      }\n    },\n    mousemove(e) {\n      if (mode === 'box' && startPoint) {\n        const newBounds = new LatLngBounds(startPoint, e.latlng);\n        setCurrentBounds(newBounds);\n      }\n    },\n    mouseup(e) {\n      if (mode === 'box' && startPoint) {\n        const finalBounds = new LatLngBounds(startPoint, e.latlng);\n        onDrawBox(finalBounds);\n        setStartPoint(null);\n        setCurrentBounds(null);\n        map.dragging.enable();\n      }\n    }\n  });\n\n  if (currentBounds) {\n    return <Rectangle bounds={currentBounds} pathOptions={{ color: '#3b82f6', weight: 2, fillOpacity: 0.2, dashArray: '5, 5' }} />;\n  }\n\n  if (polyPoints.length > 0) {\n      return (\n          <>\n            <Polyline positions={polyPoints} pathOptions={{ color: '#3b82f6', weight: 2, dashArray: '5, 5' }} />\n            {polyPoints.map((p, i) => <Marker key={i} position={p} icon={defaultIcon} />)}\n          </>\n      );\n  }\n\n  return null;\n}\n\ninterface SpatialFilterLayerProps {\n  type: 'box' | 'point' | 'polygon' | null;\n  data: any; // LatLngBounds or LatLng or LatLng[]\n}\n\nexport function SpatialFilterLayer({ type, data }: SpatialFilterLayerProps) {\n  if (!data) return null;\n\n  if (type === 'box') {\n    return (\n      <Rectangle \n        bounds={data} \n        pathOptions={{ color: '#3b82f6', weight: 4, fillOpacity: 0.15 }} \n      />\n    );\n  }\n\n  if (type === 'point') {\n    return (\n      <Marker position={data} icon={defaultIcon}>\n        <Popup>Selected Point</Popup>\n      </Marker>\n    );\n  }\n\n  if (type === 'polygon') {\n      return <Polygon positions={data} pathOptions={{ color: '#3b82f6', weight: 4, fillOpacity: 0.15 }} />\n  }\n\n  return null;\n}","path":null,"size_bytes":3823,"size_tokens":null},"client/src/components/ui/input.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Input = React.forwardRef<HTMLInputElement, React.ComponentProps<\"input\">>(\n  ({ className, type, ...props }, ref) => {\n    return (\n      <input\n        type={type}\n        className={cn(\n          \"flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nInput.displayName = \"Input\"\n\nexport { Input }\n","path":null,"size_bytes":768,"size_tokens":null},"client/src/components/ui/dialog.tsx":{"content":"import * as React from \"react\"\nimport * as DialogPrimitive from \"@radix-ui/react-dialog\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Dialog = DialogPrimitive.Root\n\nconst DialogTrigger = DialogPrimitive.Trigger\n\nconst DialogPortal = DialogPrimitive.Portal\n\nconst DialogClose = DialogPrimitive.Close\n\nconst DialogOverlay = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Overlay\n    ref={ref}\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogOverlay.displayName = DialogPrimitive.Overlay.displayName\n\nconst DialogContent = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DialogPortal>\n    <DialogOverlay />\n    <DialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <DialogPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </DialogPrimitive.Close>\n    </DialogPrimitive.Content>\n  </DialogPortal>\n))\nDialogContent.displayName = DialogPrimitive.Content.displayName\n\nconst DialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-1.5 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogHeader.displayName = \"DialogHeader\"\n\nconst DialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogFooter.displayName = \"DialogFooter\"\n\nconst DialogTitle = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogTitle.displayName = DialogPrimitive.Title.displayName\n\nconst DialogDescription = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDialogDescription.displayName = DialogPrimitive.Description.displayName\n\nexport {\n  Dialog,\n  DialogPortal,\n  DialogOverlay,\n  DialogTrigger,\n  DialogClose,\n  DialogContent,\n  DialogHeader,\n  DialogFooter,\n  DialogTitle,\n  DialogDescription,\n}\n","path":null,"size_bytes":3835,"size_tokens":null},"client/src/components/ui/avatar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as AvatarPrimitive from \"@radix-ui/react-avatar\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Avatar = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full\",\n      className\n    )}\n    {...props}\n  />\n))\nAvatar.displayName = AvatarPrimitive.Root.displayName\n\nconst AvatarImage = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Image>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Image>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Image\n    ref={ref}\n    className={cn(\"aspect-square h-full w-full\", className)}\n    {...props}\n  />\n))\nAvatarImage.displayName = AvatarPrimitive.Image.displayName\n\nconst AvatarFallback = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Fallback>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Fallback>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Fallback\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full items-center justify-center rounded-full bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nAvatarFallback.displayName = AvatarPrimitive.Fallback.displayName\n\nexport { Avatar, AvatarImage, AvatarFallback }\n","path":null,"size_bytes":1419,"size_tokens":null},"client/src/hooks/use-toast.ts":{"content":"import * as React from \"react\"\n\nimport type {\n  ToastActionElement,\n  ToastProps,\n} from \"@/components/ui/toast\"\n\nconst TOAST_LIMIT = 1\nconst TOAST_REMOVE_DELAY = 1000000\n\ntype ToasterToast = ToastProps & {\n  id: string\n  title?: React.ReactNode\n  description?: React.ReactNode\n  action?: ToastActionElement\n}\n\nconst actionTypes = {\n  ADD_TOAST: \"ADD_TOAST\",\n  UPDATE_TOAST: \"UPDATE_TOAST\",\n  DISMISS_TOAST: \"DISMISS_TOAST\",\n  REMOVE_TOAST: \"REMOVE_TOAST\",\n} as const\n\nlet count = 0\n\nfunction genId() {\n  count = (count + 1) % Number.MAX_SAFE_INTEGER\n  return count.toString()\n}\n\ntype ActionType = typeof actionTypes\n\ntype Action =\n  | {\n      type: ActionType[\"ADD_TOAST\"]\n      toast: ToasterToast\n    }\n  | {\n      type: ActionType[\"UPDATE_TOAST\"]\n      toast: Partial<ToasterToast>\n    }\n  | {\n      type: ActionType[\"DISMISS_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n  | {\n      type: ActionType[\"REMOVE_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n\ninterface State {\n  toasts: ToasterToast[]\n}\n\nconst toastTimeouts = new Map<string, ReturnType<typeof setTimeout>>()\n\nconst addToRemoveQueue = (toastId: string) => {\n  if (toastTimeouts.has(toastId)) {\n    return\n  }\n\n  const timeout = setTimeout(() => {\n    toastTimeouts.delete(toastId)\n    dispatch({\n      type: \"REMOVE_TOAST\",\n      toastId: toastId,\n    })\n  }, TOAST_REMOVE_DELAY)\n\n  toastTimeouts.set(toastId, timeout)\n}\n\nexport const reducer = (state: State, action: Action): State => {\n  switch (action.type) {\n    case \"ADD_TOAST\":\n      return {\n        ...state,\n        toasts: [action.toast, ...state.toasts].slice(0, TOAST_LIMIT),\n      }\n\n    case \"UPDATE_TOAST\":\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === action.toast.id ? { ...t, ...action.toast } : t\n        ),\n      }\n\n    case \"DISMISS_TOAST\": {\n      const { toastId } = action\n\n      // ! Side effects ! - This could be extracted into a dismissToast() action,\n      // but I'll keep it here for simplicity\n      if (toastId) {\n        addToRemoveQueue(toastId)\n      } else {\n        state.toasts.forEach((toast) => {\n          addToRemoveQueue(toast.id)\n        })\n      }\n\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === toastId || toastId === undefined\n            ? {\n                ...t,\n                open: false,\n              }\n            : t\n        ),\n      }\n    }\n    case \"REMOVE_TOAST\":\n      if (action.toastId === undefined) {\n        return {\n          ...state,\n          toasts: [],\n        }\n      }\n      return {\n        ...state,\n        toasts: state.toasts.filter((t) => t.id !== action.toastId),\n      }\n  }\n}\n\nconst listeners: Array<(state: State) => void> = []\n\nlet memoryState: State = { toasts: [] }\n\nfunction dispatch(action: Action) {\n  memoryState = reducer(memoryState, action)\n  listeners.forEach((listener) => {\n    listener(memoryState)\n  })\n}\n\ntype Toast = Omit<ToasterToast, \"id\">\n\nfunction toast({ ...props }: Toast) {\n  const id = genId()\n\n  const update = (props: ToasterToast) =>\n    dispatch({\n      type: \"UPDATE_TOAST\",\n      toast: { ...props, id },\n    })\n  const dismiss = () => dispatch({ type: \"DISMISS_TOAST\", toastId: id })\n\n  dispatch({\n    type: \"ADD_TOAST\",\n    toast: {\n      ...props,\n      id,\n      open: true,\n      onOpenChange: (open) => {\n        if (!open) dismiss()\n      },\n    },\n  })\n\n  return {\n    id: id,\n    dismiss,\n    update,\n  }\n}\n\nfunction useToast() {\n  const [state, setState] = React.useState<State>(memoryState)\n\n  React.useEffect(() => {\n    listeners.push(setState)\n    return () => {\n      const index = listeners.indexOf(setState)\n      if (index > -1) {\n        listeners.splice(index, 1)\n      }\n    }\n  }, [state])\n\n  return {\n    ...state,\n    toast,\n    dismiss: (toastId?: string) => dispatch({ type: \"DISMISS_TOAST\", toastId }),\n  }\n}\n\nexport { useToast, toast }\n","path":null,"size_bytes":3895,"size_tokens":null},"client/src/components/ui/select.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SelectPrimitive from \"@radix-ui/react-select\"\nimport { Check, ChevronDown, ChevronUp } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Select = SelectPrimitive.Root\n\nconst SelectGroup = SelectPrimitive.Group\n\nconst SelectValue = SelectPrimitive.Value\n\nconst SelectTrigger = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <SelectPrimitive.Icon asChild>\n      <ChevronDown className=\"h-4 w-4 opacity-50\" />\n    </SelectPrimitive.Icon>\n  </SelectPrimitive.Trigger>\n))\nSelectTrigger.displayName = SelectPrimitive.Trigger.displayName\n\nconst SelectScrollUpButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollUpButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronUp className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollUpButton>\n))\nSelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName\n\nconst SelectScrollDownButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollDownButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronDown className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollDownButton>\n))\nSelectScrollDownButton.displayName =\n  SelectPrimitive.ScrollDownButton.displayName\n\nconst SelectContent = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>\n>(({ className, children, position = \"popper\", ...props }, ref) => (\n  <SelectPrimitive.Portal>\n    <SelectPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]\",\n        position === \"popper\" &&\n          \"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1\",\n        className\n      )}\n      position={position}\n      {...props}\n    >\n      <SelectScrollUpButton />\n      <SelectPrimitive.Viewport\n        className={cn(\n          \"p-1\",\n          position === \"popper\" &&\n            \"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]\"\n        )}\n      >\n        {children}\n      </SelectPrimitive.Viewport>\n      <SelectScrollDownButton />\n    </SelectPrimitive.Content>\n  </SelectPrimitive.Portal>\n))\nSelectContent.displayName = SelectPrimitive.Content.displayName\n\nconst SelectLabel = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Label\n    ref={ref}\n    className={cn(\"px-2 py-1.5 text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nSelectLabel.displayName = SelectPrimitive.Label.displayName\n\nconst SelectItem = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute right-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <SelectPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </SelectPrimitive.ItemIndicator>\n    </span>\n    <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>\n  </SelectPrimitive.Item>\n))\nSelectItem.displayName = SelectPrimitive.Item.displayName\n\nconst SelectSeparator = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nSelectSeparator.displayName = SelectPrimitive.Separator.displayName\n\nexport {\n  Select,\n  SelectGroup,\n  SelectValue,\n  SelectTrigger,\n  SelectContent,\n  SelectLabel,\n  SelectItem,\n  SelectSeparator,\n  SelectScrollUpButton,\n  SelectScrollDownButton,\n}\n","path":null,"size_bytes":5745,"size_tokens":null},"client/src/components/ui/slider.tsx":{"content":"import * as React from \"react\"\nimport * as SliderPrimitive from \"@radix-ui/react-slider\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Slider = React.forwardRef<\n  React.ElementRef<typeof SliderPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SliderPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <SliderPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative flex w-full touch-none select-none items-center\",\n      className\n    )}\n    {...props}\n  >\n    <SliderPrimitive.Track className=\"relative h-1.5 w-full grow overflow-hidden rounded-full bg-primary/20\">\n      <SliderPrimitive.Range className=\"absolute h-full bg-primary\" />\n    </SliderPrimitive.Track>\n    <SliderPrimitive.Thumb className=\"block h-4 w-4 rounded-full border border-primary/50 bg-background shadow transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50\" />\n  </SliderPrimitive.Root>\n))\nSlider.displayName = SliderPrimitive.Root.displayName\n\nexport { Slider }\n","path":null,"size_bytes":1037,"size_tokens":null},"server/db.ts":{"content":"import { drizzle } from \"drizzle-orm/node-postgres\";\nimport pg from \"pg\";\nimport * as schema from \"@shared/schema\";\n\nconst { Pool } = pg;\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\n    \"DATABASE_URL must be set. Did you forget to provision a database?\",\n  );\n}\n\nexport const pool = new Pool({ connectionString: process.env.DATABASE_URL });\nexport const db = drizzle(pool, { schema });\n","path":null,"size_bytes":395,"size_tokens":null},"client/src/lib/authUtils.ts":{"content":"export function isUnauthorizedError(error: Error): boolean {\n  return /^401: .*Unauthorized/.test(error.message);\n}\n","path":null,"size_bytes":116,"size_tokens":null},"client/src/hooks/useAuth.ts":{"content":"import { useQuery } from \"@tanstack/react-query\";\n\ninterface User {\n  id: string;\n  email: string | null;\n  firstName: string | null;\n  lastName: string | null;\n  profileImageUrl: string | null;\n}\n\nexport function useAuth() {\n  const { data: user, isLoading } = useQuery<User | null>({\n    queryKey: [\"/api/auth/user\"],\n    retry: false,\n  });\n\n  return {\n    user,\n    isLoading,\n    isAuthenticated: !!user,\n  };\n}\n","path":null,"size_bytes":417,"size_tokens":null},"server/replitAuth.ts":{"content":"import * as client from \"openid-client\";\nimport { Strategy, type VerifyFunction } from \"openid-client/passport\";\n\nimport passport from \"passport\";\nimport session from \"express-session\";\nimport type { Express, RequestHandler } from \"express\";\nimport memoize from \"memoizee\";\nimport connectPg from \"connect-pg-simple\";\nimport { storage } from \"./storage\";\n\nconst getOidcConfig = memoize(\n  async () => {\n    return await client.discovery(\n      new URL(process.env.ISSUER_URL ?? \"https://replit.com/oidc\"),\n      process.env.REPL_ID!\n    );\n  },\n  { maxAge: 3600 * 1000 }\n);\n\nexport function getSession() {\n  const sessionTtl = 7 * 24 * 60 * 60 * 1000; // 1 week\n  const pgStore = connectPg(session);\n  const sessionStore = new pgStore({\n    conString: process.env.DATABASE_URL,\n    createTableIfMissing: false,\n    ttl: sessionTtl,\n    tableName: \"sessions\",\n  });\n  return session({\n    secret: process.env.SESSION_SECRET!,\n    store: sessionStore,\n    resave: false,\n    saveUninitialized: false,\n    cookie: {\n      httpOnly: true,\n      secure: true,\n      maxAge: sessionTtl,\n    },\n  });\n}\n\nfunction updateUserSession(\n  user: any,\n  tokens: client.TokenEndpointResponse & client.TokenEndpointResponseHelpers\n) {\n  user.claims = tokens.claims();\n  user.access_token = tokens.access_token;\n  user.refresh_token = tokens.refresh_token;\n  user.expires_at = user.claims?.exp;\n}\n\nasync function upsertUser(\n  claims: any,\n) {\n  await storage.upsertUser({\n    id: claims[\"sub\"],\n    email: claims[\"email\"],\n    firstName: claims[\"first_name\"],\n    lastName: claims[\"last_name\"],\n    profileImageUrl: claims[\"profile_image_url\"],\n  });\n}\n\nexport async function setupAuth(app: Express) {\n  app.set(\"trust proxy\", 1);\n  app.use(getSession());\n  app.use(passport.initialize());\n  app.use(passport.session());\n\n  const config = await getOidcConfig();\n\n  const verify: VerifyFunction = async (\n    tokens: client.TokenEndpointResponse & client.TokenEndpointResponseHelpers,\n    verified: passport.AuthenticateCallback\n  ) => {\n    const user = {};\n    updateUserSession(user, tokens);\n    await upsertUser(tokens.claims());\n    verified(null, user);\n  };\n\n  const registeredStrategies = new Set<string>();\n\n  const ensureStrategy = (domain: string) => {\n    const strategyName = `replitauth:${domain}`;\n    if (!registeredStrategies.has(strategyName)) {\n      const strategy = new Strategy(\n        {\n          name: strategyName,\n          config,\n          scope: \"openid email profile offline_access\",\n          callbackURL: `https://${domain}/api/callback`,\n        },\n        verify,\n      );\n      passport.use(strategy);\n      registeredStrategies.add(strategyName);\n    }\n  };\n\n  passport.serializeUser((user: Express.User, cb) => cb(null, user));\n  passport.deserializeUser((user: Express.User, cb) => cb(null, user));\n\n  app.get(\"/api/login\", (req, res, next) => {\n    ensureStrategy(req.hostname);\n    passport.authenticate(`replitauth:${req.hostname}`, {\n      prompt: \"login consent\",\n      scope: [\"openid\", \"email\", \"profile\", \"offline_access\"],\n    })(req, res, next);\n  });\n\n  app.get(\"/api/callback\", (req, res, next) => {\n    ensureStrategy(req.hostname);\n    passport.authenticate(`replitauth:${req.hostname}`, {\n      successReturnToOrRedirect: \"/\",\n      failureRedirect: \"/api/login\",\n    })(req, res, next);\n  });\n\n  app.get(\"/api/logout\", (req, res) => {\n    req.logout(() => {\n      res.redirect(\n        client.buildEndSessionUrl(config, {\n          client_id: process.env.REPL_ID!,\n          post_logout_redirect_uri: `${req.protocol}://${req.hostname}`,\n        }).href\n      );\n    });\n  });\n}\n\nexport const isAuthenticated: RequestHandler = async (req, res, next) => {\n  const user = req.user as any;\n\n  if (!req.isAuthenticated() || !user.expires_at) {\n    return res.status(401).json({ message: \"Unauthorized\" });\n  }\n\n  const now = Math.floor(Date.now() / 1000);\n  if (now <= user.expires_at) {\n    return next();\n  }\n\n  const refreshToken = user.refresh_token;\n  if (!refreshToken) {\n    res.status(401).json({ message: \"Unauthorized\" });\n    return;\n  }\n\n  try {\n    const config = await getOidcConfig();\n    const tokenResponse = await client.refreshTokenGrant(config, refreshToken);\n    updateUserSession(user, tokenResponse);\n    return next();\n  } catch (error) {\n    res.status(401).json({ message: \"Unauthorized\" });\n    return;\n  }\n};\n","path":null,"size_bytes":4371,"size_tokens":null}},"version":2}